{"version":3,"sources":["utils/axiosApi.js","utils/localSettings.js","utils/auth.js","utils/protectedRoute.js","components/BaseParts/LogoutBtn.js","components/BaseParts/Navbar.js","components/BaseParts/DeviceSidebar.js","components/BaseParts/DeviceHeader.js","utils/useTargetClick.js","components/TagsGraph/Graph.js","components/TagsGraph/GraphWithCrosshair.js","components/TagsGraph/Legend.js","components/TagsGraph/Toolbar.js","components/BaseParts/Loader.js","components/TagsGraph/TagsHistoricalGraph.js","components/TagsGraph/GraphColors.js","components/Widgets/WidgetGraph.js","components/TagsList/TagsCurrentValueRow.js","components/TagsList/TagsCurrentValueList.js","components/Widgets/WidgetTable.js","components/TagsIndicator/TagIndicator.js","components/Widgets/WidgetIndicator.js","components/Widgets/renderWidgets.js","pages/device/overview.js","pages/device/settings.js","pages/device/eventsLog.js","pages/device/graphs.js","pages/device/deviceAdmin.js","pages/device/widgetsAdmin.js","pages/pageNotFound.js","pages/device/deviceApp.js","components/BaseParts/CompanySidebar.js","components/CompanyOverview/DeviceCard.js","components/CompanyOverview/FacilityCard.js","pages/company/overview.js","pages/company/employers.js","pages/company/facilities.js","pages/company/profile.js","pages/company/companyApp.js","pages/welcome.js","pages/users/login.js","pages/users/registration.js","pages/users/profile.js","App.js","reportWebVitals.js","index.js"],"names":["axiosInstance","axios","create","baseURL","timeout","headers","localStorage","getItem","interceptors","response","use","error","originalRequest","config","status","url","Promise","reject","data","code","statusText","refreshToken","tokenParts","JSON","parse","atob","split","now","Math","ceil","Date","console","log","exp","post","refresh","then","setItem","access","defaults","catch","err","this","authenticated","onLogin","onLogout","onUserInfoReaded","cb","get","_onLogin","_onLogout","username","password","removeItem","request","userInfo","readUserInfo","clearUserInfo","ProtectedRoute","Component","component","rest","render","props","auth","isAuthenticated","to","pathname","state","from","location","LogoutBtn","handleLogout","bind","logout","history","push","className","onClick","withRouter","Navbar","authed","style","outline","boxShadow","type","data-toggle","data-target","id","zIndex","Fragment","Sidebar","React","useState","displaySubMenu","setDisplaySubMenu","deviceId","styleBtnRemoveOutline","overflow","role","aria-orientation","activeClassName","fontSize","DeviceHeader","deviceData","setDeviceData","device_id","readDeviceParameters","BASE_URL","params","responce","useEffect","deviceParametersUpdateInterval","setInterval","clearInterval","name","is_online","verbose_last_update","useTargetClick","ref","callback","handleClick","e","current","contains","target","document","addEventListener","removeEventListener","Graph","displayedTags","tags","filter","tag","disabled","resetZoomButton","lastDrawLocation","setLastDrawLocation","replace","length","margin","left","right","top","bottom","xType","animation","xDomain","yDomain","yPadding","stroke","line","tickTotal","map","values","color","curve_color","tag_id","onBrushEnd","area","onDrag","setState","dontCheckIfEmpty","x","y","crosshairValues","setCrosshairValues","crosshairData","value","title","tag_name","_onNearestX","index","d","onMouseLeave","onNearestX","point","size","backgroundColor","background","colSpan","time","s","Intl","DateTimeFormat","dateStyle","timeStyle","format","format_time","paddingTop","Legend","searchText","setSearchText","items","height","parseInt","onSearchChange","searchPlaceholder","onItemClick","item","Toolbar","showRangeForm","setShowRangeForm","activeButton","setActiveButton","changeGraphInterval","toggleActiveButton","btn","b","getActiveCalss","RangeForm","Loader","TagsHistoricalGraph","setModal","crosshair","setCrosshair","graphCard","useRef","graphContainer","modalButton","crosshairButton","legendContainer","tagsHistory","GRAPH_HEIGH","toggleModal","cl","includes","legend","toggleCroshair","width","textDecoration","loading","GraphWithCrosshair","toggleCurveDisplay","toolbar","colors","getColor","clorsNumber","WidgetGraph","setLoading","interval","resolution","widget","graphInterval","setGraphInterval","setTagsHistory","readTagsHistory","prepared_tags","tag_code","add_date","prev","fltr","entry","updateTagsHistory","setTimeout","graphUpdateInterval","n","TagsCurrentValueRow","TagsCurrentValueList","WidgetTable","setTags","readDeviceTags","tagsUpdateInterval","TagIndicator","addTextRight","addTextLeft","WidgetIndicator","requestParams","RenderWidgets","widgetsTemplate","widgets","WidgetRender","min","DeviceOverviewPage","DeviceSettingsPage","DeviceEventsLogPage","WidgetsTemplate","DeviceAdminPage","WidgetsAdminPage","updateWidgetsTemplate","selectedWidget","setSelectedWidget","changeSelectedWidget","widgetNumber","WidgetsGrid","WidgetsList","WForm","content","minHeight","maxWidth","w","WTableForm","WGraphForm","WIndicatorForm","FormContainer2","children","TextField","titel","placeholder","NumberField","max","MultipleSelectField","options","comment","fields","CheckboxField","SelectField","htmlFor","defaultValue","option","multiple","Page404","DeviceApp","useParams","defaultWidgetsTemplate","setWidgetsTemplate","newTemplate","exact","path","class","yesterday","setDate","getDate","formatter","hour","minute","month","day","DeviceCard","device","deviceParameters","last_update","FacilityCard","ds","facilityInfo","devices","CompanyOverviewPage","companyInfo","setCompanyInfo","readCompanyInfo","inf","company","facilities","facility","a","EmployersPage","FacilitiesPage","CompanyProfilePage","CompanyApp","WelcomePage","href","login","Login","handleChange","handleSubmit","event","preventDefault","onSubmit","onChange","Signup","email","errors","stack","ProfilePage","first_name","last_name","App","loading2","setLoading2","setAuthed","setUserInfo","handle","useFullScreenHandle","checkAuthentication","ui","enter","autoplay","muted","loop","src","Registration","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.7819ac97.chunk.js","sourcesContent":["import axios from 'axios'\r\n\r\nimport getBaseUrl from './localSettings'\r\nconst baseURL = getBaseUrl();\r\n\r\nconst axiosInstance = axios.create({\r\n    baseURL: baseURL,\r\n    timeout: 60000,\r\n    headers: {\r\n        'Authorization': \"JWT \" + localStorage.getItem('access_token'),\r\n        'Content-Type': 'application/json',\r\n        'accept': 'application/json'\r\n    }\r\n});\r\n\r\n\r\naxiosInstance.interceptors.response.use(\r\n    response => response,\r\n    error => {\r\n        const originalRequest = error.config;\r\n\r\n        // Prevent infinite loops\r\n        if (error.response.status === 401 && originalRequest.url === '/user/token/refresh/') {\r\n            // window.location.href = '/user/login/';                  \r\n            return Promise.reject(error);\r\n        }\r\n\r\n        if (error.response.data.code === \"token_not_valid\" &&\r\n            error.response.status === 401 && \r\n            error.response.statusText === \"Unauthorized\") \r\n            {\r\n                const refreshToken = localStorage.getItem('refresh_token');\r\n\r\n                if (refreshToken){\r\n                    const tokenParts = JSON.parse(atob(refreshToken.split('.')[1]));\r\n\r\n                    // exp date in token is expressed in seconds, while now() returns milliseconds:\r\n                    const now = Math.ceil(Date.now() / 1000);\r\n                    console.log(tokenParts.exp);\r\n\r\n                    if (tokenParts.exp > now) {\r\n                        return axiosInstance\r\n                        .post('/user/token/refresh/', {refresh: refreshToken})\r\n                        .then((response) => {\r\n            \r\n                            localStorage.setItem('access_token', response.data.access);\r\n                            localStorage.setItem('refresh_token', response.data.refresh);\r\n            \r\n                            axiosInstance.defaults.headers['Authorization'] = \"JWT \" + response.data.access;\r\n                            originalRequest.headers['Authorization'] = \"JWT \" + response.data.access;\r\n            \r\n                            return axiosInstance(originalRequest);\r\n                        })\r\n                        .catch(err => {\r\n                            console.log(err)\r\n                        });\r\n                    }else{\r\n                        console.log(\"Refresh token is expired\", tokenParts.exp, now);\r\n                        // window.location.href = 'user/login/';\r\n                    }\r\n                }else{\r\n                    console.log(\"Refresh token not available.\")\r\n                    // window.location.href = 'user/login/';\r\n                }\r\n        }\r\n      \r\n     \r\n      // specific error handling done elsewhere\r\n      return Promise.reject(error);\r\n  }\r\n);\r\n\r\n\r\nexport default axiosInstance","\r\n\r\nexport default function getBaseUrl(){\r\n    // return \"http://bfcloud.space\"\r\n    return \"http://localhost:8000\"\r\n}","import axiosInstance from \"./axiosApi\";\r\n\r\nclass Auth{\r\n    constructor() {\r\n        this.authenticated = false;\r\n        this.onLogin = ()=>{};\r\n        this.onLogout = ()=>{};\r\n        this.onUserInfoReaded = ()=>{};\r\n    }\r\n\r\n    async checkAuthentication (cb) {\r\n        try {\r\n            const response = await axiosInstance.get('/user/token/check/')\r\n            if (response) {\r\n                this._onLogin();\r\n            } else {\r\n                this._onLogout();\r\n            }\r\n        } catch (error) {\r\n            this._onLogout();\r\n        }    \r\n        cb();         \r\n    }\r\n\r\n    async login(username, password, cb) {\r\n        try {\r\n            const response = await axiosInstance.post('/user/token/obtain/', {\r\n              username: username,\r\n              password: password\r\n            });\r\n            axiosInstance.defaults.headers['Authorization'] = \"JWT \" + response.data.access;\r\n            localStorage.setItem('access_token', response.data.access);\r\n            localStorage.setItem('refresh_token', response.data.refresh);\r\n            this._onLogin();\r\n            cb();\r\n        } catch (error) {\r\n            throw error;\r\n        }\r\n    }\r\n\r\n    async logout(cb) {\r\n        try {\r\n            await axiosInstance.post('user/token/blacklist/', {\r\n                \"refresh_token\": localStorage.getItem(\"refresh_token\")\r\n            });\r\n            localStorage.removeItem('access_token');\r\n            localStorage.removeItem('refresh_token');\r\n            axiosInstance.defaults.headers['Authorization'] = null;\r\n        } catch (error) {\r\n            console.log(error);\r\n        }\r\n        this._onLogout();\r\n        cb();        \r\n    }\r\n\r\n    isAuthenticated() {\r\n        return this.authenticated;\r\n    }\r\n\r\n    async readUserInfo(){\r\n        const request = await axiosInstance.get('/user/info/')\r\n        this.onUserInfoReaded( { ...request.data } )\r\n    }\r\n\r\n    clearUserInfo(){\r\n        this.userInfo = {}\r\n        this.onUserInfoReaded( {} )\r\n    }\r\n\r\n    _onLogin () {\r\n        this.authenticated = true;\r\n        this.onLogin();\r\n        this.readUserInfo();\r\n    }\r\n    _onLogout () {\r\n        this.authenticated = false;\r\n        this.onLogout();\r\n        this.clearUserInfo();        \r\n    }\r\n}\r\n\r\nexport default new Auth()","import React from 'react' \r\nimport {Route, Redirect} from 'react-router-dom'\r\n\r\nimport auth from './auth' \r\n\r\n\r\n\r\nexport const ProtectedRoute = ({component: Component, ...rest}) => {\r\n  return (\r\n    <Route\r\n      {...rest}\r\n      render={(props) => {\r\n        if (auth.isAuthenticated()) {\r\n          return <Component {...props} />\r\n        } else {\r\n          return <Redirect to={{pathname: '/user/login', state: {from: props.location}}} />\r\n        }\r\n      }}\r\n    />\r\n  )\r\n}","import React, { Component } from \"react\";\r\nimport {Link, withRouter} from 'react-router-dom'\r\n\r\nimport auth from '../../utils/auth' \r\n\r\nclass LogoutBtn extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.handleLogout = this.handleLogout.bind(this);\r\n    }\r\n\r\n    handleLogout() {\r\n        auth.logout(()=>{\r\n            this.props.history.push('/')\r\n        });\r\n    };\r\n\r\n    render() {\r\n        return (\r\n            <li className=\"nav-item\" >\r\n                <Link className=\"nav-link\" to=\"\" onClick={this.handleLogout}>Выйти</Link>\r\n            </li>\r\n        )\r\n    };\r\n};         \r\n\r\nexport default withRouter(LogoutBtn)","import React from 'react'\r\nimport {Link} from 'react-router-dom'\r\n\r\nimport LogoutBtn from './LogoutBtn'\r\n\r\nexport default function Navbar(props) {\r\n    const authed = props.authed\r\n    const userInfo = props.userInfo\r\n    return (\r\n        <nav className=\"navbar navbar-expand-sm bg-dark navbar-dark bg-color-indigo header-height p-0 m-0\">\r\n            <Link className=\"navbar-brand header-height py-2 pl-3 pr-0 m-0\" to=\"/\">WebArm</Link>\r\n\r\n            <button className=\"navbar-toggler header-height border-0 m-0\" style={{outline: 'none', boxShadow: 'none'}} type=\"button\" data-toggle=\"collapse\" data-target=\"#collapsibleNavbar\">\r\n                <span className=\"navbar-toggler-icon\"></span>\r\n            </button>\r\n\r\n            <div className=\"collapse navbar-collapse bg-color-indigo\" id=\"collapsibleNavbar\" style={{zIndex: '1'}}>\r\n                <div className='d-md-none border-top border-secondary'></div>\r\n                <ul className=\"navbar-nav px-3\">\r\n                    {authed ? (\r\n                        <React.Fragment>\r\n                            <li className=\"nav-item\">\r\n                                <Link className=\"nav-link\" to=\"/company/overview\">Предприятие</Link>\r\n                            </li>\r\n                            <li className=\"nav-item\">\r\n                                <Link className=\"nav-link\" to=\"/company/facilities\">Обьекты</Link>\r\n                            </li>\r\n                            <li className=\"nav-item\">\r\n                                <Link className=\"nav-link\" to=\"/company/profile\">Кабинет</Link>\r\n                            </li>\r\n                        </React.Fragment>\r\n                    ) : null }\r\n                </ul>  \r\n        \r\n                <ul className=\"navbar-nav ml-auto px-3\">\r\n                    {authed ? (\r\n                        <React.Fragment>\r\n                            { userInfo ?\r\n                                <React.Fragment> \r\n                                    <li className=\"nav-item\">\r\n                                        <Link className=\"nav-link\" to=\"/user/profile\">{userInfo.username}</Link>\r\n                                    </li>\r\n                                    <li className=\"nav-item border-right border-secondary my-1 d-none d-sm-inline\"> </li>\r\n                                </React.Fragment>                        \r\n                            : null }\r\n                            <LogoutBtn />\r\n                        </React.Fragment>\r\n                    ) : (\r\n                        <li className=\"nav-item\">\r\n                            <Link className=\"nav-link\" to=\"/user/login\">Войти</Link>\r\n                        </li>\r\n                    )}\r\n                </ul> \r\n            </div>\r\n        </nav>       \r\n    );\r\n}","import React from 'react'\r\nimport {NavLink} from 'react-router-dom'\r\n\r\nexport default function Sidebar(props) {\r\n  const [displaySubMenu, setDisplaySubMenu] = React.useState(false)\r\n  const {deviceId} = props\r\n\r\n  const styleBtnRemoveOutline = {outline: 'none', boxShadow: 'none'}\r\n\r\n  return (\r\n    <div className=\"col-2 m-0 p-0\">\r\n      <div className=\"bg-dark bg-color-gray p-2 h-100\">\r\n        <div className=\"p-1\">\r\n\r\n          <div className=\"nav flex-column nav-pills\" style={{overflow: 'hidden'}} id=\"v-pills-tab\" role=\"tablist\" aria-orientation=\"vertical\">\r\n              <NavLink className=\"nav-link text-light btn\" style={styleBtnRemoveOutline} activeClassName=\"bg-dark\" to={`/device/${deviceId}/overview/`}>\r\n                <div className=\"d-inline-flex w-100 justify-content-center justify-content-lg-start\">\r\n                  <i className='fas fa-home' style={{fontSize:'1.3em'}}></i>\r\n                  <span className='pl-3 d-none d-lg-inline text-left'>Обзор</span>\r\n                </div>\r\n              </NavLink>\r\n              <NavLink className=\"nav-link text-light btn\" style={styleBtnRemoveOutline} activeClassName=\"bg-dark\" to={`/device/${deviceId}/settings/`}>\r\n                <div className=\"d-inline-flex w-100 justify-content-center justify-content-lg-start \">\r\n                  <i className='far fa-edit' style={{fontSize:'1.3em'}}></i>\r\n                  <span className='pl-3 d-none d-lg-inline text-left'>Настройки</span>\r\n                </div> \r\n              </NavLink>\r\n              <NavLink className=\"nav-link text-light btn\" style={styleBtnRemoveOutline} activeClassName=\"bg-dark\" to={`/device/${deviceId}/graphs/`}>\r\n                <div className=\"d-inline-flex w-100 justify-content-center justify-content-lg-start\">\r\n                  <i className='far fa-chart-bar' style={{fontSize:'1.3em'}}></i>\r\n                  <span className='pl-3 d-none d-lg-inline text-left'>Графики</span>\r\n                </div>\r\n              </NavLink>\r\n              <NavLink className=\"nav-link text-light btn\" style={styleBtnRemoveOutline} activeClassName=\"bg-dark\" to={`/device/${deviceId}/events/`}> \r\n                <div className=\"d-inline-flex w-100 justify-content-center justify-content-lg-start\">\r\n                  <i className='far fa-bell' style={{fontSize:'1.3em'}}></i>\r\n                  <span className='pl-3 d-none d-lg-inline text-left'>Журнал</span>\r\n                </div>\r\n              </NavLink>\r\n            </div>\r\n\r\n\r\n            <div className=\"nav flex-column nav-pills\" style={{overflow: 'hidden'}} >              \r\n              <div className='border-top mt-3 pt-3 border-secondary'></div>\r\n              <button className=\"nav-link text-light btn\" style={styleBtnRemoveOutline} onClick={()=>{setDisplaySubMenu(!displaySubMenu)}}>\r\n                <div className=\"d-inline-flex w-100 justify-content-center justify-content-lg-start\">\r\n                  <i className='\tfas fa-list py-1' style={{fontSize:'1.3em'}}></i>\r\n                  <span className='pl-3 d-none d-lg-inline text-left'>Администрирование</span>\r\n                  <i className='fas fa-caret-down py-1 pl-1 ml-auto d-none d-lg-inline' ></i>\r\n                </div>\r\n              </button>\r\n\r\n              {displaySubMenu && <React.Fragment>\r\n                <NavLink className=\"nav-link text-light btn\" style={styleBtnRemoveOutline} activeClassName=\"bg-dark\" to={`/device/${deviceId}/admin/config/`}> \r\n                  <div className=\"d-inline-flex w-100 justify-content-center justify-content-lg-start\">\r\n                    <i className='fas fa-circle px-1 pt-2' style={{fontSize:'0.6em'}}></i>\r\n                    <span className='pl-3 d-none d-lg-inline text-left'>Прибор</span>\r\n                  </div>\r\n                </NavLink>\r\n\r\n                <NavLink className=\"nav-link text-light btn\" style={styleBtnRemoveOutline} activeClassName=\"bg-dark\" to={`/device/${deviceId}/admin/widgets/`}> \r\n                  <div className=\"d-inline-flex w-100 justify-content-center justify-content-lg-start\">\r\n                    <i className='fas fa-circle px-1 pt-2' style={{fontSize:'0.6em'}}></i>\r\n                    <span className='pl-3 d-none d-lg-inline text-left'>Виджеты</span>\r\n                  </div>\r\n                </NavLink>\r\n              </React.Fragment> }\r\n          </div>\r\n          \r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}","import React, { useEffect } from 'react' \r\n\r\nimport axiosInstance from \"../../utils/axiosApi\";\r\nimport getBaseUrl from '../../utils/localSettings'\r\nconst BASE_URL = getBaseUrl()\r\n\r\n\r\n\r\nexport default function DeviceHeader(props) {\r\n  const [deviceData, setDeviceData] = React.useState({})\r\n  const device_id = props.device_id;\r\n\r\n  function readDeviceParameters() {\r\n    axiosInstance.get(BASE_URL + \"/device/parameters/\", { params: { id: device_id }} )\r\n      .then(responce => { \r\n        responce && setDeviceData({...responce.data}) \r\n      }) \r\n  }\r\n  \r\n  useEffect(() => {\r\n    readDeviceParameters();\r\n    const deviceParametersUpdateInterval = setInterval(readDeviceParameters, 5000);\r\n    return () => {\r\n      clearInterval(deviceParametersUpdateInterval);\r\n    };\r\n  }, [])\r\n\r\n  \r\n  // render the page\r\n  return (\r\n    <React.Fragment>\r\n      <div className='d-flex border rounded border-dark px-3 mb-1 mx-1'>\r\n        <h3 className='pt-1'>Устройство: <b>{deviceData.name}</b></h3>\r\n        <div className='ml-auto mx-3 px-3 border-x border-dark'>\r\n          { deviceData.is_online ? \r\n            <div className='text-success'>\r\n              <span>Онлайн</span> <br/>\r\n              <i className='fas fa-check text-center w-100'></i>\r\n            </div>\r\n          : <div className='text-danger'>\r\n              <span>Нет связи</span> <br/>\r\n              <i className='fas fa-times text-center w-100'></i>\r\n            </div>\r\n          }\r\n        </div>\r\n        <div>\r\n          <p className='m-0 mr-1 text-right'>Данные обновлены: <br/> {deviceData.verbose_last_update}</p>\r\n        </div>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n","import { useEffect } from \"react\";\r\n\r\nconst useTargetClick = (ref, callback) => {\r\n  const handleClick = e => {\r\n    if (ref.current && ref.current.contains(e.target)) {\r\n      callback();\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    document.addEventListener(\"click\", handleClick);\r\n\r\n    return () => {\r\n      document.removeEventListener(\"click\", handleClick);\r\n    };\r\n  });\r\n};\r\n\r\nexport default useTargetClick;","import React, {useEffect} from 'react';\r\nimport PropTypes from 'prop-types'\r\nimport {\r\n    FlexibleXYPlot, \r\n    XAxis, \r\n    YAxis, \r\n    LineSeries,\r\n    // VerticalGridLines, \r\n    HorizontalGridLines, \r\n    Highlight} from 'react-vis';\r\n\r\nimport useTargetClick from '../../utils/useTargetClick'\r\n\r\n\r\nfunction Graph(props) {\r\n  const tags = props.tags \r\n  const displayedTags = tags.filter( tag => tag.disabled === false )\r\n  const resetZoomButton = props.resetZoomButton\r\n  const [lastDrawLocation, setLastDrawLocation] = React.useState(null)\r\n\r\n  useTargetClick(resetZoomButton, ()=>{\r\n    console.log('seted onclick')\r\n    setLastDrawLocation(null)\r\n  })\r\n\r\n  useEffect(() => {\r\n    if (lastDrawLocation) {\r\n      resetZoomButton.current.className = resetZoomButton.current.className.replace('d-none', 'd-block')\r\n    } else {\r\n      resetZoomButton.current.className = resetZoomButton.current.className.replace('d-block', 'd-none')\r\n    }\r\n  }, [lastDrawLocation])\r\n\r\n\r\n  if (displayedTags.length > 0) {\r\n    return (\r\n      <React.Fragment>\r\n        <div className='graph-container h-100' style={{overflow: 'hidden'}}>\r\n          <FlexibleXYPlot \r\n            margin={{left: 40, right: 0, top: 0, bottom: 30}} \r\n            xType=\"time\"\r\n            animation\r\n            xDomain={\r\n              lastDrawLocation && [\r\n                lastDrawLocation.left,\r\n                lastDrawLocation.right\r\n              ]\r\n            }\r\n            yDomain={\r\n              lastDrawLocation && [\r\n                lastDrawLocation.bottom,\r\n                lastDrawLocation.top\r\n              ]\r\n            }\r\n            yPadding={10} \r\n          >\r\n            <HorizontalGridLines style={{stroke: '#444A50'}} />\r\n            <XAxis style={{line:{stroke: '#6c757d'}}} tickTotal={15} />\r\n            <YAxis style={{line:{stroke: '#6c757d'}}} />\r\n            { displayedTags.map((tag)=>{ \r\n              return <LineSeries data={tag.values} color={tag.curve_color} key={tag.tag_id} />\r\n            }) }\r\n\r\n            <Highlight\r\n              onBrushEnd={area => setLastDrawLocation(area)}\r\n              onDrag={area => {\r\n                this.setState({\r\n                  lastDrawLocation: {\r\n                    bottom: lastDrawLocation.bottom + (area.top - area.bottom),\r\n                    left: lastDrawLocation.left - (area.right - area.left),\r\n                    right: lastDrawLocation.right - (area.right - area.left),\r\n                    top: lastDrawLocation.top + (area.top - area.bottom)\r\n                  }\r\n                });\r\n                }}\r\n              />\r\n          </FlexibleXYPlot>\r\n        </div>\r\n      </ React.Fragment>\r\n    );\r\n  } else {\r\n    return (\r\n      <React.Fragment>\r\n      <div className='graph-container h-100'>\r\n        <FlexibleXYPlot \r\n          dontCheckIfEmpty\r\n          margin={{left: 30, right: 0, top: 0, bottom: 30}}      \r\n        >\r\n          <HorizontalGridLines style={{stroke: '#444A50'}} />\r\n          <XAxis />\r\n          <YAxis />\r\n          <LineSeries data={[{x:0, y:0}]} /> \r\n        </FlexibleXYPlot>\r\n      </div>\r\n      </ React.Fragment> \r\n    )                   \r\n  }\r\n}\r\n\r\n\r\nGraph.propTypes = {\r\n    tags: PropTypes.arrayOf(PropTypes.object).isRequired\r\n}\r\n\r\nexport default Graph","import React, {useEffect} from 'react';\r\nimport PropTypes from 'prop-types'\r\nimport {\r\n    FlexibleXYPlot, \r\n    XAxis, \r\n    YAxis, \r\n    LineSeries,\r\n    MarkSeries,\r\n    Crosshair,\r\n    // VerticalGridLines, \r\n    HorizontalGridLines, \r\n    Highlight} from 'react-vis';\r\n\r\nimport useTargetClick from '../../utils/useTargetClick'\r\n\r\n\r\n\r\nfunction Graph(props) {\r\n  const tags = props.tags   \r\n  const displayedTags = tags.filter( tag => tag.disabled === false )  \r\n  const resetZoomButton = props.resetZoomButton\r\n  const [lastDrawLocation, setLastDrawLocation] = React.useState(null)\r\n  const [crosshairValues, setCrosshairValues] = React.useState([])\r\n\r\n  useTargetClick(resetZoomButton, ()=>{\r\n    console.log('seted onclick')\r\n    setLastDrawLocation(null)\r\n  })\r\n\r\n  useEffect(() => {\r\n    if (lastDrawLocation) {\r\n      resetZoomButton.current.className = resetZoomButton.current.className.replace('d-none', 'd-block')\r\n    } else {\r\n      resetZoomButton.current.className = resetZoomButton.current.className.replace('d-block', 'd-none')\r\n    }\r\n  }, [lastDrawLocation])\r\n\r\n\r\n  const crosshairData = displayedTags.map( (tag) => {\r\n    return tag.values.map((value) => {\r\n      value.title = tag.tag_name\r\n      value.color = tag.curve_color\r\n      return value\r\n    })\r\n  });  \r\n\r\n  const _onMouseLeave = () => {\r\n    setCrosshairValues([]);\r\n  };\r\n\r\n  const _onNearestX = (value, {index}) => {\r\n    setCrosshairValues( crosshairData.map(d => d[index]) );\r\n  };\r\n\r\n  function format_time(time) {\r\n    const s = new Date(time)\r\n    let formatter = new Intl.DateTimeFormat([] , {dateStyle: 'long', timeStyle: 'medium'});\r\n    return formatter.format(s)\r\n  }\r\n\r\n  if (displayedTags.length > 0) {\r\n    return (\r\n      <React.Fragment>\r\n        <div className='graph-container  h-100' style={{overflow: 'hidden'}}>\r\n          <FlexibleXYPlot \r\n            margin={{left: 40, right: 0, top: 0, bottom: 30}} \r\n            xType=\"time\"\r\n            animation\r\n            xDomain={\r\n              lastDrawLocation && [\r\n                lastDrawLocation.left,\r\n                lastDrawLocation.right\r\n              ]\r\n            }\r\n            yDomain={\r\n              lastDrawLocation && [\r\n                lastDrawLocation.bottom,\r\n                lastDrawLocation.top\r\n              ]\r\n            } \r\n            yPadding={10}\r\n            onMouseLeave={_onMouseLeave}        \r\n          >\r\n            <HorizontalGridLines style={{stroke: '#444A50'}} />\r\n            <XAxis style={{line:{stroke: '#6c757d'}}} tickTotal={15} />\r\n            <YAxis style={{line:{stroke: '#6c757d'}}} />\r\n            { displayedTags.map((tag, index)=>{\r\n              if (index === 0) {\r\n                return <LineSeries onNearestX={_onNearestX} data={tag.values} color={tag.curve_color} key={tag.tag_id} />\r\n              }\r\n              else {\r\n                return <LineSeries data={tag.values} color={tag.curve_color} key={tag.tag_id} />\r\n              }\r\n            }) }\r\n\r\n            <Highlight\r\n              onBrushEnd={area => setLastDrawLocation(area)}\r\n              onDrag={area => {\r\n                setLastDrawLocation({\r\n                  lastDrawLocation: {\r\n                    bottom: lastDrawLocation.bottom + (area.top - area.bottom),\r\n                    left: lastDrawLocation.left - (area.right - area.left),\r\n                    right: lastDrawLocation.right - (area.right - area.left),\r\n                    top: lastDrawLocation.top + (area.top - area.bottom)\r\n                  }\r\n                });\r\n              }}\r\n            />\r\n\r\n            {crosshairValues[0] && \r\n              crosshairValues.map((point, index)=>{\r\n                return point ? (\r\n                          <MarkSeries\r\n                            key = {index}\r\n                            color = {point.color}\r\n                            size = '5'\r\n                            data={[point]}/>\r\n                        ) : null \r\n            })}\r\n\r\n            <Crosshair values={crosshairValues} style={{line:{backgroundColor:'red'}}}>  \r\n              {crosshairValues[0] && \r\n                <div className='rounded p-1 mx-2' style={{background: 'rgba(37, 37, 38, 1)'}}>\r\n                  <table className=\"table text-light p-0 m-0\">\r\n                    <thead> \r\n                    <tr>\r\n                        <td colSpan=\"3\" style={{fontSize: '1.2em', color: 'rgb(180, 180, 180)'}} \r\n                          className='border-0 font-weight-bold p-1 m-0 text-center text-nowrap'\r\n                        >\r\n                          {format_time(crosshairValues[0].x)}\r\n                        </td>\r\n                    </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                      { crosshairValues.map((point, index)=>{\r\n                        return point ? (\r\n                          <tr style={{fontSize: '1.1em', color: 'rgb(210, 210, 210)'}} key={index}>\r\n                            <td style={{color: point.color, paddingTop: '4px'}} className='text-nowrap border-0 px-1 pb-0 m-0\tfas fa-minus'></td>   \r\n                            <td className='text-nowrap border-0 pl-1 pr-2 py-0 m-0'> {point.title}: </td>   \r\n                            <td className='text-nowrap border-0 px-1 py-0 m-0 font-weight-bold  text-right'> {point.y} </td>\r\n                          </tr> \r\n                        ) : null\r\n                      })}\r\n                    </tbody>\r\n                  </table>\r\n                </div>\r\n              }\r\n            </Crosshair>\r\n          </FlexibleXYPlot>\r\n        </div>\r\n      </ React.Fragment>\r\n    );  \r\n  } else {\r\n    return (\r\n      <React.Fragment>\r\n      <div className='graph-container h-100'>\r\n        <FlexibleXYPlot \r\n          dontCheckIfEmpty\r\n          margin={{left: 30, right: 0, top: 0, bottom: 30}}      \r\n        >\r\n          <HorizontalGridLines style={{stroke: '#444A50'}} />\r\n          <XAxis />\r\n          <YAxis />\r\n          <LineSeries data={[{x:0, y:0}]} /> \r\n        </FlexibleXYPlot>\r\n      </div>\r\n      </ React.Fragment> \r\n    )                   \r\n  }\r\n}\r\n\r\n\r\nGraph.propTypes = {\r\n    tags: PropTypes.arrayOf(PropTypes.object).isRequired\r\n}\r\n\r\nexport default Graph","import React from 'react' \r\nimport SearchableDiscreteColorLegend from 'react-vis/dist/legends/searchable-discrete-color-legend';\r\n\r\n\r\n\r\n\r\nexport default function Legend(props) { \r\n  var [searchText, setSearchText] = React.useState('')\r\n\r\n  var state = {\r\n    onClick: props.onClick,\r\n    items: props.tags.map((tag) => {\r\n      return {title: tag.tag_name, color: tag.curve_color, tag_id:tag.tag_id, disabled:tag.disabled}\r\n    })\r\n  }\r\n\r\n  function _clickHandler (item) {\r\n    state.onClick(item.tag_id);    \r\n  };\r\n\r\n  function _searchChangeHandler (searchText) {\r\n    setSearchText(searchText)\r\n  };\r\n\r\n  return (\r\n    <div className='d-block text-dark pl-3'>\r\n      <SearchableDiscreteColorLegend\r\n        height={ parseInt(props.height.replace('px', '')) }\r\n        // width={300}\r\n        onSearchChange={_searchChangeHandler}\r\n        searchPlaceholder={'Поиск...'}\r\n        searchText={searchText}\r\n        onItemClick={_clickHandler}\r\n        items={state.items}\r\n      />\r\n    </div>\r\n  );\r\n}","import React, { useState } from 'react' \r\n\r\n\r\n\r\nexport default function Toolbar(props) { \r\n  const [showRangeForm, setShowRangeForm] = useState(false)\r\n  const [activeButton, setActiveButton] = useState([false, true, false, false, false, false, false, false])\r\n  const changeGraphInterval = props.changeGraphInterval\r\n\r\n  function toggleActiveButton(btn) {\r\n    // enable selected button and off all other\r\n    const b = activeButton.map( (item, index) => {\r\n      return (index === btn) ? true : false\r\n    })\r\n    setActiveButton(b)\r\n    // display form for range input \r\n    setShowRangeForm( (btn === 7) ? true : false ) \r\n  }\r\n\r\n  function getActiveCalss(btn) {\r\n    return activeButton[btn] ? ' active' : ''\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n    <div className='d-flex justify-content-left p-0 pt-2 m-0'>\r\n        <button type=\"button\" \r\n          className={'btn btn-sm btn-outline-secondary mx-1 ' + getActiveCalss(0)} \r\n          onClick={()=>{\r\n            toggleActiveButton(0)\r\n            changeGraphInterval('5m', 'all')\r\n          }}\r\n        >онлайн</button>\r\n\r\n        <button type=\"button\" \r\n          className={'btn btn-sm btn-outline-secondary mx-1 ' + getActiveCalss(1)} \r\n          onClick={()=>{\r\n            toggleActiveButton(1)\r\n            changeGraphInterval('1h', '1m')\r\n          }}\r\n        >1 час</button>\r\n\r\n        <button type=\"button\" \r\n          className={'btn btn-sm btn-outline-secondary mx-1 ' + getActiveCalss(2)} \r\n          onClick={()=>{\r\n            toggleActiveButton(2)\r\n            changeGraphInterval('6h', '5m')\r\n          }}\r\n        >6 часов</button>\r\n\r\n        <button type=\"button\" \r\n          className={'btn btn-sm btn-outline-secondary mx-1 ' + getActiveCalss(3)} \r\n          onClick={()=>{\r\n            toggleActiveButton(3)\r\n            changeGraphInterval('12h', '10m')\r\n          }}\r\n        >12 часов</button>\r\n\r\n        <button type=\"button\" \r\n          className={'btn btn-sm btn-outline-secondary mx-1 ' + getActiveCalss(4)} \r\n          onClick={()=>{\r\n            toggleActiveButton(4)\r\n            changeGraphInterval('1d', '30m')\r\n          }}\r\n        >сутки</button>\r\n\r\n        <button type=\"button\" \r\n          className={'btn btn-sm btn-outline-secondary mx-1 ' + getActiveCalss(5)} \r\n          onClick={()=>{\r\n            toggleActiveButton(5)\r\n            changeGraphInterval('7d', '2h')\r\n          }}\r\n        >неделя</button>\r\n\r\n        <button type=\"button\" \r\n          className={'btn btn-sm btn-outline-secondary mx-1 ' + getActiveCalss(6)} \r\n          onClick={()=>{\r\n            toggleActiveButton(6)\r\n            changeGraphInterval('30d', '12h')\r\n          }}\r\n        >месяц</button>\r\n\r\n        <button type=\"button\" \r\n          className={'btn btn-sm btn-outline-secondary mx-1 ' + getActiveCalss(7)} \r\n          onClick={()=>{\r\n            toggleActiveButton(7)\r\n            changeGraphInterval('30d', '12h') // todo\r\n          }}\r\n        >интервал</button> \r\n    </div>\r\n\r\n    {showRangeForm ? <RangeForm /> : null }\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n\r\nfunction RangeForm(props) {\r\n  return (\r\n    <React.Fragment>\r\n    <form className='pt-2'>\r\n      <div className=\"input-group input-group-sm \">\r\n        <div className=\"input-group-prepend \">\r\n          <span className=\"input-group-text bg-secondary text-light border-secondary ml-1\">C</span>\r\n        </div>\r\n        <input type=\"date\" className=\"form-control bg-dark text-light border-secondary\"></input>\r\n        <input type=\"time\" className=\"form-control bg-dark text-light border-secondary\"></input>\r\n\r\n        <div className=\"input-group-prepend \">\r\n          <span className=\"input-group-text bg-secondary text-light border-secondary ml-2\">По</span>\r\n        </div>\r\n        <input type=\"date\" className=\"form-control bg-dark text-light border-secondary\"></input>\r\n        <input type=\"time\" className=\"form-control bg-dark text-light border-secondary\"></input>\r\n\r\n        <button type=\"button\" className='btn btn-sm btn-secondary ml-2 mr-1'>показать</button> <br/>\r\n      </div>\r\n    </form>\r\n    </React.Fragment>\r\n  );\r\n}","import React from 'react'\r\nimport './Loader.css'\r\n\r\nexport default function Loader() {\r\n    return(\r\n        <div className=\"lds-ellipsis\"><div></div><div></div><div></div><div></div></div>\r\n    )\r\n}","import React from 'react';\r\nimport PropTypes from 'prop-types'\r\nimport Graph from './Graph'\r\nimport GraphWithCrosshair from './GraphWithCrosshair'\r\nimport Legend from './Legend'\r\nimport Toolbar from './Toolbar'\r\nimport Loader from '../../components/BaseParts/Loader'\r\n\r\n\r\nfunction TagsHistoricalGraph(props) {\r\n  const [modal, setModal] = React.useState(false) // use it just for force update this component\r\n  const [crosshair, setCrosshair] = React.useState(false)\r\n  const graphCard = React.useRef(null)\r\n  const graphContainer = React.useRef(null)\r\n  const modalButton = React.useRef(null)\r\n  const crosshairButton = React.useRef(null)\r\n  const legendContainer = React.useRef(null)\r\n  const resetZoomButton = React.useRef(null)\r\n  const tags = props.tagsHistory  \r\n  const GRAPH_HEIGH = props.height ? props.height : '300px'\r\n\r\n  const toggleModal = () => {\r\n    const cl = ' full-screen-card'\r\n    if (graphCard.current.className.includes(cl)) {\r\n      graphCard.current.className = graphCard.current.className.replace(cl, '')\r\n      graphContainer.current.style.height = GRAPH_HEIGH\r\n      graphContainer.current.className = graphContainer.current.className.replace('col-10', 'col-8')\r\n      if (props.legend) {legendContainer.current.className = legendContainer.current.className.replace('col-2', 'col-4')}    \r\n      modalButton.current.className = modalButton.current.className.replace('fa-compress', 'fa-expand') \r\n      modalButton.current.className = modalButton.current.className.replace('text-primary', 'text-light')      \r\n      setModal(false)\r\n    } else {\r\n      graphCard.current.className += cl\r\n      graphContainer.current.style.height = 'calc(100vh - 150px)'\r\n      graphContainer.current.className = graphContainer.current.className.replace('col-8', 'col-10')\r\n      if (props.legend) {legendContainer.current.className = legendContainer.current.className.replace('col-4', 'col-2')}\r\n      modalButton.current.className = modalButton.current.className.replace('fa-expand', 'fa-compress') \r\n      modalButton.current.className = modalButton.current.className.replace('text-light', 'text-primary')       \r\n      setModal(true)\r\n    }\r\n  }\r\n\r\n  const toggleCroshair = () => {\r\n    if (crosshair) {\r\n      setCrosshair(!crosshair)\r\n      crosshairButton.current.className = crosshairButton.current.className.replace('text-primary', 'text-light')      \r\n    } else {\r\n      setCrosshair(!crosshair)\r\n      crosshairButton.current.className = crosshairButton.current.className.replace('text-light', 'text-primary') \r\n    }\r\n  }\r\n\r\n  return (   \r\n    <React.Fragment>\r\n    <div ref={graphCard} className='card shadow-sm py-2 bg-dark text-light h-100'>\r\n      <div className='d-flex mb-1'>\r\n        <h5 className=\"px-3 pt-1 pb-2 m-0\">{props.title}</h5>\r\n        <span className='ml-auto'></span>\r\n\r\n        <button type=\"button\" \r\n          ref={resetZoomButton} \r\n          className={'btn btn-link text-primary m-0 p-0 mt-1 mr-2 fas fa-search-minus d-none'} \r\n          style={{width: '28px', height: '28px', fontSize:'1em', textDecoration: 'none', outline: 'none', boxShadow: 'none'}} \r\n          onClick={null}\r\n        ></button>\r\n\r\n        <button type=\"button\"\r\n          ref={crosshairButton} \r\n          className={'btn btn-link text-light m-0 p-0 mt-1 mr-2 fas fa-ruler-vertical'} \r\n          style={{width: '28px', height: '28px', fontSize:'1em', textDecoration: 'none', outline: 'none', boxShadow: 'none'}}\r\n          onClick={toggleCroshair}\r\n        ></button> \r\n\r\n        <button type=\"button\" \r\n          ref={modalButton} \r\n          className={'btn btn-link text-light m-0 p-0 mt-1 mr-2 fas fa-expand'} \r\n          style={{width: '28px', height: '28px', fontSize:'1em', textDecoration: 'none', outline: 'none', boxShadow: 'none'}} \r\n          onClick={toggleModal}\r\n        ></button>  \r\n      </div>\r\n\r\n      { props.loading ? \r\n        <div className='d-flex justify-content-center'><Loader /></div> :\r\n          <div className=\"row m-0 px-3 py-0\">\r\n            <div ref={graphContainer} className={`${ props.legend ? 'col-8' : 'col-12'} m-0 p-0`} style={{height: GRAPH_HEIGH}}>\r\n              { crosshair ? \r\n                <GraphWithCrosshair tags={tags} resetZoomButton={resetZoomButton} /> : \r\n                <Graph tags={tags} resetZoomButton={resetZoomButton} /> \r\n              }\r\n            </div>\r\n\r\n            { props.legend && (\r\n              <div ref={legendContainer} className=\"col-4 m-0 p-0\">\r\n                <Legend tags={tags} onClick={props.toggleCurveDisplay} height={GRAPH_HEIGH}/>\r\n              </div>\r\n            )}\r\n\r\n            { props.toolbar && (\r\n              <div className=\"col-12 align-self-start m-0 p-0\">\r\n                <Toolbar toggleModal={toggleModal} toggleCroshair={toggleCroshair} changeGraphInterval={props.changeGraphInterval}/>\r\n              </div>\r\n            )}\r\n        </div>\r\n      }\r\n    </div>\r\n    </ React.Fragment>\r\n  );\r\n}\r\n\r\n\r\nTagsHistoricalGraph.propTypes = {\r\n    tagsHistory: PropTypes.arrayOf(PropTypes.object).isRequired\r\n}\r\n\r\nexport default TagsHistoricalGraph","// const colors = [\r\n//     '#19CDD7', '#DDB27C', '#88572C', \r\n//     '#FF991F', '#F15C17', '#223F9A', \r\n//     '#DA70BF', '#125C77', '#4DC19C', \r\n//     '#776E57', '#12939A', '#17B8BE', \r\n//     '#F6D18A', '#B7885E', '#FFCB99', \r\n//     '#F89570', '#829AE3', '#E79FD5', \r\n//     '#1E96BE', '#89DAC1', '#B3AD9E'\r\n// ]\r\n\r\nconst colors = [\r\n    '#f44336', '#00BCD4', '#FF9800', \r\n    '#E91E63', '#009688', '#FF5722', \r\n    '#9C27B0', '#4CAF50', '#795548', \r\n    '#673AB7', '#8BC34A', '#607D8B', \r\n    '#3F51B5', '#CDDC39', \r\n    '#2196F3', '#FFEB3B', \r\n    '#03A9F4', '#FFC107', \r\n]\r\n\r\n\r\nexport default function getColor(index) {\r\n    const clorsNumber = colors.length\r\n    var ind\r\n    if (index+1 > clorsNumber) {\r\n        ind = index % clorsNumber\r\n    }\r\n    else {\r\n        ind = index\r\n    }\r\n    return colors[ind]\r\n}","import React, { useEffect } from 'react' \r\n\r\nimport TagsHistoricalGraph from '../TagsGraph/TagsHistoricalGraph'\r\nimport getColor from '../TagsGraph/GraphColors'\r\nimport axiosInstance from \"../../utils/axiosApi\";\r\nimport getBaseUrl from '../../utils/localSettings'\r\nconst BASE_URL = getBaseUrl()\r\n\r\n\r\n\r\nexport default function WidgetGraph(props) {\r\n  const [loading, setLoading] = React.useState(true)\r\n  const [graphInterval, setGraphInterval] = React.useState({interval:'1h', resolution:'1m', tags: props.widget.tags})\r\n  const [tagsHistory, setTagsHistory] = React.useState([])\r\n  const device_id = props.device_id;\r\n\r\n  function updateTagsHistory(tags) {\r\n    const prepared_tags = tags.map( (tag, index) => {\r\n      return ({\r\n        tag_id: tag.tag_id,\r\n        tag_code: tag.tag_code,\r\n        tag_name: tag.tag_name,\r\n        disabled: false,\r\n        curve_color : getColor(index),\r\n        values: tag.values.map( (value) => {\r\n          return {x: new Date(value.add_date), y: value.value}\r\n        })\r\n      })\r\n    })  \r\n    setTagsHistory( (prev) => {\r\n      return prepared_tags.map( (tag)=> {\r\n        const fltr = prev.filter( entry=>entry.tag_id === tag.tag_id )\r\n        var disabled = (fltr.length > 0) ? fltr[0].disabled : tag.disabled\r\n        return {...tag, disabled: disabled}\r\n      })\r\n    }) \r\n  }\r\n\r\n  // read tags historical data\r\n  function readTagsHistory() {\r\n    axiosInstance.get(BASE_URL + \"/device/tags/history/\", { params: { id: device_id, ...graphInterval}} )\r\n    .then(responce => {\r\n      responce && updateTagsHistory(responce.data)\r\n    })  \r\n  }\r\n  \r\n  // read parameters\r\n  useEffect(() => {\r\n    readTagsHistory();\r\n    setTimeout( () => { setLoading(false) }, 1000);\r\n    const graphUpdateInterval = setInterval( readTagsHistory, getGraphUpdateTimeout(graphInterval.interval))\r\n    return () => {\r\n      clearInterval(graphUpdateInterval);\r\n    };\r\n  }, [graphInterval])\r\n\r\n  \r\n  function changeGraphInterval(interval, resolution){\r\n    setGraphInterval( (prev) => {\r\n      return {...prev, interval: interval, resolution: resolution}\r\n    })\r\n  }\r\n\r\n  function getGraphUpdateTimeout(interval){\r\n    if (interval === '5m') {\r\n      return 2000                       // 2s\r\n    } else if (interval === '1h') {\r\n      return 30000                      // 30s\r\n    } else if (interval === '6h') {\r\n      return 60000 * 2                  // 2m\r\n    } else if (interval === '12h') {\r\n      return 60000 * 5                  // 5m\r\n    } else if (interval === '1d') {\r\n      return 60000 * 15                 // 15m\r\n    } else if (interval === '7d') {\r\n      return 60000 * 60                 // 1h\r\n    } else if (interval === '30d') {\r\n      return 60000 * 60 * 6             // 6h\r\n    } else {\r\n      return 60000 * 5                  // 5m\r\n    }\r\n  }\r\n\r\n  // toggle curve display\r\n  function toggleCurveDisplay(tag_id){\r\n    const n = tagsHistory.map( entry => { \r\n      if (entry.tag_id===tag_id) { entry.disabled = !entry.disabled } \r\n      return entry\r\n    })\r\n    setTagsHistory(n)\r\n  }\r\n\r\n  // render the widget\r\n  return (\r\n    <React.Fragment>\r\n        <TagsHistoricalGraph \r\n            tagsHistory={tagsHistory} \r\n            toggleCurveDisplay={toggleCurveDisplay}\r\n            title={props.widget.title}\r\n            legend={props.widget.legend}\r\n            loading={loading}\r\n            toolbar={props.widget.toolbar}\r\n            height={props.widget.height}\r\n            changeGraphInterval={changeGraphInterval}\r\n        /> \r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\n\r\nfunction TagsCurrentValueRow({tag, index}) {\r\n    return (\r\n        <tr>\r\n            <td className='border-secondary text-secondary pl-2'> {index + 1} </td>   \r\n            <td className='border-secondary'> {tag.code} </td>\r\n            <td className='border-secondary'> {tag.name} </td>\r\n            <td className='border-secondary'> {tag.value} </td>\r\n        </tr>\r\n    )\r\n}\r\n\r\n\r\n\r\nTagsCurrentValueRow.propTypes = {\r\n    tag: PropTypes.object.isRequired,\r\n    index: PropTypes.number.isRequired,\r\n}\r\n\r\nexport default TagsCurrentValueRow","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport TagsCurrentValueRow from './TagsCurrentValueRow'\r\nimport Loader from '../../components/BaseParts/Loader'\r\n\r\n\r\nfunction TagsCurrentValueList(props) {\r\n  const [modal, setModal] = React.useState(false) // use it just for force update this component\r\n  const modalButton = React.useRef(null)\r\n  const graphCard = React.useRef(null)\r\n\r\n  const toggleModal = () => {\r\n    const cl = ' full-screen-card'\r\n    if (graphCard.current.className.includes(cl)) {\r\n      graphCard.current.className = graphCard.current.className.replace(cl, '')\r\n      modalButton.current.className = modalButton.current.className.replace('fa-compress', 'fa-expand') \r\n      modalButton.current.className = modalButton.current.className.replace('text-primary', 'text-light')      \r\n      setModal(false)\r\n    } else {\r\n      graphCard.current.className += cl\r\n      modalButton.current.className = modalButton.current.className.replace('fa-expand', 'fa-compress') \r\n      modalButton.current.className = modalButton.current.className.replace('text-light', 'text-primary')       \r\n      setModal(true)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div ref={graphCard} className='card shadow-sm py-2 bg-dark text-light h-100'>\r\n      <div className='d-flex mb-1'>\r\n        <h5 className=\"px-3 pt-1 pb-0 m-0\">{props.title}</h5>\r\n        <span className='ml-auto'></span>\r\n\r\n        <button type=\"button\" \r\n          ref={modalButton} \r\n          className={'btn btn-link text-light m-0 p-0 mt-1 mr-2 fas fa-expand'} \r\n          style={{width: '28px', height: '28px', fontSize:'1em', textDecoration: 'none', outline: 'none', boxShadow: 'none'}} \r\n          onClick={toggleModal}\r\n        ></button>  \r\n      </div>\r\n  \r\n      { props.loading ? \r\n        <div className='d-flex justify-content-center'><Loader /></div> :     \r\n        <div className=\"table-responsive px-3\">\r\n          <table className=\"table table-sm text-light tadle-dark w-100 mb-0\">\r\n            <thead> \r\n              <tr>\r\n                <td className='border-0 text-secondary font-weight-bold pl-2'>№</td>\r\n                <td className='border-0 text-secondary font-weight-bold'>Код параметра</td>\r\n                <td className='border-0 text-secondary font-weight-bold'>Наименование параметра</td>\r\n                <td className='border-0 text-secondary font-weight-bold'>Текущее значение</td>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n                { props.tags.map((tag, index) => {\r\n                  return (\r\n                    <TagsCurrentValueRow tag={tag} key={tag.code} index={index} />\r\n                  )\r\n                }) }\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      }\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\nTagsCurrentValueList.propTypes = {\r\n    tags: PropTypes.arrayOf(PropTypes.object).isRequired\r\n}\r\n\r\nexport default TagsCurrentValueList","import React, { useEffect } from 'react' \r\n\r\nimport TagsCurrentValueList from '../../components/TagsList/TagsCurrentValueList'\r\nimport axiosInstance from \"../../utils/axiosApi\";\r\nimport getBaseUrl from '../../utils/localSettings'\r\nconst BASE_URL = getBaseUrl()\r\n\r\n\r\n\r\nexport default function WidgetTable(props) {\r\n  const [tags, setTags] = React.useState([])\r\n  const [loading, setLoading] = React.useState(true)\r\n  const device_id = props.device_id;\r\n\r\n  function readDeviceTags() {\r\n    axiosInstance.get(BASE_URL + \"/device/tags/value/\", { params: { id: device_id }} )\r\n    .then((responce) => {\r\n      responce && setTags(responce.data)\r\n    })  \r\n  }\r\n  \r\n  // read parameters\r\n  useEffect(() => {\r\n    readDeviceTags();\r\n    setTimeout( () => { setLoading(false) }, 1000);\r\n    const tagsUpdateInterval = setInterval(readDeviceTags, 2000);\r\n    return () => {\r\n      clearInterval(tagsUpdateInterval);\r\n    };\r\n  }, [])\r\n\r\n  // render the page\r\n  return (\r\n    <React.Fragment>\r\n        <TagsCurrentValueList\r\n          tags={tags} \r\n          title={props.widget.title} \r\n          loading={loading} \r\n        />\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n","import React from 'react'\r\nimport Loader from '../BaseParts/Loader'\r\n\r\n\r\nexport default function TagIndicator(props) {\r\n  const tag = props.tag\r\n  const addTextRight = props.addTextRight\r\n  const addTextLeft = props.addTextLeft\r\n\r\n  return (\r\n    <div className='card shadow-sm py-2 bg-dark text-light h-100'>\r\n      <div className='d-flex mb-1'>\r\n        <h5 className=\"px-3 pt-1 pb-0 m-0\">{props.title}</h5>\r\n        <span className='ml-auto'></span>  \r\n      </div>\r\n  \r\n      { props.loading ? \r\n        <div className='d-flex justify-content-center'><Loader /></div> :     \r\n        <div className=\"d-flex justify-content-center align-items-end h-100 px-3\">\r\n          {tag ? \r\n            <p className='display-4 m-0 p-0'>\r\n              <span>{addTextLeft} </span> \r\n              {tag.value} \r\n              <span> {addTextRight}</span>\r\n            </p> :\r\n            <p className='display-4 text-secondary m-0 p-0'>Нет данных</p> \r\n          }\r\n        </div>\r\n      }\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\n\r\n","import React, { useEffect } from 'react' \r\n\r\nimport TagIndicator from '../../components/TagsIndicator/TagIndicator'\r\nimport axiosInstance from \"../../utils/axiosApi\";\r\nimport getBaseUrl from '../../utils/localSettings'\r\nconst BASE_URL = getBaseUrl()\r\n\r\n\r\n\r\nexport default function WidgetIndicator(props) {\r\n  const [tags, setTags] = React.useState([])\r\n  const [loading, setLoading] = React.useState(true)\r\n  const device_id = props.device_id;\r\n  const requestParams = {id: device_id, tags: props.widget.tags};\r\n  const tag = tags[0] // TODO: widget display just 1 tag\r\n\r\n  function readDeviceTags() {\r\n    axiosInstance.get(BASE_URL + \"/device/tags/value/\", { params: requestParams} )\r\n    .then((responce) => {\r\n      responce && setTags(responce.data)\r\n    })  \r\n  }\r\n\r\n  useEffect(() => {\r\n    readDeviceTags();\r\n    setTimeout( () => { setLoading(false) }, 1000);\r\n    const tagsUpdateInterval = setInterval(readDeviceTags, 2000);\r\n    return () => {\r\n      clearInterval(tagsUpdateInterval);\r\n    };\r\n  }, [])\r\n\r\n\r\n  return (\r\n    <React.Fragment>\r\n        <TagIndicator\r\n          tag={tag} \r\n          title={props.widget.title}\r\n          addTextRight={props.widget.addTextRight}\r\n          addTextLeft={props.widget.addTextLeft}\r\n          loading={loading} \r\n        />\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n","import React from 'react' \r\n\r\nimport WidgetGraph from './WidgetGraph'\r\nimport WidgetTable from './WidgetTable'\r\nimport WidgetIndicator from './WidgetIndicator' \r\n\r\n\r\n\r\nexport default function RenderWidgets(props) {\r\n  const widgetsTemplate = props.widgetsTemplate\r\n  const device_id = props.device_id\r\n  if (!props.widgetsTemplate) {return null}\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='container-fluid row equal p-0 m-0'>\r\n      {\r\n        widgetsTemplate.widgets.map((widget, index)=>{\r\n          return <WidgetRender widget={widget} device_id={device_id} key={index} />\r\n        })\r\n      }\r\n      </div>\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\n\r\nfunction WidgetRender(props) {\r\n  const widget = props.widget\r\n  const device_id = props.device_id\r\n\r\n  if (widget.type === 'table') {\r\n    return (\r\n      <div className={`col-xl-${widget.width * 3} col-lg-${Math.min(widget.width * 6, 12)} col-md-12 p-1 m-0`}>\r\n        <WidgetTable device_id={device_id} widget={widget}/>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (widget.type === 'graph') {\r\n    return (\r\n      <div className={`col-xl-${widget.width * 3} col-lg-${Math.min(widget.width * 6, 12)} col-md-12 p-1 m-0`}>\r\n        <WidgetGraph device_id={device_id} widget={widget}/>\r\n      </div>\r\n    )    \r\n  }   \r\n\r\n  if (widget.type === 'indicator') {\r\n    return (\r\n      <div className={`col-xl-${widget.width * 3} col-lg-${Math.min(widget.width * 6, 12)} col-md-12 p-1 m-0`}>\r\n        <WidgetIndicator device_id={device_id} widget={widget}/>\r\n      </div>\r\n    )    \r\n  }    \r\n}\r\n","import React from 'react' \r\n\r\nimport DeviceHeader from '../../components/BaseParts/DeviceHeader'\r\nimport RenderWidgets from '../../components/Widgets/renderWidgets'\r\n\r\n\r\n\r\nexport default function DeviceOverviewPage(props) {\r\n  const device_id = props.device_id;\r\n  const widgetsTemplate = props.widgetsTemplate;\r\n  \r\n  // render the page\r\n  return (\r\n    <React.Fragment>\r\n      <DeviceHeader device_id={device_id}/>\r\n      <RenderWidgets widgetsTemplate={widgetsTemplate} device_id={device_id}/>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n","import React from 'react' \r\n\r\n\r\nexport default function DeviceSettingsPage() {\r\n\r\n  return (\r\n    <React.Fragment>\r\n        <h3>Настройки устройства</h3>\r\n        <p>Раздел находиться в разработке ... </p>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n ","import React from 'react' \r\n\r\n\r\nexport default function DeviceEventsLogPage() {\r\n\r\n  return (\r\n    <React.Fragment>\r\n        <h3>Журнал событий обьекта</h3>\r\n        <p>Раздел находиться в разработке ... </p>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n ","import React from 'react' \r\n\r\nimport DeviceHeader from '../../components/BaseParts/DeviceHeader'\r\nimport RenderWidgets from '../../components/Widgets/renderWidgets'\r\n\r\n\r\n\r\nconst WidgetsTemplate = {\r\n  widgets:[   \r\n    {\r\n      type: 'graph',\r\n      width: 4,\r\n      height: 'calc(65vh)',\r\n      title: 'История',\r\n      tags: null,\r\n      legend: true,\r\n      toolbar: true,\r\n    }      \r\n  ]\r\n}\r\n\r\n\r\n\r\nexport default function DeviceOverviewPage(props) {\r\n  const device_id = props.device_id;\r\n  \r\n  // render the page\r\n  return (\r\n    <React.Fragment>\r\n      <DeviceHeader device_id={device_id}/>\r\n      <RenderWidgets widgetsTemplate={WidgetsTemplate} device_id={device_id}/>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n","import React from 'react' \r\n\r\n\r\nexport default function DeviceAdminPage() {\r\n\r\n  return (\r\n    <React.Fragment>\r\n        <h3>Настройка параметров прибора</h3>\r\n        <p>Раздел находиться в разработке ... </p>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n ","import React from 'react' \r\n\r\nexport default function WidgetsAdminPage(props) {\r\n  const updateWidgetsTemplate = props.updateWidgetsTemplate\r\n  const widgetsTemplate = props.widgetsTemplate\r\n  const [selectedWidget, setSelectedWidget] = React.useState(0)\r\n\r\n  const changeSelectedWidget = (widgetNumber) => {\r\n    setSelectedWidget(widgetNumber)\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <h3 className='mb-3'>Настройка виджетов</h3>\r\n      <div className='row bg-dark rounded equal p-0 m-0'>\r\n        <div className='col-md-6 col-lg-7 col-xl-8 p-0 m-0'>\r\n          <WidgetsGrid widgetsTemplate={widgetsTemplate} changeSelectedWidget={changeSelectedWidget}/>\r\n          <WidgetsList widgetsTemplate={widgetsTemplate} changeSelectedWidget={changeSelectedWidget}/>\r\n        </div>\r\n        <div className='col-md-6 col-lg-5 col-xl-4 p-0 mx-0 my-1 bg-dark rounded'>\r\n          <WForm widget={widgetsTemplate.widgets[selectedWidget]} />\r\n        </div>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n\r\n// -------------------------------------------------------------------------------------------------\r\nfunction WidgetsGrid(props){\r\n  const widgetsTemplate = props.widgetsTemplate\r\n  const changeSelectedWidget = props.changeSelectedWidget\r\n  const content = widgetsTemplate.widgets.map((widget, index)=>{\r\n    return (\r\n      <div key={index} className={`col-${widget.width * 3} p-1 m-0`}> \r\n        <button className='btn btn-dark w-100 h-100 text-left p-2' style={{overflow:'hidden', minHeight:'10vh'}} onClick={()=>{changeSelectedWidget(index)}}>\r\n          <span className='small text-secondary'>{widget.type}</span><br/>\r\n          <span className='small text-nowrap'>{widget.title}</span>\r\n        </button>\r\n      </div>\r\n    )\r\n  })\r\n\r\n  return (\r\n    <div className='d-flex justify-content-center mt-4 mb-0 mx-4 p-0' style={{}}>\r\n      <div className='row equal rounded border border-secondary m-0 p-2' style={{backgroundColor: '#1E1E1E', maxWidth:'700px'}}>\r\n        {content}\r\n      </div>\r\n    </div>\r\n  )\r\n} \r\n\r\n\r\nfunction WidgetsList(props){\r\n  const widgetsTemplate = props.widgetsTemplate\r\n  const changeSelectedWidget = props.changeSelectedWidget\r\n  const content = widgetsTemplate.widgets.map((widget, index)=>{\r\n    return (\r\n      <button className='btn btn-outline-primary border-0 w-100 my-1 text-left text-light' key={index} onClick={()=>{changeSelectedWidget(index)}}>\r\n        <i className='fas fa-circle pr-3' style={{fontSize:'0.6em'}}></i>\r\n        <span className=''>{widget.type}: </span>\r\n        <span className=''>{widget.title}</span>\r\n      </button>\r\n    )\r\n  })\r\n\r\n  return (\r\n    <div className='bg-dark rounded m-1 py-2 px-3'>\r\n      {content}\r\n    </div>\r\n  )\r\n} \r\n\r\n// -------------------------------------------------------------------------------------------------\r\n// function WidgetsForms(props){\r\n//   const widgetsTemplate = props.widgetsTemplate\r\n//   return widgetsTemplate.widgets.map((widget, index)=>{\r\n//     return <WForm widget={widget} key={index}/>\r\n//   })\r\n// } \r\n\r\nfunction WForm(props){\r\n  const widget = props.widget\r\n  let w = {}\r\n\r\n  if (widget.type === 'table') { w = <WTableForm widget={widget}/> }\r\n  if (widget.type === 'graph') { w = <WGraphForm widget={widget}/> }\r\n  if (widget.type === 'indicator') { w = <WIndicatorForm widget={widget}/> } \r\n  \r\n  return (\r\n    <div className='p-0 m-0 my-1'> \r\n      <FormContainer2> {w} </FormContainer2>\r\n    </div>\r\n  )\r\n}\r\n\r\n// -------------------------------------------------------------------------------------------------\r\n// function FormContainer(props){\r\n//   return (\r\n//     <div className='card shadow-sm bg-dark text-light p-2 m-0 mx-1 h-100'>\r\n//       {props.children}\r\n//     </div>\r\n//   )\r\n// }\r\n\r\nfunction FormContainer2(props){\r\n  return (\r\n    <div className='text-light p-2 m-0 mx-1 h-100'>\r\n      {props.children}\r\n    </div>\r\n  )\r\n}\r\n\r\nfunction WTableForm(props){\r\n  const widget = props.widget\r\n  return (\r\n    <React.Fragment>\r\n        <h6>Таблица</h6>\r\n        <form>\r\n          <TextField titel={'Название'} id={'title'} placeholder={'...'} value={widget.title}/>\r\n          <NumberField titel={'Ширина'} id={'width'} placeholder={'...'} value={widget.width} min={1} max={4}/>\r\n          <MultipleSelectField \r\n            titel={'Теги'} \r\n            id={'tags'} \r\n            placeholder={'...'} \r\n            value={widget.tags} \r\n            options={['TEMP1', 'TEMP2', 'TEMP3']} \r\n            comment={<span className='m-0 p-0 d-block mt-1'>Удерживайте <kbd className='text-info'>Ctrl</kbd> для выбора нескольких элементов</span>}\r\n          />\r\n          <MultipleSelectField \r\n            titel={'Колонки'} \r\n            id={'fields'} \r\n            placeholder={'...'} \r\n            value={widget.fields} \r\n            options={['#No', 'code', 'name', 'value']} \r\n            comment={<span className='m-0 p-0 d-block mt-1'>Удерживайте <kbd className='text-info'>Ctrl</kbd> для выбора нескольких элементов</span>}\r\n          />          \r\n          <button type=\"button\" className=\"btn btn-sm btn-info\">Применить</button>\r\n        </form>\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\n// {\r\n//   type: 'table',\r\n//   width: 2,\r\n//   title: 'Таблица параметров 2',\r\n//   tags: ['TEMP1', 'TEMP2', 'TEMP3'],   \r\n//   fields: ['#No', 'code', 'name', 'value']              \r\n// }\r\n\r\nfunction WGraphForm(props){\r\n  const widget = props.widget\r\n  return (\r\n    <React.Fragment>\r\n        <h6>График</h6>\r\n        <form>\r\n          <TextField titel={'Название'} id={'title'} placeholder={'...'} value={widget.title}/>\r\n          <NumberField titel={'Ширина'} id={'width'} placeholder={'...'} value={widget.width} min={1} max={4}/>\r\n          <MultipleSelectField \r\n            titel={'Теги'} \r\n            id={'tags'} \r\n            placeholder={'...'} \r\n            value={widget.tags} \r\n            options={['TEMP1', 'TEMP2', 'TEMP3']} \r\n            comment={<span className='m-0 p-0 d-block mt-1'>Удерживайте <kbd className='text-info'>Ctrl</kbd> для выбора нескольких элементов</span>}\r\n          />\r\n          <CheckboxField titel={'Легенда'} id={'legend'} value={widget.legend} />  \r\n          <CheckboxField titel={'Панель инструментов'} id={'toolbar'} value={widget.toolbar} />  \r\n          <button type=\"button\" className=\"btn btn-sm btn-info\">Применить</button>\r\n        </form>\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\n// {\r\n//   type: 'graph',\r\n//   width: 2,\r\n//   title: 'Влажность',\r\n//   tags: ['RH1', 'RH2'],\r\n//   legend: true,\r\n//   toolbar: true,\r\n// }  \r\n\r\nfunction WIndicatorForm(props){\r\n  const widget = props.widget\r\n  return (\r\n    <React.Fragment>\r\n        <h6>Индикатор</h6>\r\n        <form>\r\n          <TextField titel={'Название'} id={'title'} placeholder={'...'} value={widget.title}/>\r\n          <NumberField titel={'Ширина'} id={'width'} placeholder={'...'} value={widget.width} min={1} max={4}/>\r\n          <SelectField \r\n            titel={'Тег'} \r\n            id={'tags'} \r\n            placeholder={'...'} \r\n            value={widget.tags[0]} \r\n            options={['TEMP1', 'TEMP2', 'TEMP3']} \r\n          />\r\n          <TextField titel={'Добавить текст слева'} id={'addTextLeft'} placeholder={'...'} value={widget.addTextLeft}/>\r\n          <TextField titel={'Добавить текст справа'} id={'addTextRight'} placeholder={'...'} value={widget.addTextRight}/>\r\n          <button type=\"button\" className=\"btn btn-sm btn-info\">Применить</button>\r\n        </form>        \r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\n// {\r\n//   type: 'indicator',\r\n//   width: 1,\r\n//   title: 'Температура зоны 1',\r\n//   addTextLeft: '',\r\n//   addTextRight: '°C',      \r\n//   tags: ['PT1'],                \r\n// }\r\n\r\n\r\n// -------------------------------------------------------------------------------------------------\r\nfunction TextField(props){\r\n  // props.titel : str\r\n  // props.placeholder : str  \r\n  // props.id : str\r\n  // props.value : str\r\n  // props.comment : str or jsx\r\n  return (\r\n    <React.Fragment>\r\n      <div className=\"form-group\">\r\n        <label htmlFor={props.id} className='text-secondary'>{props.titel}</label>\r\n        <input \r\n          type=\"text\" \r\n          className=\"form-control form-control-sm bg-secondary border-secondary text-light\" \r\n          placeholder={props.placeholder} \r\n          id={props.id} \r\n          defaultValue={props.value}\r\n        ></input>\r\n        <p className='text-small text-info p-0 m-0'>{props.comment}</p>\r\n      </div>\r\n    </React.Fragment>\r\n  ) \r\n}\r\n\r\nfunction NumberField(props){\r\n  // props.titel : str\r\n  // props.placeholder : str  => like \"12\"\r\n  // props.min : str  => like \"1\"\r\n  // props.max : str  => like \"5\"\r\n  // props.id : str\r\n  // props.value : int\r\n  // props.comment : str or jsx\r\n  return (\r\n    <React.Fragment>\r\n      <div className=\"form-group\">\r\n        <label htmlFor={props.id} className='text-secondary'>{props.titel}</label>\r\n        <input \r\n          type=\"number\" \r\n          className=\"form-control form-control-sm bg-secondary border-secondary text-light\" \r\n          placeholder={props.placeholder} \r\n          id={props.id} \r\n          defaultValue={props.value}\r\n          min={props.min}\r\n          max={props.max}\r\n        ></input>\r\n        <p className='text-small text-info p-0 pt-1 m-0'>{props.comment}</p>        \r\n      </div>\r\n    </React.Fragment>\r\n  ) \r\n}\r\n\r\nfunction SelectField(props){\r\n  // props.titel : str\r\n  // props.placeholder : str\r\n  // props.options : []\r\n  // props.id : str\r\n  // props.value : int\r\n  // props.comment : str or jsx\r\n  return (\r\n    <React.Fragment>\r\n      <div className=\"form-group\">\r\n        <label htmlFor={props.id} className='text-secondary'>{props.titel}</label>\r\n        <select \r\n          className=\"form-control form-control-sm bg-secondary border-secondary text-light\" \r\n          id={props.id} \r\n          placeholder={props.placeholder} \r\n          defaultValue={props.value}\r\n        >\r\n          {props.options && props.options.map((option, index)=>{\r\n            return <option key={index}>{option}</option>\r\n          })}\r\n        </select>\r\n        <p className='text-small text-info p-0 m-0'>{props.comment}</p>\r\n      </div>\r\n    </React.Fragment>\r\n  ) \r\n}\r\n\r\nfunction MultipleSelectField(props){\r\n  // props.titel : str\r\n  // props.placeholder : str\r\n  // props.options : []\r\n  // props.id : str\r\n  // props.value : int\r\n  // props.comment : str or jsx\r\n  return (\r\n    <React.Fragment>\r\n      <div className=\"form-group\">\r\n        <label htmlFor={props.id} className='text-secondary'>{props.titel}</label>\r\n        <select \r\n          multiple \r\n          className=\"form-control form-control-sm bg-secondary border-secondary text-light\" \r\n          id={props.id} \r\n          placeholder={props.placeholder} \r\n          defaultValue={props.value}\r\n        >\r\n          {props.options && props.options.map((option, index)=>{\r\n            return <option key={index}>{option}</option>\r\n          })}\r\n        </select>\r\n        <p className='text-small text-info p-0 m-0'>{props.comment}</p>\r\n      </div>\r\n    </React.Fragment>\r\n  ) \r\n}\r\n\r\nfunction CheckboxField(props){\r\n  // props.titel : str\r\n  // props.id : str\r\n  // props.value : boolean\r\n  // props.comment : str or jsx\r\n  return (\r\n    <React.Fragment>\r\n      <div className=\"form-check pb-3\">\r\n        <input type=\"checkbox\" className=\"form-check-input\" id={props.id} defaultValue={props.value}></input>\r\n        <span>{props.titel}</span>\r\n        <p className='text-small text-info p-0 m-0'>{props.comment}</p>\r\n      </div>\r\n    </React.Fragment>\r\n  ) \r\n}\r\n\r\nfunction InlineCheckboxField(props){\r\n  // props.titel : str\r\n  // props.id : str\r\n  // props.value : boolean\r\n  // props.comment : str or jsx\r\n  return (\r\n    <React.Fragment>\r\n      <div className=\"form-check-inline pb-3\">\r\n        <input type=\"checkbox\" className=\"form-check-input\" id={props.id} defaultValue={props.value}></input>\r\n        <span>{props.titel}</span>\r\n        <p className='text-small text-info p-0 m-0'>{props.comment}</p>\r\n      </div>\r\n    </React.Fragment>\r\n  ) \r\n}","import React from 'react' \r\n\r\n\r\nexport default function Page404() {\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='bg-color-dark-gray text-secondary content-height'>\r\n        <div className='container mt-5 text-center'>\r\n          <h1>Error 404</h1>\r\n          <h3>Страница не найдена</h3>\r\n        </div>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n ","import React from 'react' \r\nimport {Switch, Route, useParams} from 'react-router-dom'\r\n\r\nimport Sidebar from '../../components/BaseParts/DeviceSidebar'\r\nimport DeviceOverviewPage from './overview'\r\nimport DeviceSettingsPage from './settings'\r\nimport DeviceEventsLogPage from './eventsLog'\r\nimport DeviceGraphsPage from './graphs'\r\nimport DeviceAdminPage from './deviceAdmin'\r\nimport WidgetsAdminPage from './widgetsAdmin'\r\nimport Page404 from '../pageNotFound'\r\n\r\nexport default function DeviceApp() { \r\n  let { id } = useParams();\r\n  const [widgetsTemplate, setWidgetsTemplate] = React.useState(defaultWidgetsTemplate)\r\n\r\n  function updateWidgetsTemplate(newTemplate){\r\n    setWidgetsTemplate(newTemplate)\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='bg-color-dark-gray text-secondary h-100'>\r\n      <div className=\"row m-0 p-0\">\r\n        <Sidebar deviceId={id}/>\r\n        <div className=\"col-10 m-0 p-0\">\r\n          <div className=\"content-height p-3\">\r\n            <Switch>\r\n              <Route exact path={`/device/${id}/overview/`} \r\n                component={()=><DeviceOverviewPage device_id={id} widgetsTemplate={widgetsTemplate}/>} \r\n              />\r\n              <Route exact path={`/device/${id}/settings/`} component={()=><DeviceSettingsPage device_id={id}/>} />\r\n              <Route exact path={`/device/${id}/events/`} component={()=><DeviceEventsLogPage device_id={id}/>} />\r\n              <Route exact path={`/device/${id}/graphs/`} component={()=><DeviceGraphsPage device_id={id}/>} />\r\n              <Route exact path={`/device/${id}/admin/config/`} component={()=><DeviceAdminPage device_id={id}/>} />\r\n              <Route exact path={`/device/${id}/admin/widgets/`} \r\n                component={()=><WidgetsAdminPage device_id={id} updateWidgetsTemplate={updateWidgetsTemplate} widgetsTemplate={widgetsTemplate}/>} \r\n              />\r\n              <Route component={Page404} />\r\n            </Switch>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\nconst defaultWidgetsTemplate = {\r\n  widgets:[\r\n\r\n    {\r\n      type: 'table',\r\n      width: 4,\r\n      title: 'Таблица параметров 2',\r\n      tags: ['TEMP1', 'TEMP2', 'TEMP3'],   \r\n      fields: ['#No', 'code', 'name', 'value']              \r\n    },    \r\n   \r\n    {\r\n      type: 'graph',\r\n      width: 4,\r\n      title: 'Температура в теплице',\r\n      tags: [],\r\n      legend: true,\r\n      toolbar: true,\r\n    },    \r\n    \r\n  ]\r\n}","import React from 'react'\r\nimport {NavLink} from 'react-router-dom'\r\n\r\nexport default function Sidebar() {\r\n    return (\r\n        <div className=\"col-2 m-0 p-0\">\r\n        <div className=\"bg-dark bg-color-gray p-2 h-100\">\r\n          <div className=\"p-1\">\r\n\r\n            <div className=\"nav flex-column nav-pills\" style={{overflow: 'hidden'}} id=\"v-pills-tab\" role=\"tablist\" aria-orientation=\"vertical\">\r\n                <NavLink className=\"nav-link text-light btn\" style={{outline: 'none', boxShadow: 'none'}} activeClassName=\"bg-dark\" to=\"/company/overview/\">\r\n                  <div class=\"d-inline-flex w-100 justify-content-center justify-content-lg-start\">\r\n                    <i className='fas fa-home' style={{fontSize:'1.3em'}}></i>\r\n                    <span className='pl-3 d-none d-lg-inline'>Обзор</span>\r\n                  </div>\r\n                </NavLink>\r\n                \r\n                <NavLink className=\"nav-link text-light btn\" style={{outline: 'none', boxShadow: 'none'}} activeClassName=\"bg-dark\" to=\"/company/facilities/\">\r\n                  <div class=\"d-inline-flex w-100 justify-content-center justify-content-lg-start\">\r\n                    <i className='fas fa-city' style={{fontSize:'1.3em'}}></i>\r\n                    <span className='pl-3 d-none d-lg-inline'>Объекты</span>\r\n                  </div> \r\n                </NavLink>\r\n                \r\n                <NavLink className=\"nav-link text-light btn\" style={{outline: 'none', boxShadow: 'none'}} activeClassName=\"bg-dark\" to=\"/company/employers/\">\r\n                  <div class=\"d-inline-flex w-100 justify-content-center justify-content-lg-start\">\r\n                    <i className='fas fa-users' style={{fontSize:'1.3em'}}></i>\r\n                    <span className='pl-3 d-none d-lg-inline'>Сотрудники</span>\r\n                  </div>\r\n                </NavLink>\r\n\r\n                <NavLink className=\"nav-link text-light btn\" style={{outline: 'none', boxShadow: 'none'}} activeClassName=\"bg-dark\" to=\"/company/profile/\"> \r\n                  <div class=\"d-inline-flex w-100 justify-content-center justify-content-lg-start\">\r\n                    <i className='fas fa-chalkboard-teacher' style={{fontSize:'1.3em'}}></i>\r\n                    <span className='pl-3 d-none d-lg-inline'>Кабинет</span>\r\n                  </div>\r\n                </NavLink>\r\n            </div>\r\n            \r\n          </div>\r\n        </div>\r\n        </div>\r\n    )\r\n}","import React, { useEffect } from 'react' \r\nimport {Link} from 'react-router-dom'\r\n\r\nimport axiosInstance from \"../../utils/axiosApi\";\r\nimport getBaseUrl from '../../utils/localSettings'\r\nconst BASE_URL = getBaseUrl()\r\n\r\nfunction DeviceCard(props) {\r\n    const [deviceData, setDeviceData] = React.useState({})\r\n    const device = props.device   \r\n   \r\n    function readDeviceParameters() {\r\n      axiosInstance.get(BASE_URL + \"/device/parameters/\", { params: { id: device.id }} )\r\n        .then(responce => { \r\n            if (responce) {\r\n                const deviceParameters = responce.data\r\n                setDeviceData({...deviceParameters}) \r\n            }\r\n        }) \r\n    }\r\n    \r\n    useEffect(() => {\r\n      readDeviceParameters();\r\n      const deviceParametersUpdateInterval = setInterval(readDeviceParameters, 5000);\r\n      return () => {\r\n        clearInterval(deviceParametersUpdateInterval);\r\n      };\r\n    }, [])\r\n\r\n\r\n    return (\r\n        <React.Fragment>\r\n        <Link className=\"nav-link p-0 m-0\" to={`/device/${device.id}/overview/`}>\r\n            <div className='border border-secondary rounded p-2 h-100 bg-dark text-light card-hover' style={{overflow: 'hidden'}} >\r\n                <h6 className='text-nowrap'>{device.name}</h6>\r\n                <div className='p-0 m-0 small w-100'>\r\n                    <table className=\"table table-sm p-0 m-0 table-dark text-light w-100\">\r\n                        <tbody>\r\n                            <tr>\r\n                                <td> Связь: </td>   \r\n                                <td className='text-right'> {deviceData.is_online ? \r\n                                    <span className='text-light' >ОК</span> : \r\n                                    <span className='badge badge-pill badge-danger text-dark' style={{fontSize: '0.85em'}}>НЕТ</span> }\r\n                                </td>\r\n                            </tr> \r\n                            <tr>\r\n                                <td>  Обновлено: </td>   \r\n                                <td className='text-right'> {deviceData.last_update ? \r\n                                    format_time(deviceData.last_update, (deviceData.is_online ? null : 'text-warning')) :\r\n                                    <span className='text-secondary'>никогда</span> } \r\n                                </td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td>   Аварии: </td>   \r\n                                <td className='text-right'> Нет  </td>\r\n                            </tr>                                                         \r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n            </div>\r\n        </Link>    \r\n        </ React.Fragment> \r\n    )                   \r\n}\r\n\r\n\r\n\r\nfunction format_time (time, className='text-light') {\r\n    const s = new Date(time)\r\n    var yesterday = new Date()\r\n    yesterday = yesterday.setDate(yesterday.getDate() - 1);\r\n    if (s > yesterday) {\r\n        let formatter = new Intl.DateTimeFormat([] , {hour: '2-digit', minute: '2-digit'});\r\n        return <span className={className}>{formatter.format(s)}</span>\r\n    } else {\r\n        let formatter = new Intl.DateTimeFormat([] , {month: \"short\", day: \"numeric\" });\r\n        return <span className={className}>{formatter.format(s)}</span>           \r\n    }\r\n}\r\n\r\n\r\n\r\nexport default DeviceCard\r\n","import React from 'react';\r\n\r\nimport DeviceCard from './DeviceCard'\r\n\r\nfunction FacilityCard(props) {\r\n  const facilityInfo = props.facilityInfo   \r\n  const devices = facilityInfo.devices\r\n\r\n  const mapDeviceCards = (ds) => {\r\n    return ds.map((device, index) => {\r\n      return (\r\n        <div key={device.id} className='col-lg-4 col-md-6 col-sm-12 p-1 m-0 h-100'>\r\n          <DeviceCard device={device} index={index}/>\r\n        </div>\r\n      )\r\n    })\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n    <div className='card bg-dark text-light shadow-sm p-0 m-0'>\r\n      <h6 className='px-2 pt-2 pb-0 m-0'>{facilityInfo.name}</h6>\r\n      <div className='container-fluid h-100 p-1 m-0 row'>\r\n          {devices.length > 0 ? mapDeviceCards(devices) : <p className='text-secondary p-1'>Устройств нет ...</p> }       \r\n      </div>\r\n    </div>    \r\n    </ React.Fragment> \r\n  )                   \r\n}\r\n\r\nexport default FacilityCard","import React, { useEffect, useState } from 'react' \r\n\r\nimport Loader from '../../components/BaseParts/Loader'\r\nimport FacilityCard from '../../components/CompanyOverview/FacilityCard'\r\nimport axiosInstance from \"../../utils/axiosApi\";\r\nimport getBaseUrl from '../../utils/localSettings'\r\nconst BASE_URL = getBaseUrl()\r\n\r\n\r\n\r\nexport default function CompanyOverviewPage() {\r\n  const [companyInfo, setCompanyInfo] = useState({})\r\n  const [loading, setLoading] = React.useState(true)\r\n\r\n  useEffect(() => {\r\n    readCompanyInfo( (inf)=> {\r\n      setCompanyInfo(inf);\r\n      setLoading(false);\r\n    });   \r\n  }, [])  \r\n\r\n  return (\r\n    <React.Fragment>\r\n      <h3 className='px-3 pt-3 pb-0'>Предприятие <b>{loading ? null : companyInfo.company.name}</b></h3>\r\n\r\n      <div className='container-fluid py-0 px-2 m-0 row'>\r\n        {loading ? <Loader /> : \r\n          <React.Fragment>\r\n            { companyInfo.facilities.map((facility, index) => {\r\n                return (\r\n                  <div key={facility.id} className='container-fluid px-2 py-0 mx-0 my-2 col-xl-6'>\r\n                    <FacilityCard facilityInfo={facility} index={index}/>\r\n                  </div>\r\n                )\r\n            }) }       \r\n          </React.Fragment>\r\n        }\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n\r\nasync function readCompanyInfo(cb) {\r\n  const request = await axiosInstance.get(BASE_URL + \"/company/info/\")\r\n  cb({...request.data});\r\n}\r\n ","import React from 'react' \r\n\r\n\r\nexport default function EmployersPage() {\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='p-3'>\r\n        <h3>Сотрудники компании</h3>\r\n        <p>Раздел находиться в разработке ... </p>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n","import React from 'react' \r\n\r\n\r\nexport default function FacilitiesPage() {\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='p-3'>   \r\n        <h3>Обзор объектов компании</h3>\r\n        <p>Раздел находиться в разработке ... </p>\r\n      </div> \r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n ","import React from 'react' \r\n\r\n\r\nexport default function CompanyProfilePage() {\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='p-3'> \r\n        <h3>Кабинет</h3>\r\n        <p>Раздел находиться в разработке ... </p>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n ","import React from 'react' \r\nimport {Switch, Route} from 'react-router-dom'\r\n\r\nimport Sidebar from '../../components/BaseParts/CompanySidebar'\r\nimport CompanyOverviewPage from './overview'\r\nimport EmployersPage from './employers'\r\nimport FacilitiesPage from './facilities'\r\nimport CompanyProfilePage from './profile'\r\nimport Page404 from '../pageNotFound'\r\n\r\nexport default function CompanyApp() { \r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='bg-color-dark-gray text-secondary h-100'>\r\n      <div className=\"row m-0 p-0\">\r\n        <Sidebar />\r\n        <div className=\"col-10 m-0 p-0\">\r\n          <div className=\"content-height\">\r\n            <Switch>\r\n              <Route exact path='/company' component={CompanyOverviewPage} />\r\n              <Route exact path='/company/overview' component={CompanyOverviewPage} />\r\n              <Route exact path='/company/facilities' component={FacilitiesPage} />\r\n              <Route exact path='/company/employers' component={EmployersPage} />\r\n              <Route exact path='/company/profile' component={CompanyProfilePage} />\r\n              <Route component={Page404} />\r\n            </Switch>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n","import React from 'react' \r\nimport {Link} from 'react-router-dom'\r\n\r\nimport auth from '../utils/auth' \r\n\r\n\r\nfunction WelcomePage(props) {\r\n  // const backgroundStyle = {\r\n  //   backgroundImage: 'url(\"./img/grid.png\")',\r\n  //   backgroundRepeat: 'repeat-x',\r\n  //   backgroundAttachment: 'fixed'\r\n  // }\r\n\r\n\r\n  function loginDemoUser() {\r\n    const cb = ()=>{ props.history.push('/company/overview/') }\r\n    auth.login('admin', 'admin', cb );\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='bg-color-dark-gray text-light content-height'>\r\n        <div className='container card mt-5 p-3 w-100' style={{background:'rgba(0,0,0,0.8)'}}>\r\n            <div className='text-center pt-4'>\r\n                <h3>Добро пожаловать на <b>BFCloud</b></h3>\r\n            </div>\r\n            <br/>\r\n            <div className='text-center'>\r\n                <h5>Для начала работы\r\n                  <Link className='px-2' to=\"/user/login/\">Войдите</Link>\r\n                  или\r\n                  <Link className='px-2' to=\"/user/registration/\">Зарегистрируйтесь</Link>\r\n                </h5>\r\n            </div>\r\n\r\n            <div className=\"card-columns py-5\">\r\n              <div className=\"card border-secondary\" style={{background:'none'}}>\r\n                <div className=\"card-body text-center\">\r\n                  <h6>Удаленный мониторинга и управления промышленными и IoT устройствами</h6>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"card border-secondary\" style={{background:'none'}}>\r\n                <div className=\"card-body text-center\">\r\n                  <h6>Контроль аварийных событий и уведомление о событиях на объекте </h6>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"card border-secondary\" style={{background:'none'}}>\r\n                <div className=\"card-body text-center\">\r\n                  <h6>Простое подключение и настройка опроса устройств</h6>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"card border-secondary\" style={{background:'none'}}>\r\n                <div className=\"card-body text-center\">\r\n                  <h6>Открытый API для интеграции с сторонним ПО и \r\n                    IoT устройствами \r\n                  </h6>\r\n                </div>\r\n              </div>  \r\n\r\n              <div className=\"card border-secondary\" style={{background:'none'}}>\r\n                <div className=\"card-body text-center\">\r\n                  <h6>Единый интерфейс для Персональных компьютеров и Мобильных устройств </h6>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"card border-secondary\" style={{background:'none'}}>\r\n                <div className=\"card-body text-center\">\r\n                  <h6> Вы можете воспользоваться демо-версией сервиса \r\n                    <a className=\"px-2\" href='#' onClick={loginDemoUser}>Демо-версия: БУМП-14</a>\r\n                  </h6> \r\n                </div>\r\n              </div>\r\n            </div>            \r\n        </div>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\nexport default WelcomePage","import React, { Component } from \"react\";\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport auth from '../../utils/auth' \r\n\r\n\r\nclass Login extends Component {\r\n  constructor(props) {\r\n      super(props);\r\n      this.state = {username: \"\", password: \"\"};\r\n\r\n      this.handleChange = this.handleChange.bind(this);\r\n      this.handleSubmit = this.handleSubmit.bind(this);\r\n  }\r\n\r\n  handleChange(event) {\r\n      this.setState({[event.target.name]: event.target.value});\r\n  }\r\n\r\n  handleSubmit(event) {\r\n    event.preventDefault();\r\n    const cb = ()=>{ this.props.history.push('/company/overview/') }\r\n    auth.login(this.state.username, this.state.password, cb );\r\n  }\r\n\r\n  render() {\r\n    return (\r\n    <div className='bg-color-dark-gray text-secondary content-height'>  \r\n      <div className='container card p-3 mt-5 bg-dark' style={{maxWidth: '500px'}}>\r\n        <h2>Вход</h2>\r\n        <form onSubmit={this.handleSubmit}>\r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"username\">Пользователь:</label>\r\n            <input name=\"username\" type=\"text\" className=\"form-control bg-secondary border-secondary text-light\" id=\"username\" value={this.state.username} onChange={this.handleChange}/>\r\n          </div> \r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"pwd\">Пароль:</label> \r\n            <input name=\"password\" type=\"password\" className=\"form-control bg-secondary border-secondary text-light\" id=\"pwd\" value={this.state.password} onChange={this.handleChange}/>\r\n          </div> \r\n          <button type=\"submit\" className=\"btn btn-outline-primary\">Войти</button>\r\n          <div className=\"pt-3\">\r\n            <span className=\"pr-2 text-secondary\">Еще не зарегестрированы?</span>\r\n            <Link className=\"\" to=\"/user/registration/\">Регистрация</Link>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n    )\r\n  }\r\n}\r\nexport default Login;","import React, { Component } from \"react\";\r\nimport {Link} from 'react-router-dom'\r\n\r\nimport axiosInstance from \"../../utils/axiosApi\";\r\n\r\nclass Signup extends Component{\r\n    constructor(props){\r\n        super(props);\r\n        this.state = {\r\n            username: \"\",\r\n            password: \"\",\r\n            email:\"\",\r\n            errors:{username:null, email:null, password:null}\r\n        };\r\n\r\n        this.handleChange = this.handleChange.bind(this);\r\n        this.handleSubmit = this.handleSubmit.bind(this);\r\n    }\r\n\r\n    handleChange(event) {\r\n        this.setState({[event.target.name]: event.target.value});\r\n    }\r\n\r\n    async handleSubmit(event) {\r\n      event.preventDefault();\r\n      try {\r\n          const response = await axiosInstance.post('/user/create/', {\r\n              username: this.state.username,\r\n              email: this.state.email,\r\n              password: this.state.password\r\n          });\r\n          return response;\r\n      } catch (error) {\r\n          console.log(error.stack);\r\n          this.setState({\r\n            errors:error.response.data\r\n          });           \r\n      }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n          <div className='bg-color-dark-gray text-secondary content-height'>  \r\n            <div className='container card p-3 mt-5 bg-dark' style={{maxWidth: '500px'}}>\r\n                <h2>Регистрация</h2>              \r\n                <form onSubmit={this.handleSubmit}>\r\n                  <div className=\"form-group\">\r\n                    <label htmlFor=\"username\">Имя пользователя:</label>\r\n                    <input name=\"username\" type=\"text\" className=\"form-control bg-secondary border-secondary text-light\" id=\"username\" value={this.state.username} onChange={this.handleChange}/>\r\n                    { this.state.errors.username ? <span className='text-danger'>{this.state.errors.username}</span> : null}\r\n                  </div> \r\n                  <div className=\"form-group\">\r\n                    <label htmlFor=\"mail\">Электронная почта:</label>\r\n                    <input name=\"email\" type=\"email\" className=\"form-control bg-secondary border-secondary text-light\" id=\"mail\" value={this.state.email} onChange={this.handleChange}/>\r\n                    { this.state.errors.email ? <span className='text-danger'>{this.state.errors.email}</span> : null}\r\n                  </div> \r\n                  <div className=\"form-group\">\r\n                    <label htmlFor=\"pwd\">Пароль:</label> \r\n                    <input name=\"password\" type=\"password\" className=\"form-control bg-secondary border-secondary text-light\" id=\"pwd\" value={this.state.password} onChange={this.handleChange}/>\r\n                    { this.state.errors.password ? <span className='text-danger'>{this.state.errors.password}</span> : null}\r\n                  </div> \r\n                  <button type=\"submit\" className=\"btn btn-outline-primary\">Подтвердить</button>\r\n                  <div className=\"pt-3\">\r\n                    <span className=\"pr-2 text-secondary\">Уже зарегестрированы?</span>\r\n                    <Link className=\"\" to=\"/user/login/\">Вход</Link>\r\n                  </div>\r\n                </form>\r\n            </div>\r\n          </div>\r\n        )\r\n    }\r\n}\r\nexport default Signup;","import React from 'react' \r\n\r\n\r\nexport default function ProfilePage(props) {\r\n  return (\r\n    <React.Fragment>\r\n    <div className='bg-color-dark-gray text-secondary content-height'> \r\n      <div className='container card bg-dark shadow-sm my-4 pt-4'>\r\n        <h2>Профиль пользователя</h2>\r\n\r\n        <div className='row my-3'>\r\n          <div className='col-lg-6'>\r\n            <table className=\"table text-light tadle-dark \">\r\n              <tbody>\r\n                <tr>\r\n                  <td className='border-secondary'>Пользователь:</td> \r\n                  <td className='border-secondary'><b>{props.userInfo.username}</b></td>\r\n                </tr>\r\n                <tr>\r\n                  <td className='border-secondary'>Имя:</td> \r\n                  <td className='border-secondary'><b>{props.userInfo.first_name}</b></td>\r\n                </tr>\r\n                <tr>\r\n                  <td className='border-secondary'>Фамилия:</td> \r\n                  <td className='border-secondary'><b>{props.userInfo.last_name}</b></td>\r\n                </tr>\r\n                <tr>\r\n                  <td className='border-secondary'>Электронная почта:</td> \r\n                  <td className='border-secondary'><b>{props.userInfo.email}</b></td>\r\n                </tr>            \r\n              </tbody>\r\n            </table>\r\n          </div> \r\n        </div> \r\n      </div>  \r\n    </div>\r\n    </React.Fragment>\r\n);\r\n}\r\n","import './App.css'\r\nimport '../node_modules/react-vis/dist/style.css'\r\n\r\nimport React, { useEffect, useState } from 'react' \r\nimport {\r\n  BrowserRouter as Router, \r\n  Switch, \r\n  Route,\r\n} from 'react-router-dom'\r\n\r\nimport {ProtectedRoute} from './utils/protectedRoute'\r\nimport { FullScreen, useFullScreenHandle } from \"react-full-screen\";\r\n\r\nimport Navbar from './components/BaseParts/Navbar'\r\nimport DeviceApp from './pages/device/deviceApp'\r\nimport CompanyApp from './pages/company/companyApp'\r\nimport WelcomePage from './pages/welcome'\r\nimport Login from './pages/users/login'\r\nimport Registration from './pages/users/registration'\r\nimport ProfilePage from './pages/users/profile'\r\nimport Page404 from './pages/pageNotFound'\r\n\r\nimport auth from './utils/auth'\r\n\r\nexport default function App() {\r\n  const [loading, setLoading] = useState(true)\r\n  const [loading2, setLoading2] = useState(true)\r\n  const [authed, setAuthed] = useState(false)\r\n  const [userInfo, setUserInfo] = useState({})\r\n\r\n  const handle = useFullScreenHandle();\r\n\r\n  useEffect(() => {\r\n    auth.checkAuthentication(() => { setLoading(false) })\r\n    auth.onLogin = () => {setAuthed(true)}    \r\n    auth.onLogout = () => {setAuthed(false)}    \r\n    auth.onUserInfoReaded = (ui) => {\r\n      setUserInfo(ui); \r\n      setLoading2(false);\r\n    }   \r\n  }, [])\r\n\r\n  if (loading || loading2) { \r\n    return null \r\n  } else { \r\n    return (\r\n      <React.Fragment>\r\n        <button className='full-screen-button fas fa-expand ' onClick={handle.enter}></button>\r\n        <FullScreen handle={handle}>\r\n          <Router>        \r\n            <Route exact path='/' component={()=>{\r\n              return (\r\n              <video autoplay=\"autoplay\" muted loop=\"loop\" id=\"myVideo\">\r\n                <source src=\"Earth13426.mp4\" type=\"video/mp4\" />\r\n              </video>\r\n              )}\r\n            }/>\r\n\r\n            <Navbar authed={authed} userInfo = {userInfo} />\r\n            <Switch>\r\n              <Route exact path='/' component={WelcomePage} />\r\n              <Route exact path='/user/login' component={Login}  />\r\n              <Route exact path='/user/registration' component={Registration} />\r\n              <ProtectedRoute exact path='/user/profile' component={ ()=> <ProfilePage userInfo = {userInfo} /> } />\r\n              <ProtectedRoute path='/company' component={CompanyApp} />                   \r\n              <ProtectedRoute path='/device/:id' component={DeviceApp} />\r\n              <Route component={Page404} />\r\n            </Switch>\r\n          </Router>\r\n        </FullScreen>\r\n      </React.Fragment>\r\n    )\r\n  }\r\n}\r\n\r\n\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}