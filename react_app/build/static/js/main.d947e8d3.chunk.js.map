{"version":3,"sources":["backendAPI/axiosApi.js","backendAPI/localSettings.js","backendAPI/auth.js","utils/protectedRoute.js","device/utils/sortWidgetsByOrder.js","device/components/DeviceSidebar.js","device/components/DeviceHeader.js","utils/useTargetClick.js","Widgets/components/TagsGraph/Graph.js","Widgets/components/TagsGraph/GraphWithCrosshair.js","Widgets/components/TagsGraph/Legend.js","Widgets/components/TagsGraph/Toolbar.js","base/components/Loader.js","Widgets/components/TagsGraph/TagsHistoricalGraph.js","Widgets/components/TagsGraph/GraphColors.js","Widgets/WidgetGraph.js","Widgets/components/TagsList/TagsCurrentValueRow.js","Widgets/components/TagsList/TagsCurrentValueList.js","Widgets/WidgetTable.js","Widgets/components/TagsIndicator/TagIndicator.js","Widgets/WidgetIndicator.js","Widgets/components/EventsLog/RecordsRow.js","Widgets/components/EventsLog/RecordsList.js","Widgets/WidgetEventsLog.js","Widgets/renderWidgets.js","device/pages/overview.js","device/pages/settings.js","device/pages/eventsLog.js","device/pages/graphs.js","backendAPI/backendAPI.js","base/forms/forms.js","device/pages/tagDetail.js","device/pages/deviceDetail.js","base/pages/pageNotFound.js","device/components/AdminPageDeviceStatusBar.js","device/pages/deviceAdmin.js","device/pages/widgetsAdmin.js","device/pages/eventsAdmin.js","device/pages/eventDetail.js","device/deviceApp.js","company/components/CompanySidebar.js","company/components/DeviceCard.js","company/components/FacilityCard.js","company/pages/overview.js","company/pages/employers.js","company/pages/facilitiesOnMap.js","company/pages/profile.js","company/companyApp.js","users/pages/login.js","users/pages/registration.js","users/pages/profile.js","users/components/LogoutBtn.js","base/components/Navbar.js","base/pages/welcome.js","App.js","reportWebVitals.js","index.js"],"names":["axiosInstance","axios","create","baseURL","timeout","headers","localStorage","getItem","interceptors","response","use","error","originalRequest","config","status","url","Promise","reject","data","code","statusText","refreshToken","tokenParts","JSON","parse","atob","split","now","Math","ceil","Date","exp","post","refresh","then","setItem","access","defaults","catch","err","console","log","this","authenticated","onLogin","onLogout","onUserInfoReaded","cb","get","_onLogin","_onLogout","username","password","removeItem","request","userInfo","readUserInfo","clearUserInfo","ProtectedRoute","Component","component","rest","render","props","auth","isAuthenticated","to","pathname","state","from","location","sortWidgetsByOrder","template","widgets","sort","a","b","KeyA","parseInt","order","KeyB","Sidebar","React","useState","displaySubMenu","setDisplaySubMenu","deviceId","styleBtnRemoveOutline","outline","boxShadow","className","style","overflow","id","role","aria-orientation","activeClassName","fontSize","onClick","Fragment","DeviceHeader","deviceData","setDeviceData","device_id","readDeviceParameters","BASE_URL","params","responce","useEffect","deviceParametersUpdateInterval","setInterval","clearInterval","name","is_online","verbose_last_update","useTargetClick","ref","callback","handleClick","e","current","contains","target","document","addEventListener","removeEventListener","Graph","displayedTags","tags","filter","tag","disabled","resetZoomButton","lastDrawLocation","setLastDrawLocation","replace","has_displayed_tags","map","values","length","margin","left","right","top","bottom","xType","animation","xDomain","yDomain","yPadding","stroke","line","tickTotal","color","curve_color","tag_id","onBrushEnd","area","onDrag","setState","dontCheckIfEmpty","x","y","crosshairValues","setCrosshairValues","crosshairData","value","title","tag_name","_onNearestX","index","d","onMouseLeave","onNearestX","point","size","backgroundColor","background","colSpan","time","s","Intl","DateTimeFormat","dateStyle","timeStyle","format","format_time","paddingTop","Legend","searchText","setSearchText","items","height","onSearchChange","searchPlaceholder","onItemClick","item","Toolbar","showRangeForm","setShowRangeForm","activeButton","setActiveButton","changeGraphInterval","toggleActiveButton","btn","getActiveCalss","type","RangeForm","Loader","TagsHistoricalGraph","setModal","crosshair","setCrosshair","graphCard","useRef","graphContainer","modalButton","crosshairButton","legendContainer","tagsHistory","GRAPH_HEIGH","toggleModal","cl","includes","legend","toggleCroshair","width","textDecoration","loading","GraphWithCrosshair","toggleCurveDisplay","toolbar","colors","getColor","clorsNumber","WidgetGraph","setLoading","interval","resolution","widget","graphInterval","setGraphInterval","setTagsHistory","readTagsHistory","prepared_tags","tag_code","add_date","prev","fltr","entry","updateTagsHistory","loadingTimeout","setTimeout","graphUpdateInterval","clearTimeout","n","TagsCurrentValueRow","columns","indexOf","TagsCurrentValueList","WidgetTable","setTags","readDeviceTags","tagsUpdateInterval","TagIndicator","addTextRight","addTextLeft","precision","toFixed","WidgetIndicator","record","format_date","date","message","formatter","toggleCategorySelection","categories","category_selection_panel","CategorySelectionPanel","records","RecordsTable","NoRecords","PaginationBar","readNextPage","readPreviousPage","changePage","pagination","category","CategorySecetionButton","selected","children","list","Array","apply","num_pages","active","page_number","minWidth","WidgetEventsLog","setRecords","setCategories","next","previous","setPagination","page","setPage","readLogPage","selected_category_codes","results","readLogRecords","updateFirstPage","toggle_index","RenderWidgets","widgetsTemplate","WidgetRender","min","DeviceOverviewPage","useParams","DeviceSettingsPage","WidgetsTemplate","DeviceEventsLogPage","getDeviceParameters","cb_success","backendApiRequest","GET","getDeviceTagsParameters","tags_list","postDeviceTagsParameters","tags_parameters","cb_error","POST","getEventsConfig","events_list","events_id","postEventsConfig","events_parameters","deleteEvents","DELETE","method","endpoint","body","delete","TextField","htmlFor","titel","placeholder","defaultValue","onChange","ErrorMessage","errors","CommentMessage","comment","NumberField","max","SelectField","hidden","options","option","MultipleSelectField","multiple","CheckboxField","checked","FormContainer","maxWidth","getSelectedOptions","i","l","push","TagDetailPage","tagParameters","setTagParameters","formErrors","setFormErrors","history","useHistory","TagDetailForm","submitTagParameters","tag_parameters","responce_data","errors_data","cancelChanges","deleteTag","deleteDeviceTags","TagCreatePage","data_type","modbus_parameters","register_address","read_function","write_function","setTag","onSubmit","onCancel","onDelete","buttonsStyle","preventDefault","non_field_errors","DeviceConfigPage","deviceParameters","setDeviceParameters","deviceParametersFormErrors","setDeviceParametersFormErrors","deviceModbusParameters","setDeviceModbusParameters","deviceModbusParametersFormErrors","setDeviceModbusParametersFormErrors","deviceTagsParameters","setDeviceTagsParameters","loading1","setLoading1","loading2","setLoading2","loading3","setLoading3","getDeviceModbusParameters","DeviceConfigsForm","submitDeviceConfig","device_parameters","postDeviceParameters","DeviceModbusParametersForm","submitModbusParameters","postDeviceModbusParameters","TagsList","parameters","setParameters","polling_period","protocol_type","device_address","baudrate","address_size","parity","stopbit","packet_timout","bit_timout","lower_byte_forward","lower_register_forward","allow_group_reading","TagsListEntry","Page404","DeviceStatusBar","DeviceAdminPage","minHeight","exact","path","WidgetsAdminPage","updateWidgetsTemplate","setWidgetsTemplate","selectedWidget","setSelectedWidget","displayWidget","setDisplayWidget","rerenderWidgetForm","addWidgetToTemplate","WidgetsGrid","changeSelectedWidget","widgetNumber","WidgetsControlPanel","addWidget","DefaultTable","DefaultGraph","DefaultIndicator","saveWidgetsTemplate","WidgetForm","updateWidget","WidgetData","wt","w","deleteWidget","splice","content","btnAddClass","WidgetPreview","show","setShow","handleClose","ModalSelectWidgetType","handleAddWidget","WTableForm","WGraphForm","WIndicatorForm","WidgetTypeButton","tagsOptions","EventsAdminPage","events","setEvents","EventsList","handlEventDelete","event_id","event","toggleEventEnable","enable","ev","NoEvents","EventsListEntry","raise_message","is_active","EventDetailPage","setEvent","eventFormErrors","setEventFromErrors","EventForm","EventCreatePage","defaultEventSettings","device","expression","data-toggle","data-target","fall_message","raise_time","date_style","time_style","DeviceApp","newTemplate","postWidgetsTemplate","getWidgetsTemplate","template_data","yesterday","setDate","getDate","hour","minute","month","day","DeviceCard","last_update","FacilityCard","ds","facilityInfo","devices","CompanyOverviewPage","companyInfo","setCompanyInfo","readCompanyInfo","inf","company","facilities","facility","EmployersPage","FacilitiesOnMapPage","CompanyProfilePage","CompanyApp","Login","handleChange","bind","handleSubmit","login","Signup","email","stack","ProfilePage","first_name","last_name","LogoutBtn","handleLogout","logout","withRouter","Navbar","authed","zIndex","WelcomePage","href","App","setAuthed","setUserInfo","handle","useFullScreenHandle","checkAuthentication","ui","enter","autoplay","muted","loop","src","Registration","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.d947e8d3.chunk.js","sourcesContent":["import axios from 'axios'\r\n\r\nimport getBaseUrl from './localSettings'\r\nconst baseURL = getBaseUrl();\r\n\r\nconst axiosInstance = axios.create({\r\n    baseURL: baseURL,\r\n    timeout: 60000,\r\n    headers: {\r\n        'Authorization': \"JWT \" + localStorage.getItem('access_token'),\r\n        'Content-Type': 'application/json',\r\n        'accept': 'application/json'\r\n    }\r\n});\r\n\r\n\r\naxiosInstance.interceptors.response.use(\r\n    response => response,\r\n    error => {\r\n        const originalRequest = error.config;\r\n\r\n        // Prevent infinite loops\r\n        if (error.response.status === 401 && originalRequest.url === '/user/token/refresh/') {\r\n            // window.location.href = '/user/login/';                  \r\n            return Promise.reject(error);\r\n        }\r\n\r\n        if (error.response.data.code === \"token_not_valid\" &&\r\n            error.response.status === 401 && \r\n            error.response.statusText === \"Unauthorized\") \r\n            {\r\n                const refreshToken = localStorage.getItem('refresh_token');\r\n\r\n                if (refreshToken){\r\n                    const tokenParts = JSON.parse(atob(refreshToken.split('.')[1]));\r\n\r\n                    // exp date in token is expressed in seconds, while now() returns milliseconds:\r\n                    const now = Math.ceil(Date.now() / 1000);\r\n\r\n                    if (tokenParts.exp > now) {\r\n                        return axiosInstance\r\n                        .post('/user/token/refresh/', {refresh: refreshToken})\r\n                        .then((response) => {\r\n            \r\n                            localStorage.setItem('access_token', response.data.access);\r\n                            localStorage.setItem('refresh_token', response.data.refresh);\r\n            \r\n                            axiosInstance.defaults.headers['Authorization'] = \"JWT \" + response.data.access;\r\n                            originalRequest.headers['Authorization'] = \"JWT \" + response.data.access;\r\n            \r\n                            return axiosInstance(originalRequest);\r\n                        })\r\n                        .catch(err => {\r\n                            console.log(err)\r\n                        });\r\n                    }else{\r\n                        console.log(\"Refresh token is expired\", tokenParts.exp, now);\r\n                        // window.location.href = 'user/login/';\r\n                    }\r\n                }else{\r\n                    console.log(\"Refresh token not available.\")\r\n                    // window.location.href = 'user/login/';\r\n                }\r\n        }\r\n      \r\n     \r\n      // specific error handling done elsewhere\r\n      return Promise.reject(error);\r\n  }\r\n);\r\n\r\n\r\nexport default axiosInstance","\r\n\r\nexport default function getBaseUrl(){\r\n    return \"http://bfcloud.space\"\r\n    // return \"http://localhost:8000\"\r\n}","import axiosInstance from \"./axiosApi\";\r\n\r\nclass Auth{\r\n    constructor() {\r\n        this.authenticated = false;\r\n        this.onLogin = ()=>{};\r\n        this.onLogout = ()=>{};\r\n        this.onUserInfoReaded = ()=>{};\r\n    }\r\n\r\n    async checkAuthentication (cb) {\r\n        try {\r\n            const response = await axiosInstance.get('/user/token/check/')\r\n            if (response) {\r\n                this._onLogin();\r\n            } else {\r\n                this._onLogout();\r\n            }\r\n        } catch (error) {\r\n            this._onLogout();\r\n        }    \r\n        cb();         \r\n    }\r\n\r\n    async login(username, password, cb) {\r\n        try {\r\n            const response = await axiosInstance.post('/user/token/obtain/', {\r\n              username: username,\r\n              password: password\r\n            });\r\n            axiosInstance.defaults.headers['Authorization'] = \"JWT \" + response.data.access;\r\n            localStorage.setItem('access_token', response.data.access);\r\n            localStorage.setItem('refresh_token', response.data.refresh);\r\n            this._onLogin();\r\n            cb();\r\n        } catch (error) {\r\n            throw error;\r\n        }\r\n    }\r\n\r\n    async logout(cb) {\r\n        try {\r\n            await axiosInstance.post('user/token/blacklist/', {\r\n                \"refresh_token\": localStorage.getItem(\"refresh_token\")\r\n            });\r\n            localStorage.removeItem('access_token');\r\n            localStorage.removeItem('refresh_token');\r\n            axiosInstance.defaults.headers['Authorization'] = null;\r\n        } catch (error) {\r\n            console.log(error);\r\n        }\r\n        this._onLogout();\r\n        cb();        \r\n    }\r\n\r\n    isAuthenticated() {\r\n        return this.authenticated;\r\n    }\r\n\r\n    async readUserInfo(){\r\n        const request = await axiosInstance.get('/user/info/')\r\n        this.onUserInfoReaded( { ...request.data } )\r\n    }\r\n\r\n    clearUserInfo(){\r\n        this.userInfo = {}\r\n        this.onUserInfoReaded( {} )\r\n    }\r\n\r\n    _onLogin () {\r\n        this.authenticated = true;\r\n        this.onLogin();\r\n        this.readUserInfo();\r\n    }\r\n    _onLogout () {\r\n        this.authenticated = false;\r\n        this.onLogout();\r\n        this.clearUserInfo();        \r\n    }\r\n}\r\n\r\nexport default new Auth()","import React from 'react' \r\nimport {Route, Redirect} from 'react-router-dom'\r\n\r\nimport auth from '../backendAPI/auth' \r\n\r\n\r\n\r\nexport const ProtectedRoute = ({component: Component, ...rest}) => {\r\n  return (\r\n    <Route\r\n      {...rest}\r\n      render={(props) => {\r\n        if (auth.isAuthenticated()) {\r\n          return <Component {...props} />\r\n        } else {\r\n          return <Redirect to={{pathname: '/user/login', state: {from: props.location}}} />\r\n        }\r\n      }}\r\n    />\r\n  )\r\n}","\r\n\r\nexport default function sortWidgetsByOrder(template) {\r\n    var widgets = template.widgets\r\n    if (!widgets) {return {'widgets':[]}}\r\n\r\n\r\n    widgets.sort( (a, b) => {\r\n        var KeyA = parseInt(a.order)\r\n        var KeyB = parseInt(b.order)\r\n        if (KeyA < KeyB) return -1;\r\n        if (KeyA > KeyB) return 1;\r\n        return 0;\r\n      });\r\n\r\n\r\n    return {'widgets':widgets}\r\n}","import React from 'react'\r\nimport {NavLink} from 'react-router-dom'\r\n\r\nexport default function Sidebar(props) {\r\n  const [displaySubMenu, setDisplaySubMenu] = React.useState(false)\r\n  const {deviceId} = props\r\n\r\n  const styleBtnRemoveOutline = {outline: 'none', boxShadow: 'none'}\r\n\r\n  return (\r\n    <div className=\"col-2 m-0 p-0\">\r\n      <div className=\"bg-dark bg-color-gray p-2 h-100\">\r\n        <div className=\"p-1\">\r\n\r\n          <div className=\"nav flex-column nav-pills\" style={{overflow: 'hidden'}} id=\"v-pills-tab\" role=\"tablist\" aria-orientation=\"vertical\">\r\n              <NavLink className=\"nav-link text-light btn\" style={styleBtnRemoveOutline} activeClassName=\"bg-dark\" to={`/device/${deviceId}/overview/`}>\r\n                <div className=\"d-inline-flex w-100 justify-content-center justify-content-lg-start\">\r\n                  <i className='fas fa-home' style={{fontSize:'1.3em'}}></i>\r\n                  <span className='pl-3 d-none d-lg-inline text-left'>Обзор</span>\r\n                </div>\r\n              </NavLink>\r\n              <NavLink className=\"nav-link text-light btn\" style={styleBtnRemoveOutline} activeClassName=\"bg-dark\" to={`/device/${deviceId}/settings/`}>\r\n                <div className=\"d-inline-flex w-100 justify-content-center justify-content-lg-start \">\r\n                  <i className='far fa-edit' style={{fontSize:'1.3em'}}></i>\r\n                  <span className='pl-3 d-none d-lg-inline text-left'>Настройки</span>\r\n                </div> \r\n              </NavLink>\r\n              <NavLink className=\"nav-link text-light btn\" style={styleBtnRemoveOutline} activeClassName=\"bg-dark\" to={`/device/${deviceId}/graphs/`}>\r\n                <div className=\"d-inline-flex w-100 justify-content-center justify-content-lg-start\">\r\n                  <i className='far fa-chart-bar' style={{fontSize:'1.3em'}}></i>\r\n                  <span className='pl-3 d-none d-lg-inline text-left'>Графики</span>\r\n                </div>\r\n              </NavLink>\r\n              <NavLink className=\"nav-link text-light btn\" style={styleBtnRemoveOutline} activeClassName=\"bg-dark\" to={`/device/${deviceId}/events/`}> \r\n                <div className=\"d-inline-flex w-100 justify-content-center justify-content-lg-start\">\r\n                  <i className='far fa-bell' style={{fontSize:'1.3em'}}></i>\r\n                  <span className='pl-3 d-none d-lg-inline text-left'>Журнал</span>\r\n                </div>\r\n              </NavLink>\r\n            </div>\r\n\r\n\r\n            <div className=\"nav flex-column nav-pills\" style={{overflow: 'hidden'}} >              \r\n              <div className='border-top mt-3 pt-3 border-secondary'></div>\r\n              <button className=\"nav-link text-light btn\" style={styleBtnRemoveOutline} onClick={()=>{setDisplaySubMenu(!displaySubMenu)}}>\r\n                <div className=\"d-inline-flex w-100 justify-content-center justify-content-lg-start\">\r\n                  <i className='\tfas fa-list py-1' style={{fontSize:'1.3em'}}></i>\r\n                  <span className='pl-3 d-none d-lg-inline text-left'>Администрирование</span>\r\n                  <i className='fas fa-caret-down py-1 pl-1 ml-auto d-none d-lg-inline' ></i>\r\n                </div>\r\n              </button>\r\n\r\n              {displaySubMenu && <React.Fragment>\r\n                <NavLink className=\"nav-link text-light btn\" style={styleBtnRemoveOutline} activeClassName=\"bg-dark\" to={`/device/${deviceId}/admin/config/`}> \r\n                  <div className=\"d-inline-flex w-100 justify-content-center justify-content-lg-start\">\r\n                    <i className='fas fa-circle px-1 pt-2' style={{fontSize:'0.6em'}}></i>\r\n                    <span className='pl-3 d-none d-lg-inline text-left'>Прибор</span>\r\n                  </div>\r\n                </NavLink>\r\n\r\n                <NavLink className=\"nav-link text-light btn\" style={styleBtnRemoveOutline} activeClassName=\"bg-dark\" to={`/device/${deviceId}/admin/widgets/`}> \r\n                  <div className=\"d-inline-flex w-100 justify-content-center justify-content-lg-start\">\r\n                    <i className='fas fa-circle px-1 pt-2' style={{fontSize:'0.6em'}}></i>\r\n                    <span className='pl-3 d-none d-lg-inline text-left'>Виджеты</span>\r\n                  </div>\r\n                </NavLink>\r\n\r\n                <NavLink className=\"nav-link text-light btn\" style={styleBtnRemoveOutline} activeClassName=\"bg-dark\" to={`/device/${deviceId}/admin/events/`}> \r\n                  <div className=\"d-inline-flex w-100 justify-content-center justify-content-lg-start\">\r\n                    <i className='fas fa-circle px-1 pt-2' style={{fontSize:'0.6em'}}></i>\r\n                    <span className='pl-3 d-none d-lg-inline text-left'>События</span>\r\n                  </div>\r\n                </NavLink>\r\n              </React.Fragment> }\r\n          </div>\r\n          \r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}","import React, { useEffect } from 'react' \r\n\r\nimport axiosInstance from \"../../backendAPI/axiosApi\";\r\nimport getBaseUrl from '../../backendAPI/localSettings'\r\nconst BASE_URL = getBaseUrl()\r\n\r\n\r\n\r\nexport default function DeviceHeader(props) {\r\n  const [deviceData, setDeviceData] = React.useState({})\r\n  const device_id = props.device_id;\r\n\r\n  function readDeviceParameters() {\r\n    axiosInstance.get(BASE_URL + \"/device/parameters/\", { params: { id: device_id }} )\r\n      .then(responce => { \r\n        responce && setDeviceData({...responce.data}) \r\n      }) \r\n  }\r\n  \r\n  useEffect(() => {\r\n    readDeviceParameters();\r\n    const deviceParametersUpdateInterval = setInterval(readDeviceParameters, 5000);\r\n    return () => {\r\n      clearInterval(deviceParametersUpdateInterval);\r\n    };\r\n  }, [])\r\n\r\n  \r\n  // render the page\r\n  return (\r\n    <React.Fragment>\r\n      <div className='d-flex border rounded border-dark px-3 mb-1 mx-1'>\r\n        <h3 className='pt-1'>Устройство: <b>{deviceData.name}</b></h3>\r\n        <div className='ml-auto mx-3 px-3 border-x border-dark'>\r\n          { deviceData.is_online ? \r\n            <div className='text-success'>\r\n              <span>Онлайн</span> <br/>\r\n              <i className='fas fa-check text-center w-100'></i>\r\n            </div>\r\n          : <div className='text-danger'>\r\n              <span>Нет связи</span> <br/>\r\n              <i className='fas fa-times text-center w-100'></i>\r\n            </div>\r\n          }\r\n        </div>\r\n        <div>\r\n          <p className='m-0 mr-1 text-right'>Данные обновлены: <br/> {deviceData.verbose_last_update}</p>\r\n        </div>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n","import { useEffect } from \"react\";\r\n\r\nconst useTargetClick = (ref, callback) => {\r\n  const handleClick = e => {\r\n    if (ref.current && ref.current.contains(e.target)) {\r\n      callback();\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    document.addEventListener(\"click\", handleClick);\r\n\r\n    return () => {\r\n      document.removeEventListener(\"click\", handleClick);\r\n    };\r\n  });\r\n};\r\n\r\nexport default useTargetClick;","import React, {useEffect} from 'react';\r\nimport PropTypes from 'prop-types'\r\nimport {\r\n    FlexibleXYPlot, \r\n    XAxis, \r\n    YAxis, \r\n    LineSeries,\r\n    // VerticalGridLines, \r\n    HorizontalGridLines, \r\n    Highlight} from 'react-vis';\r\n\r\nimport useTargetClick from '../../../utils/useTargetClick'\r\n\r\n\r\nfunction Graph(props) {\r\n  const tags = props.tags \r\n  const displayedTags = tags.filter( tag => tag.disabled === false )\r\n  const resetZoomButton = props.resetZoomButton\r\n  const [lastDrawLocation, setLastDrawLocation] = React.useState(null)\r\n\r\n  useTargetClick(resetZoomButton, ()=>{\r\n    console.log('seted onclick')\r\n    setLastDrawLocation(null)\r\n  })\r\n\r\n  useEffect(() => {\r\n    if (lastDrawLocation) {\r\n      resetZoomButton.current.className = resetZoomButton.current.className.replace('d-none', 'd-block')\r\n    } else {\r\n      resetZoomButton.current.className = resetZoomButton.current.className.replace('d-block', 'd-none')\r\n    }\r\n  }, [lastDrawLocation])\r\n\r\n  \r\n  let has_displayed_tags = false\r\n  displayedTags.map( (tag) => {\r\n    if (tag.values.length > 0) {has_displayed_tags = true}\r\n  })\r\n\r\n  if (has_displayed_tags) {\r\n    return (\r\n      <React.Fragment>\r\n        <div className='graph-container h-100' style={{overflow: 'hidden'}}>\r\n          <FlexibleXYPlot \r\n            margin={{left: 40, right: 0, top: 0, bottom: 30}} \r\n            xType=\"time\"\r\n            animation\r\n            xDomain={\r\n              lastDrawLocation && [\r\n                lastDrawLocation.left,\r\n                lastDrawLocation.right\r\n              ]\r\n            }\r\n            yDomain={\r\n              lastDrawLocation && [\r\n                lastDrawLocation.bottom,\r\n                lastDrawLocation.top\r\n              ]\r\n            }\r\n            yPadding={10} \r\n          >\r\n            <HorizontalGridLines style={{stroke: '#444A50'}} />\r\n            <XAxis style={{line:{stroke: '#6c757d'}}} tickTotal={15} />\r\n            <YAxis style={{line:{stroke: '#6c757d'}}} />\r\n            { displayedTags.map((tag)=>{ \r\n              return <LineSeries data={tag.values} color={tag.curve_color} key={tag.tag_id} />\r\n            }) }\r\n\r\n            <Highlight\r\n              onBrushEnd={area => setLastDrawLocation(area)}\r\n              onDrag={area => {\r\n                this.setState({\r\n                  lastDrawLocation: {\r\n                    bottom: lastDrawLocation.bottom + (area.top - area.bottom),\r\n                    left: lastDrawLocation.left - (area.right - area.left),\r\n                    right: lastDrawLocation.right - (area.right - area.left),\r\n                    top: lastDrawLocation.top + (area.top - area.bottom)\r\n                  }\r\n                });\r\n                }}\r\n              />\r\n          </FlexibleXYPlot>\r\n        </div>\r\n      </ React.Fragment>\r\n    );\r\n  } else {\r\n    return (\r\n      <React.Fragment>\r\n      <div className='graph-container h-100'>\r\n        <FlexibleXYPlot \r\n          dontCheckIfEmpty\r\n          margin={{left: 30, right: 0, top: 0, bottom: 30}}      \r\n        >\r\n          <HorizontalGridLines style={{stroke: '#444A50'}} />\r\n          <XAxis />\r\n          <YAxis />\r\n          <LineSeries data={[{x:0, y:0}]} /> \r\n        </FlexibleXYPlot>\r\n      </div>\r\n      </ React.Fragment> \r\n    )                   \r\n  }\r\n}\r\n\r\n\r\nGraph.propTypes = {\r\n    tags: PropTypes.arrayOf(PropTypes.object).isRequired\r\n}\r\n\r\nexport default Graph","import React, {useEffect} from 'react';\r\nimport PropTypes from 'prop-types'\r\nimport {\r\n    FlexibleXYPlot, \r\n    XAxis, \r\n    YAxis, \r\n    LineSeries,\r\n    MarkSeries,\r\n    Crosshair,\r\n    // VerticalGridLines, \r\n    HorizontalGridLines, \r\n    Highlight} from 'react-vis';\r\n\r\nimport useTargetClick from '../../../utils/useTargetClick'\r\n\r\n\r\n\r\nfunction Graph(props) {\r\n  const tags = props.tags   \r\n  const displayedTags = tags.filter( tag => tag.disabled === false )  \r\n  const resetZoomButton = props.resetZoomButton\r\n  const [lastDrawLocation, setLastDrawLocation] = React.useState(null)\r\n  const [crosshairValues, setCrosshairValues] = React.useState([])\r\n\r\n  useTargetClick(resetZoomButton, ()=>{\r\n    console.log('seted onclick')\r\n    setLastDrawLocation(null)\r\n  })\r\n\r\n  useEffect(() => {\r\n    if (lastDrawLocation) {\r\n      resetZoomButton.current.className = resetZoomButton.current.className.replace('d-none', 'd-block')\r\n    } else {\r\n      resetZoomButton.current.className = resetZoomButton.current.className.replace('d-block', 'd-none')\r\n    }\r\n  }, [lastDrawLocation])\r\n\r\n\r\n  const crosshairData = displayedTags.map( (tag) => {\r\n    return tag.values.map((value) => {\r\n      value.title = tag.tag_name\r\n      value.color = tag.curve_color\r\n      return value\r\n    })\r\n  });  \r\n\r\n  const _onMouseLeave = () => {\r\n    setCrosshairValues([]);\r\n  };\r\n\r\n  const _onNearestX = (value, {index}) => {\r\n    setCrosshairValues( crosshairData.map(d => d[index]) );\r\n  };\r\n\r\n  function format_time(time) {\r\n    const s = new Date(time)\r\n    let formatter = new Intl.DateTimeFormat([] , {dateStyle: 'long', timeStyle: 'medium'});\r\n    return formatter.format(s)\r\n  }\r\n\r\n  let has_displayed_tags = false\r\n  displayedTags.map( (tag) => {\r\n    if (tag.values.length > 0) {has_displayed_tags = true}\r\n  })\r\n\r\n  if (has_displayed_tags) {\r\n    return (\r\n      <React.Fragment>\r\n        <div className='graph-container  h-100' style={{overflow: 'hidden'}}>\r\n          <FlexibleXYPlot \r\n            margin={{left: 40, right: 0, top: 0, bottom: 30}} \r\n            xType=\"time\"\r\n            animation\r\n            xDomain={\r\n              lastDrawLocation && [\r\n                lastDrawLocation.left,\r\n                lastDrawLocation.right\r\n              ]\r\n            }\r\n            yDomain={\r\n              lastDrawLocation && [\r\n                lastDrawLocation.bottom,\r\n                lastDrawLocation.top\r\n              ]\r\n            } \r\n            yPadding={10}\r\n            onMouseLeave={_onMouseLeave}        \r\n          >\r\n            <HorizontalGridLines style={{stroke: '#444A50'}} />\r\n            <XAxis style={{line:{stroke: '#6c757d'}}} tickTotal={15} />\r\n            <YAxis style={{line:{stroke: '#6c757d'}}} />\r\n            { displayedTags.map((tag, index)=>{\r\n              if (index === 0) {\r\n                return <LineSeries onNearestX={_onNearestX} data={tag.values} color={tag.curve_color} key={tag.tag_id} />\r\n              }\r\n              else {\r\n                return <LineSeries data={tag.values} color={tag.curve_color} key={tag.tag_id} />\r\n              }\r\n            }) }\r\n\r\n            <Highlight\r\n              onBrushEnd={area => setLastDrawLocation(area)}\r\n              onDrag={area => {\r\n                setLastDrawLocation({\r\n                  lastDrawLocation: {\r\n                    bottom: lastDrawLocation.bottom + (area.top - area.bottom),\r\n                    left: lastDrawLocation.left - (area.right - area.left),\r\n                    right: lastDrawLocation.right - (area.right - area.left),\r\n                    top: lastDrawLocation.top + (area.top - area.bottom)\r\n                  }\r\n                });\r\n              }}\r\n            />\r\n\r\n            {crosshairValues[0] && \r\n              crosshairValues.map((point, index)=>{\r\n                return point ? (\r\n                          <MarkSeries\r\n                            key = {index}\r\n                            color = {point.color}\r\n                            size = '5'\r\n                            data={[point]}/>\r\n                        ) : null \r\n            })}\r\n\r\n            <Crosshair values={crosshairValues} style={{line:{backgroundColor:'red'}}}>  \r\n              {crosshairValues[0] && \r\n                <div className='rounded p-1 mx-2' style={{background: 'rgba(37, 37, 38, 1)'}}>\r\n                  <table className=\"table text-light p-0 m-0\">\r\n                    <thead> \r\n                    <tr>\r\n                        <td colSpan=\"3\" style={{fontSize: '1.2em', color: 'rgb(180, 180, 180)'}} \r\n                          className='border-0 font-weight-bold p-1 m-0 text-center text-nowrap'\r\n                        >\r\n                          {format_time(crosshairValues[0].x)}\r\n                        </td>\r\n                    </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                      { crosshairValues.map((point, index)=>{\r\n                        return point ? (\r\n                          <tr style={{fontSize: '1.1em', color: 'rgb(210, 210, 210)'}} key={index}>\r\n                            <td style={{color: point.color, paddingTop: '4px'}} className='text-nowrap border-0 px-1 pb-0 m-0\tfas fa-minus'></td>   \r\n                            <td className='text-nowrap border-0 pl-1 pr-2 py-0 m-0'> {point.title}: </td>   \r\n                            <td className='text-nowrap border-0 px-1 py-0 m-0 font-weight-bold  text-right'> {point.y} </td>\r\n                          </tr> \r\n                        ) : null\r\n                      })}\r\n                    </tbody>\r\n                  </table>\r\n                </div>\r\n              }\r\n            </Crosshair>\r\n          </FlexibleXYPlot>\r\n        </div>\r\n      </ React.Fragment>\r\n    );  \r\n  } else {\r\n    return (\r\n      <React.Fragment>\r\n      <div className='graph-container h-100'>\r\n        <FlexibleXYPlot \r\n          dontCheckIfEmpty\r\n          margin={{left: 30, right: 0, top: 0, bottom: 30}}      \r\n        >\r\n          <HorizontalGridLines style={{stroke: '#444A50'}} />\r\n          <XAxis />\r\n          <YAxis />\r\n          <LineSeries data={[{x:0, y:0}]} /> \r\n        </FlexibleXYPlot>\r\n      </div>\r\n      </ React.Fragment> \r\n    )                   \r\n  }\r\n}\r\n\r\n\r\nGraph.propTypes = {\r\n    tags: PropTypes.arrayOf(PropTypes.object).isRequired\r\n}\r\n\r\nexport default Graph","import React from 'react' \r\nimport SearchableDiscreteColorLegend from 'react-vis/dist/legends/searchable-discrete-color-legend';\r\n\r\n\r\n\r\n\r\nexport default function Legend(props) { \r\n  var [searchText, setSearchText] = React.useState('')\r\n\r\n  var state = {\r\n    onClick: props.onClick,\r\n    items: props.tags.map((tag) => {\r\n      return {title: tag.tag_name, color: tag.curve_color, tag_id:tag.tag_id, disabled:tag.disabled}\r\n    })\r\n  }\r\n\r\n  function _clickHandler (item) {\r\n    state.onClick(item.tag_id);    \r\n  };\r\n\r\n  function _searchChangeHandler (searchText) {\r\n    setSearchText(searchText)\r\n  };\r\n\r\n  return (\r\n    <div className='d-block text-dark pl-3'>\r\n      <SearchableDiscreteColorLegend\r\n        height={ parseInt(props.height.replace('px', '')) }\r\n        // width={300}\r\n        onSearchChange={_searchChangeHandler}\r\n        searchPlaceholder={'Поиск...'}\r\n        searchText={searchText}\r\n        onItemClick={_clickHandler}\r\n        items={state.items}\r\n      />\r\n    </div>\r\n  );\r\n}","import React, { useState } from 'react' \r\n\r\n\r\n\r\nexport default function Toolbar(props) { \r\n  const [showRangeForm, setShowRangeForm] = useState(false)\r\n  const [activeButton, setActiveButton] = useState([false, true, false, false, false, false, false, false])\r\n  const changeGraphInterval = props.changeGraphInterval\r\n\r\n  function toggleActiveButton(btn) {\r\n    // enable selected button and off all other\r\n    const b = activeButton.map( (item, index) => {\r\n      return (index === btn) ? true : false\r\n    })\r\n    setActiveButton(b)\r\n    // display form for range input \r\n    setShowRangeForm( (btn === 7) ? true : false ) \r\n  }\r\n\r\n  function getActiveCalss(btn) {\r\n    return activeButton[btn] ? ' active' : ''\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n    <div className='d-flex justify-content-left p-0 pt-2 m-0'>\r\n        <button type=\"button\" \r\n          className={'btn btn-sm btn-outline-secondary mx-1 ' + getActiveCalss(0)} \r\n          onClick={()=>{\r\n            toggleActiveButton(0)\r\n            changeGraphInterval('5m', 'all')\r\n          }}\r\n        >онлайн</button>\r\n\r\n        <button type=\"button\" \r\n          className={'btn btn-sm btn-outline-secondary mx-1 ' + getActiveCalss(1)} \r\n          onClick={()=>{\r\n            toggleActiveButton(1)\r\n            changeGraphInterval('1h', '1m')\r\n          }}\r\n        >1 час</button>\r\n\r\n        <button type=\"button\" \r\n          className={'btn btn-sm btn-outline-secondary mx-1 ' + getActiveCalss(2)} \r\n          onClick={()=>{\r\n            toggleActiveButton(2)\r\n            changeGraphInterval('6h', '5m')\r\n          }}\r\n        >6 часов</button>\r\n\r\n        <button type=\"button\" \r\n          className={'btn btn-sm btn-outline-secondary mx-1 ' + getActiveCalss(3)} \r\n          onClick={()=>{\r\n            toggleActiveButton(3)\r\n            changeGraphInterval('12h', '10m')\r\n          }}\r\n        >12 часов</button>\r\n\r\n        <button type=\"button\" \r\n          className={'btn btn-sm btn-outline-secondary mx-1 ' + getActiveCalss(4)} \r\n          onClick={()=>{\r\n            toggleActiveButton(4)\r\n            changeGraphInterval('1d', '30m')\r\n          }}\r\n        >сутки</button>\r\n\r\n        <button type=\"button\" \r\n          className={'btn btn-sm btn-outline-secondary mx-1 ' + getActiveCalss(5)} \r\n          onClick={()=>{\r\n            toggleActiveButton(5)\r\n            changeGraphInterval('7d', '2h')\r\n          }}\r\n        >неделя</button>\r\n\r\n        <button type=\"button\" \r\n          className={'btn btn-sm btn-outline-secondary mx-1 ' + getActiveCalss(6)} \r\n          onClick={()=>{\r\n            toggleActiveButton(6)\r\n            changeGraphInterval('30d', '12h')\r\n          }}\r\n        >месяц</button>\r\n\r\n        <button type=\"button\" \r\n          className={'btn btn-sm btn-outline-secondary mx-1 ' + getActiveCalss(7)} \r\n          onClick={()=>{\r\n            toggleActiveButton(7)\r\n            changeGraphInterval('30d', '12h') // todo\r\n          }}\r\n        >интервал</button> \r\n    </div>\r\n\r\n    {showRangeForm ? <RangeForm /> : null }\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n\r\nfunction RangeForm(props) {\r\n  return (\r\n    <React.Fragment>\r\n    <form className='pt-2'>\r\n      <div className=\"input-group input-group-sm \">\r\n        <div className=\"input-group-prepend \">\r\n          <span className=\"input-group-text bg-secondary text-light border-secondary ml-1\">C</span>\r\n        </div>\r\n        <input type=\"date\" className=\"form-control bg-dark text-light border-secondary\"></input>\r\n        <input type=\"time\" className=\"form-control bg-dark text-light border-secondary\"></input>\r\n\r\n        <div className=\"input-group-prepend \">\r\n          <span className=\"input-group-text bg-secondary text-light border-secondary ml-2\">По</span>\r\n        </div>\r\n        <input type=\"date\" className=\"form-control bg-dark text-light border-secondary\"></input>\r\n        <input type=\"time\" className=\"form-control bg-dark text-light border-secondary\"></input>\r\n\r\n        <button type=\"button\" className='btn btn-sm btn-secondary ml-2 mr-1'>показать</button> <br/>\r\n      </div>\r\n    </form>\r\n    </React.Fragment>\r\n  );\r\n}","import React from 'react'\r\nimport './Loader.css'\r\n\r\nexport default function Loader() {\r\n    return(\r\n        <div className=\"lds-ellipsis\"><div></div><div></div><div></div><div></div></div>\r\n    )\r\n}","import React from 'react';\r\nimport PropTypes from 'prop-types'\r\nimport Graph from './Graph'\r\nimport GraphWithCrosshair from './GraphWithCrosshair'\r\nimport Legend from './Legend'\r\nimport Toolbar from './Toolbar'\r\nimport Loader from '../../../base/components/Loader'\r\n\r\n\r\nfunction TagsHistoricalGraph(props) {\r\n  const [modal, setModal] = React.useState(false) // use it just for force update this component\r\n  const [crosshair, setCrosshair] = React.useState(false)\r\n  const graphCard = React.useRef(null)\r\n  const graphContainer = React.useRef(null)\r\n  const modalButton = React.useRef(null)\r\n  const crosshairButton = React.useRef(null)\r\n  const legendContainer = React.useRef(null)\r\n  const resetZoomButton = React.useRef(null)\r\n  const tags = props.tagsHistory  \r\n  const GRAPH_HEIGH = props.height ? props.height : '300px'\r\n\r\n  const toggleModal = () => {\r\n    const cl = ' full-screen-card'\r\n    if (graphCard.current.className.includes(cl)) {\r\n      graphCard.current.className = graphCard.current.className.replace(cl, '')\r\n      graphContainer.current.style.height = GRAPH_HEIGH\r\n      graphContainer.current.className = graphContainer.current.className.replace('col-10', 'col-8')\r\n      if (props.legend) {legendContainer.current.className = legendContainer.current.className.replace('col-2', 'col-4')}    \r\n      modalButton.current.className = modalButton.current.className.replace('fa-compress', 'fa-expand') \r\n      modalButton.current.className = modalButton.current.className.replace('text-primary', 'text-light')      \r\n      setModal(false)\r\n    } else {\r\n      graphCard.current.className += cl\r\n      graphContainer.current.style.height = 'calc(100vh - 150px)'\r\n      graphContainer.current.className = graphContainer.current.className.replace('col-8', 'col-10')\r\n      if (props.legend) {legendContainer.current.className = legendContainer.current.className.replace('col-4', 'col-2')}\r\n      modalButton.current.className = modalButton.current.className.replace('fa-expand', 'fa-compress') \r\n      modalButton.current.className = modalButton.current.className.replace('text-light', 'text-primary')       \r\n      setModal(true)\r\n    }\r\n  }\r\n\r\n  const toggleCroshair = () => {\r\n    if (crosshair) {\r\n      setCrosshair(!crosshair)\r\n      crosshairButton.current.className = crosshairButton.current.className.replace('text-primary', 'text-light')      \r\n    } else {\r\n      setCrosshair(!crosshair)\r\n      crosshairButton.current.className = crosshairButton.current.className.replace('text-light', 'text-primary') \r\n    }\r\n  }\r\n\r\n  return (   \r\n    <React.Fragment>\r\n    <div ref={graphCard} className='card shadow-sm py-2 bg-dark text-light h-100'>\r\n      <div className='d-flex mb-1'>\r\n        <h5 className=\"px-3 pt-1 pb-2 m-0\">{props.title}</h5>\r\n        <span className='ml-auto'></span>\r\n\r\n        <button type=\"button\" \r\n          ref={resetZoomButton} \r\n          className={'btn btn-link text-primary m-0 p-0 mt-1 mr-2 fas fa-search-minus d-none'} \r\n          style={{width: '28px', height: '28px', fontSize:'1em', textDecoration: 'none', outline: 'none', boxShadow: 'none'}} \r\n          onClick={null}\r\n        ></button>\r\n\r\n        <button type=\"button\"\r\n          ref={crosshairButton} \r\n          className={'btn btn-link text-light m-0 p-0 mt-1 mr-2 fas fa-ruler-vertical'} \r\n          style={{width: '28px', height: '28px', fontSize:'1em', textDecoration: 'none', outline: 'none', boxShadow: 'none'}}\r\n          onClick={toggleCroshair}\r\n        ></button> \r\n\r\n        <button type=\"button\" \r\n          ref={modalButton} \r\n          className={'btn btn-link text-light m-0 p-0 mt-1 mr-2 fas fa-expand'} \r\n          style={{width: '28px', height: '28px', fontSize:'1em', textDecoration: 'none', outline: 'none', boxShadow: 'none'}} \r\n          onClick={toggleModal}\r\n        ></button>  \r\n      </div>\r\n\r\n      { props.loading ? \r\n        <div className='d-flex justify-content-center'><Loader /></div> :\r\n          <div className=\"row m-0 px-3 py-0\">\r\n            <div ref={graphContainer} className={`${ props.legend ? 'col-8' : 'col-12'} m-0 p-0`} style={{height: GRAPH_HEIGH}}>\r\n              { crosshair ? \r\n                <GraphWithCrosshair tags={tags} resetZoomButton={resetZoomButton} /> : \r\n                <Graph tags={tags} resetZoomButton={resetZoomButton} /> \r\n              }\r\n            </div>\r\n\r\n            { props.legend && (\r\n              <div ref={legendContainer} className=\"col-4 m-0 p-0\">\r\n                <Legend tags={tags} onClick={props.toggleCurveDisplay} height={GRAPH_HEIGH}/>\r\n              </div>\r\n            )}\r\n\r\n            { props.toolbar && (\r\n              <div className=\"col-12 align-self-start m-0 p-0\">\r\n                <Toolbar toggleModal={toggleModal} toggleCroshair={toggleCroshair} changeGraphInterval={props.changeGraphInterval}/>\r\n              </div>\r\n            )}\r\n        </div>\r\n      }\r\n    </div>\r\n    </ React.Fragment>\r\n  );\r\n}\r\n\r\n\r\nTagsHistoricalGraph.propTypes = {\r\n    tagsHistory: PropTypes.arrayOf(PropTypes.object).isRequired\r\n}\r\n\r\nexport default TagsHistoricalGraph","// const colors = [\r\n//     '#19CDD7', '#DDB27C', '#88572C', \r\n//     '#FF991F', '#F15C17', '#223F9A', \r\n//     '#DA70BF', '#125C77', '#4DC19C', \r\n//     '#776E57', '#12939A', '#17B8BE', \r\n//     '#F6D18A', '#B7885E', '#FFCB99', \r\n//     '#F89570', '#829AE3', '#E79FD5', \r\n//     '#1E96BE', '#89DAC1', '#B3AD9E'\r\n// ]\r\n\r\nconst colors = [\r\n    '#f44336', '#00BCD4', '#FF9800', \r\n    '#E91E63', '#009688', '#FF5722', \r\n    '#9C27B0', '#4CAF50', '#795548', \r\n    '#673AB7', '#8BC34A', '#607D8B', \r\n    '#3F51B5', '#CDDC39', \r\n    '#2196F3', '#FFEB3B', \r\n    '#03A9F4', '#FFC107', \r\n]\r\n\r\n\r\nexport default function getColor(index) {\r\n    const clorsNumber = colors.length\r\n    var ind\r\n    if (index+1 > clorsNumber) {\r\n        ind = index % clorsNumber\r\n    }\r\n    else {\r\n        ind = index\r\n    }\r\n    return colors[ind]\r\n}","import React, { useEffect } from 'react' \r\n\r\nimport TagsHistoricalGraph from './components/TagsGraph/TagsHistoricalGraph'\r\nimport getColor from './components/TagsGraph/GraphColors'\r\nimport axiosInstance from \"../backendAPI/axiosApi\";\r\nimport getBaseUrl from '../backendAPI/localSettings'\r\nconst BASE_URL = getBaseUrl()\r\n\r\n\r\n\r\nexport default function WidgetGraph(props) {\r\n  const [loading, setLoading] = React.useState(true)\r\n  const [graphInterval, setGraphInterval] = React.useState({interval:'1h', resolution:'1m', tags: props.widget.tags})\r\n  const [tagsHistory, setTagsHistory] = React.useState([])\r\n  const device_id = props.device_id;\r\n\r\n  function updateTagsHistory(tags) {\r\n    const prepared_tags = tags.map( (tag, index) => {\r\n      return ({\r\n        tag_id: tag.tag_id,\r\n        tag_code: tag.tag_code,\r\n        tag_name: tag.tag_name,\r\n        disabled: false,\r\n        curve_color : getColor(index),\r\n        values: tag.values.map( (value) => {\r\n          return {x: new Date(value.add_date), y: value.value}\r\n        })\r\n      })\r\n    })  \r\n    setTagsHistory( (prev) => {\r\n      return prepared_tags.map( (tag)=> {\r\n        const fltr = prev.filter( entry=>entry.tag_id === tag.tag_id )\r\n        var disabled = (fltr.length > 0) ? fltr[0].disabled : tag.disabled\r\n        return {...tag, disabled: disabled}\r\n      })\r\n    }) \r\n  }\r\n\r\n  // read tags historical data\r\n  function readTagsHistory() {\r\n    axiosInstance.get(BASE_URL + \"/device/tags/history/\", { params: { id: device_id, ...graphInterval}} )\r\n    .then(responce => {\r\n      responce && updateTagsHistory(responce.data)\r\n    })  \r\n  }\r\n  \r\n  // read parameters\r\n  useEffect(() => {\r\n    readTagsHistory();\r\n    const loadingTimeout = setTimeout( () => { setLoading(false) }, 1000);\r\n    const graphUpdateInterval = setInterval( readTagsHistory, getGraphUpdateTimeout(graphInterval.interval))\r\n    return () => {\r\n      clearTimeout(loadingTimeout);\r\n      clearInterval(graphUpdateInterval);\r\n    };\r\n  }, [graphInterval])\r\n\r\n  \r\n  function changeGraphInterval(interval, resolution){\r\n    setGraphInterval( (prev) => {\r\n      return {...prev, interval: interval, resolution: resolution}\r\n    })\r\n  }\r\n\r\n  function getGraphUpdateTimeout(interval){\r\n    if (interval === '5m') {\r\n      return 2000                       // 2s\r\n    } else if (interval === '1h') {\r\n      return 30000                      // 30s\r\n    } else if (interval === '6h') {\r\n      return 60000 * 2                  // 2m\r\n    } else if (interval === '12h') {\r\n      return 60000 * 5                  // 5m\r\n    } else if (interval === '1d') {\r\n      return 60000 * 15                 // 15m\r\n    } else if (interval === '7d') {\r\n      return 60000 * 60                 // 1h\r\n    } else if (interval === '30d') {\r\n      return 60000 * 60 * 6             // 6h\r\n    } else {\r\n      return 60000 * 5                  // 5m\r\n    }\r\n  }\r\n\r\n  // toggle curve display\r\n  function toggleCurveDisplay(tag_id){\r\n    const n = tagsHistory.map( entry => { \r\n      if (entry.tag_id===tag_id) { entry.disabled = !entry.disabled } \r\n      return entry\r\n    })\r\n    setTagsHistory(n)\r\n  }\r\n\r\n  // render the widget\r\n  return (\r\n    <React.Fragment>\r\n        <TagsHistoricalGraph \r\n            tagsHistory={tagsHistory} \r\n            toggleCurveDisplay={toggleCurveDisplay}\r\n            title={props.widget.title}\r\n            legend={props.widget.legend}\r\n            loading={loading}\r\n            toolbar={props.widget.toolbar}\r\n            height={props.widget.height}\r\n            changeGraphInterval={changeGraphInterval}\r\n        /> \r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\n\r\nfunction TagsCurrentValueRow({tag, columns, index}) {\r\n    return (\r\n        <tr>\r\n            { (columns.indexOf('#No') >= 0) ? <td className='border-secondary text-secondary pl-2'> {index + 1} </td> : null }  \r\n            { (columns.indexOf('code') >= 0) ? <td className='border-secondary'> {tag.code} </td> : null }\r\n            { (columns.indexOf('name') >= 0) ? <td className='border-secondary'> {tag.name} </td> : null }\r\n            { (columns.indexOf('value') >= 0) ? <td className='border-secondary'> {tag.value} </td> : null }\r\n        </tr>\r\n    )\r\n}\r\n\r\n\r\n\r\nTagsCurrentValueRow.propTypes = {\r\n    tag: PropTypes.object.isRequired,\r\n    index: PropTypes.number.isRequired,\r\n}\r\n\r\nexport default TagsCurrentValueRow","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport TagsCurrentValueRow from './TagsCurrentValueRow'\r\nimport Loader from '../../../base/components/Loader'\r\n\r\n\r\nfunction TagsCurrentValueList(props) {\r\n  const [modal, setModal] = React.useState(false) // use it just for force update this component\r\n  const modalButton = React.useRef(null)\r\n  const graphCard = React.useRef(null)\r\n\r\n  const toggleModal = () => {\r\n    const cl = ' full-screen-card'\r\n    if (graphCard.current.className.includes(cl)) {\r\n      graphCard.current.className = graphCard.current.className.replace(cl, '')\r\n      modalButton.current.className = modalButton.current.className.replace('fa-compress', 'fa-expand') \r\n      modalButton.current.className = modalButton.current.className.replace('text-primary', 'text-light')      \r\n      setModal(false)\r\n    } else {\r\n      graphCard.current.className += cl\r\n      modalButton.current.className = modalButton.current.className.replace('fa-expand', 'fa-compress') \r\n      modalButton.current.className = modalButton.current.className.replace('text-light', 'text-primary')       \r\n      setModal(true)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div ref={graphCard} className='card shadow-sm py-2 bg-dark text-light h-100'>\r\n      <div className='d-flex mb-1'>\r\n        <h5 className=\"px-3 pt-1 pb-0 m-0\">{props.title}</h5>\r\n        <span className='ml-auto'></span>\r\n\r\n        <button type=\"button\" \r\n          ref={modalButton} \r\n          className={'btn btn-link text-light m-0 p-0 mt-1 mr-2 fas fa-expand'} \r\n          style={{width: '28px', height: '28px', fontSize:'1em', textDecoration: 'none', outline: 'none', boxShadow: 'none'}} \r\n          onClick={toggleModal}\r\n        ></button>  \r\n      </div>\r\n  \r\n      { props.loading ? \r\n        <div className='d-flex justify-content-center'><Loader /></div> \r\n        :\r\n        <>\r\n        { props.columns ?    \r\n        <div className=\"table-responsive px-3\">\r\n          <table className=\"table table-hover table-dark table-sm text-light w-100 mb-0\">\r\n            <thead> \r\n              <tr>\r\n                { (props.columns.indexOf('#No') >= 0) ? <th className='border-0 text-secondary font-weight-bold pl-2'>№</th> : null }\r\n                { (props.columns.indexOf('code') >= 0) ? <th className='border-0 text-secondary font-weight-bold'>Код параметра</th> : null }\r\n                { (props.columns.indexOf('name') >= 0) ? <th className='border-0 text-secondary font-weight-bold'>Наименование параметра</th> : null }\r\n                { (props.columns.indexOf('value') >= 0) ? <th className='border-0 text-secondary font-weight-bold'>Текущее значение</th> : null }\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n                { props.tags.map((tag, index) => {\r\n                  return (\r\n                    <TagsCurrentValueRow tag={tag} columns={props.columns} key={tag.code} index={index} />\r\n                  )\r\n                }) }\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n        :\r\n          <i className='text-secondary ml-3'>Данные для отображения не заданы ... </i>\r\n        } \r\n        </>\r\n      }\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\nTagsCurrentValueList.propTypes = {\r\n    tags: PropTypes.arrayOf(PropTypes.object).isRequired\r\n}\r\n\r\nexport default TagsCurrentValueList","import React, { useEffect } from 'react' \r\n\r\nimport TagsCurrentValueList from './components/TagsList/TagsCurrentValueList'\r\nimport axiosInstance from \"../backendAPI/axiosApi\";\r\nimport getBaseUrl from '../backendAPI/localSettings'\r\nconst BASE_URL = getBaseUrl()\r\n\r\n\r\n\r\nexport default function WidgetTable(props) {\r\n  const [tags, setTags] = React.useState([])\r\n  const [loading, setLoading] = React.useState(true)\r\n  const device_id = props.device_id;\r\n  const displayedTags =  props.widget.tags;\r\n\r\n  function readDeviceTags() {\r\n    axiosInstance.get(BASE_URL + \"/device/tags/value/\", { params: { id: device_id, tags: displayedTags }} )\r\n    .then((responce) => {\r\n      responce && setTags(responce.data)     \r\n    })  \r\n  }\r\n  \r\n  // read parameters\r\n  useEffect(() => {\r\n    readDeviceTags();\r\n    const loadingTimeout = setTimeout( () => { setLoading(false) }, 1000);\r\n    const tagsUpdateInterval = setInterval(readDeviceTags, 2000);\r\n    return () => {\r\n      clearTimeout(loadingTimeout);      \r\n      clearInterval(tagsUpdateInterval);\r\n    };\r\n  }, [])\r\n\r\n  // render the page\r\n  return (\r\n    <React.Fragment>\r\n        <TagsCurrentValueList\r\n          tags={tags} \r\n          title={props.widget.title} \r\n          columns={props.widget.columns} \r\n          loading={loading} \r\n        />\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n","import React from 'react'\r\nimport Loader from '../../../base/components/Loader'\r\n\r\n\r\nexport default function TagIndicator(props) {\r\n  const tag = props.tag\r\n  const addTextRight = props.addTextRight\r\n  const addTextLeft = props.addTextLeft\r\n\r\n  var value = 'none'\r\n  if (tag) {\r\n    value = props.precision ? tag.value.toFixed(props.precision) : tag.value\r\n  }\r\n\r\n  return (\r\n    <div className='card shadow-sm py-2 bg-dark text-light h-100'>\r\n      <div className='d-flex mb-1'>\r\n        <h5 className=\"px-3 pt-1 pb-0 m-0\">{props.title}</h5>\r\n        <span className='ml-auto'></span>  \r\n      </div>\r\n  \r\n      { props.loading ? \r\n        <div className='d-flex justify-content-center'><Loader /></div> :     \r\n        <div className=\"d-flex justify-content-center align-items-end h-100 px-3\">\r\n          {tag ? \r\n            <p className='display-4 m-0 p-0'>\r\n              <span>{addTextLeft} </span> \r\n              {value} \r\n              <span> {addTextRight}</span>\r\n            </p> :\r\n            <p className='display-4 text-secondary m-0 p-0'>Нет данных</p> \r\n          }\r\n        </div>\r\n      }\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\n\r\n","import React, { useEffect } from 'react' \r\n\r\nimport TagIndicator from './components/TagsIndicator/TagIndicator'\r\nimport axiosInstance from \"../backendAPI/axiosApi\"\r\nimport getBaseUrl from '../backendAPI/localSettings'\r\nconst BASE_URL = getBaseUrl()\r\n\r\n\r\n\r\nexport default function WidgetIndicator(props) {\r\n  const [tags, setTags] = React.useState([])\r\n  const [loading, setLoading] = React.useState(true)\r\n  const device_id = props.device_id\r\n  const displayedTags =  props.widget.tags  \r\n  const tag = tags[0] // TODO: widget display just 1 tag now\r\n\r\n  function readDeviceTags() {\r\n    axiosInstance.get(BASE_URL + \"/device/tags/value/\",  { params: { id: device_id, tags: displayedTags }} )\r\n    .then((responce) => {\r\n      responce && setTags(responce.data)\r\n    })  \r\n  }\r\n\r\n\r\n\r\n  useEffect(() => {\r\n    readDeviceTags();\r\n    const loadingTimeout = setTimeout( () => { setLoading(false) }, 1000);\r\n    const tagsUpdateInterval = setInterval(readDeviceTags, 2000);\r\n    return () => {\r\n      clearTimeout(loadingTimeout);      \r\n      clearInterval(tagsUpdateInterval);\r\n    };\r\n  }, [])\r\n\r\n\r\n  return (\r\n    <React.Fragment>\r\n        <TagIndicator\r\n          tag={tag} \r\n          title={props.widget.title}\r\n          precision={props.widget.precision}\r\n          addTextRight={props.widget.addTextRight}\r\n          addTextLeft={props.widget.addTextLeft}\r\n          loading={loading} \r\n        />\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\n\r\nexport default function TagsCurrentValueRow({record, index}) {\r\n    return (\r\n        <tr>\r\n            <td className='border-secondary text-secondary pl-2 d-none d-lg-table-cell' style={{width:'5%'}}> {index + 1} </td>   \r\n            <td className='border-secondary d-none d-xl-table-cell' style={{width:'15%'}}> {format_date(record.date)} </td> \r\n            <td className='border-secondary d-table-cell d-xl-none' style={{width:'15%'}}> {format_date(record.date, 'short')} </td> \r\n            <td className='border-secondary' style={{width:'10%'}}> {format_time(record.date)} </td>\r\n            <td className='border-secondary'> {record.message} </td>\r\n        </tr>\r\n    )\r\n}\r\n\r\n\r\n\r\nfunction format_time(time, style='medium') {\r\n    const s = new Date(time)\r\n    let formatter = new Intl.DateTimeFormat([] , {timeStyle: style});\r\n    return formatter.format(s)\r\n  }\r\n\r\nfunction format_date(time, style='long') {\r\n    const s = new Date(time)\r\n    let formatter = new Intl.DateTimeFormat([] , {dateStyle: style});\r\n    return formatter.format(s)\r\n  }\r\n\r\n","import React from 'react'\r\nimport RecordsRow from './RecordsRow'\r\nimport Loader from '../../../base/components/Loader'\r\n\r\n\r\nexport default function TagsCurrentValueList(props) {\r\n  const [modal, setModal] = React.useState(false) // use it just for force update this component\r\n  const modalButton = React.useRef(null)\r\n  const graphCard = React.useRef(null)\r\n  const toggleCategorySelection = props.toggleCategorySelection\r\n  const categories = props.categories\r\n\r\n  const toggleModal = () => {\r\n    const cl = ' full-screen-card'\r\n    if (graphCard.current.className.includes(cl)) {\r\n      graphCard.current.className = graphCard.current.className.replace(cl, '')\r\n      modalButton.current.className = modalButton.current.className.replace('fa-compress', 'fa-expand') \r\n      modalButton.current.className = modalButton.current.className.replace('text-primary', 'text-light')      \r\n      setModal(false)\r\n    } else {\r\n      graphCard.current.className += cl\r\n      modalButton.current.className = modalButton.current.className.replace('fa-expand', 'fa-compress') \r\n      modalButton.current.className = modalButton.current.className.replace('text-light', 'text-primary')       \r\n      setModal(true)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div ref={graphCard} className='card shadow-sm py-2 bg-dark text-light h-100'>\r\n      <div className='d-flex mb-1'>\r\n        <h5 className=\"px-3 pt-1 pb-0 m-0\">{props.title}</h5>\r\n        <span className='ml-auto'></span>\r\n\r\n        { props.category_selection_panel && <CategorySelectionPanel toggleCategorySelection={toggleCategorySelection} categories={categories}/> }\r\n\r\n        <button type=\"button\" \r\n          ref={modalButton} \r\n          className={'btn btn-link text-light m-0 p-0 mt-1 mr-2 fas fa-expand'} \r\n          style={{width: '28px', height: '28px', fontSize:'1em', textDecoration: 'none', outline: 'none', boxShadow: 'none'}} \r\n          onClick={toggleModal}\r\n        ></button>  \r\n      </div>\r\n  \r\n      { props.loading ? \r\n        <div className='d-flex justify-content-center'><Loader /></div> \r\n        :\r\n        <>\r\n          { props.records.length > 0 ? <RecordsTable records={props.records}/> : <NoRecords /> }\r\n          <PaginationBar readNextPage={props.readNextPage} readPreviousPage={props.readPreviousPage} changePage={props.changePage} pagination={props.pagination} />\r\n        </>\r\n      }\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\nfunction RecordsTable(props) {\r\n  return (\r\n    <div className=\"table-responsive px-3\">\r\n      <table className=\"table table-hover table-dark table-sm text-light w-100 mb-0\">\r\n        <thead> \r\n          <tr>\r\n            <th className='border-0 text-secondary font-weight-bold pl-2 d-none d-lg-table-cell' style={{width:'5%'}}>№</th>\r\n            <th className='border-0 text-secondary font-weight-bold' style={{width:'15%'}}>Дата</th>\r\n            <th className='border-0 text-secondary font-weight-bold' style={{width:'10%'}}>Время</th>\r\n            <th className='border-0 text-secondary font-weight-bold'>Событие</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n            { props.records.map((record, index) => {\r\n              return (\r\n                <RecordsRow record={record} key={index} index={index} />\r\n              )\r\n            }) }\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\nfunction NoRecords() {\r\n  return <i className='text-secondary ml-3'>Записи отсутствуют ...</i>\r\n}\r\n\r\n\r\nfunction CategorySelectionPanel(props) {\r\n  const toggleCategorySelection = props.toggleCategorySelection\r\n  const categories = props.categories\r\n  return(\r\n    <>\r\n      <div className='d-inline mr-3'>\r\n        {categories.map( (category, index)=>{\r\n          return <CategorySecetionButton key={index} selected={category.selected} onClick={()=>{toggleCategorySelection(index)}}>{category.name}</CategorySecetionButton>\r\n        } )}\r\n      </div>\r\n    </>\r\n  )\r\n}\r\n\r\n\r\nfunction CategorySecetionButton(props) {\r\n  return (\r\n    <button \r\n      type=\"button\" \r\n      className='btn btn-link text-light ml-3 p-0 mt-1' \r\n      style={{boxShadow: 'none'}}\r\n      onClick={props.onClick}\r\n    >\r\n      { props.selected ? <i className='fas fa-check-square text-success mr-2'></i> : <i className='far fa-square text-info mr-2'></i> }\r\n      { props.children }\r\n    </button>    \r\n  )\r\n}\r\n\r\n\r\n\r\nfunction PaginationBar(props) {\r\n  const list = Array.apply(null, Array(props.pagination.num_pages))\r\n\r\n  if (props.pagination.num_pages <= 1) {\r\n    return null\r\n  }\r\n\r\n  return (\r\n    <div className='d-flex justify-content-center p-3'>\r\n      <button type='button' className='btn btn-sm btn-outline-info m-1' onClick={props.readPreviousPage} > {'<<'} </button>\r\n      { list.map((item, index)=>{\r\n          const active = (index+1 === props.pagination.page_number) ? ' active' : ''\r\n          return(\r\n            <button type='button' key={index}\r\n              className={'btn btn-sm btn-outline-info m-1' + active} \r\n              style={{minWidth:'35px'}}\r\n              onClick={()=>{props.changePage(index+1)}}\r\n            >\r\n              {index+1}\r\n            </button>\r\n          )\r\n        })\r\n      }\r\n      <button type='button' className='btn btn-sm btn-outline-info m-1' onClick={props.readNextPage} > {'>>'} </button>\r\n    </div>\r\n  )\r\n}","import React, { useEffect } from 'react' \r\n\r\nimport RecordsList from './components/EventsLog/RecordsList'\r\nimport axiosInstance from \"../backendAPI/axiosApi\";\r\nimport getBaseUrl from '../backendAPI/localSettings'\r\nconst BASE_URL = getBaseUrl()\r\n\r\n\r\n\r\nexport default function WidgetEventsLog(props) {\r\n  const [records, setRecords] = React.useState([])\r\n  const [loading, setLoading] = React.useState(true)\r\n  const [categories, setCategories] = React.useState( [\r\n    {name: 'Аварийные',       code: 'Alarm',   selected: true},\r\n    {name: 'Предупреждения',  code: 'Warning',  selected: true},\r\n    {name: 'Информационные',  code: 'Info',     selected: true},\r\n    {name: 'Отладочные',      code: 'Debug',    selected: false}\r\n  ])\r\n  const device_id = props.device_id;\r\n  const [pagination, setPagination] = React.useState({next: null, previous: null})\r\n  const [page, setPage] = React.useState(1)\r\n\r\n  const toggleCategorySelection = (toggle_index) => {\r\n    setCategories( categories.map( (category, index)=> {\r\n      if (toggle_index === index) {\r\n        return {...category, selected: !category.selected}\r\n      } else { return category }\r\n    }))\r\n  }\r\n\r\n  function readLogRecords(url, props={}){\r\n    axiosInstance.get(url, props)\r\n    .then((responce) => {\r\n      responce && setRecords(responce.data.results)\r\n      responce && setPagination({\r\n        next: responce.data.next, \r\n        previous: responce.data.previous, \r\n        num_pages: responce.data.num_pages, \r\n        page_number: responce.data.page_number, \r\n      })\r\n    }) \r\n  }\r\n\r\n  function readLogPage(page) {\r\n    const selected_categories = categories.filter( category => category.selected )\r\n    const selected_category_codes = selected_categories.map( category => category.code )\r\n    readLogRecords(BASE_URL + \"/events/log/\", { params: { id: device_id, categories: selected_category_codes, page:page }} ) \r\n  }\r\n  function readNextPage() {\r\n    pagination.next && setPage(page+1)\r\n  }\r\n  function readPreviousPage() {\r\n    pagination.previous && setPage(page-1)\r\n  }\r\n  function changePage(page) {\r\n    setPage(page)\r\n  }  \r\n  function updateFirstPage(page) {\r\n    if (page===1) {readLogPage(1)}\r\n  }\r\n\r\n\r\n  // read parameters\r\n  useEffect(() => {\r\n    readLogPage(page)\r\n    const loadingTimeout = setTimeout( () => { setLoading(false) }, 500);\r\n    const tagsUpdateInterval = setInterval(()=>updateFirstPage(page), 10000)\r\n    return () => {\r\n      clearTimeout(loadingTimeout);      \r\n      clearInterval(tagsUpdateInterval);\r\n    };\r\n  }, [categories, page, ])\r\n\r\n\r\n  // render the page\r\n  return (\r\n    <React.Fragment>\r\n        <RecordsList\r\n          records={records} \r\n          title={props.widget.title} \r\n          categories={categories}\r\n          category_selection_panel={props.widget.category_selection_panel} \r\n          toggleCategorySelection={toggleCategorySelection}\r\n          readNextPage={readNextPage}\r\n          readPreviousPage={readPreviousPage}\r\n          changePage={changePage}\r\n          pagination={pagination}\r\n          loading={loading} \r\n        />\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n","import React from 'react' \r\n\r\nimport WidgetGraph from './WidgetGraph'\r\nimport WidgetTable from './WidgetTable'\r\nimport WidgetIndicator from './WidgetIndicator' \r\nimport WidgetEventsLog from './WidgetEventsLog' \r\n\r\n\r\n\r\nexport default function RenderWidgets(props) {\r\n  const widgetsTemplate = props.widgetsTemplate\r\n  const device_id = props.device_id\r\n  if (!props.widgetsTemplate) {return null}\r\n  if (!props.widgetsTemplate.widgets) {return null}\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='container-fluid row equal p-0 m-0'>\r\n      {\r\n        widgetsTemplate.widgets.map((widget, index)=>{\r\n          return <WidgetRender widget={widget} device_id={device_id} key={index} />\r\n        })\r\n      }\r\n      </div>\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\n\r\nfunction WidgetRender(props) {\r\n  const widget = props.widget\r\n  const device_id = props.device_id\r\n\r\n  if (widget.type === 'table') {\r\n    return (\r\n      <div className={`col-xl-${widget.width * 3} col-lg-${Math.min(widget.width * 6, 12)} col-md-12 p-1 m-0`}>\r\n        <WidgetTable device_id={device_id} widget={widget}/>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (widget.type === 'graph') {\r\n    return (\r\n      <div className={`col-xl-${widget.width * 3} col-lg-${Math.min(widget.width * 6, 12)} col-md-12 p-1 m-0`}>\r\n        <WidgetGraph device_id={device_id} widget={widget}/>\r\n      </div>\r\n    )    \r\n  }   \r\n\r\n  if (widget.type === 'indicator') {\r\n    return (\r\n      <div className={`col-xl-${widget.width * 3} col-lg-${Math.min(widget.width * 6, 12)} col-md-12 p-1 m-0`}>\r\n        <WidgetIndicator device_id={device_id} widget={widget}/>\r\n      </div>\r\n    )    \r\n  }    \r\n\r\n  if (widget.type === 'eventslog') {\r\n    return (\r\n      <div className={`col-xl-${widget.width * 3} col-lg-${Math.min(widget.width * 6, 12)} col-md-12 p-1 m-0`}>\r\n        <WidgetEventsLog device_id={device_id} widget={widget}/>\r\n      </div>\r\n    )    \r\n  }    \r\n}\r\n","import React from 'react' \r\nimport {useParams} from 'react-router-dom'\r\n\r\nimport DeviceHeader from '../components/DeviceHeader'\r\nimport RenderWidgets from '../../Widgets/renderWidgets'\r\n\r\n\r\n\r\nexport default function DeviceOverviewPage(props) {\r\n  const { device_id } = useParams();\r\n  const widgetsTemplate = props.widgetsTemplate;\r\n  \r\n  // render the page\r\n  return (\r\n    <React.Fragment>\r\n      <DeviceHeader device_id={device_id}/>\r\n      <RenderWidgets widgetsTemplate={widgetsTemplate} device_id={device_id}/>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n","import React from 'react' \r\nimport {useParams} from 'react-router-dom'\r\n\r\n\r\nexport default function DeviceSettingsPage() {\r\n  const { device_id } = useParams();\r\n\r\n  return (\r\n    <React.Fragment>\r\n        <h3>Настройки устройства</h3>\r\n        <p>Раздел находиться в разработке ... </p>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n ","import React from 'react' \r\nimport {useParams} from 'react-router-dom'\r\n\r\nimport DeviceHeader from '../components/DeviceHeader'\r\nimport RenderWidgets from '../../Widgets/renderWidgets'\r\n\r\n\r\n\r\nconst WidgetsTemplate = {\r\n  widgets:[   \r\n    {\r\n      type: 'eventslog',\r\n      width: 4,\r\n      title: 'Журнал событий',\r\n      category_selection_panel: true\r\n    }      \r\n  ]\r\n}\r\n\r\n\r\n\r\nexport default function DeviceEventsLogPage(props) {\r\n  const { device_id } = useParams();\r\n  \r\n  // render the page\r\n  return (\r\n    <React.Fragment>\r\n      <DeviceHeader device_id={device_id}/>\r\n      <RenderWidgets widgetsTemplate={WidgetsTemplate} device_id={device_id}/>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n ","import React from 'react' \r\nimport {useParams} from 'react-router-dom'\r\n\r\nimport DeviceHeader from '../components/DeviceHeader'\r\nimport RenderWidgets from '../../Widgets/renderWidgets'\r\n\r\n\r\n\r\nconst WidgetsTemplate = {\r\n  widgets:[   \r\n    {\r\n      type: 'graph',\r\n      width: 4,\r\n      height: 'calc(65vh)',\r\n      title: 'История',\r\n      tags: null,\r\n      legend: true,\r\n      toolbar: true,\r\n    }      \r\n  ]\r\n}\r\n\r\n\r\n\r\nexport default function DeviceOverviewPage(props) {\r\n  const { device_id } = useParams();\r\n  \r\n  // render the page\r\n  return (\r\n    <React.Fragment>\r\n      <DeviceHeader device_id={device_id}/>\r\n      <RenderWidgets widgetsTemplate={WidgetsTemplate} device_id={device_id}/>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n","import axiosInstance from \"./axiosApi\";\r\nimport getBaseUrl from './localSettings'\r\n\r\n\r\n// ---------------------------------------------------------------------------------\r\n// access to device configuration parameters\r\nexport function getDeviceParameters(device_id, cb_success) {\r\n  const params = { id: device_id }\r\n  const endpoint = \"/device/parameters/\"\r\n  backendApiRequest(GET, endpoint, null, params, cb_success ) \r\n}\r\nexport function postDeviceParameters(device_id, device_parameters, cb_success, cb_error) {\r\n  const params = { id: device_id }\r\n  const body = {...device_parameters} \r\n  const endpoint = \"/device/parameters/\"\r\n  backendApiRequest(POST, endpoint, body, params, cb_success, cb_error ) \r\n}\r\n\r\n// access to device modbus parameters\r\nexport function getDeviceModbusParameters(device_id, cb_success) {\r\n  const params = { id: device_id }\r\n  const endpoint = \"/device/modbus/parameters/\"\r\n  backendApiRequest(GET, endpoint, null, params, cb_success ) \r\n}\r\nexport function postDeviceModbusParameters(device_id, device_parameters, cb_success, cb_error) {\r\n  const params = { id: device_id }\r\n  const body = {...device_parameters}\r\n  const endpoint = \"/device/modbus/parameters/\"\r\n  backendApiRequest(POST, endpoint, body, params, cb_success, cb_error )  \r\n}\r\n\r\n// access to device tags parameters\r\nexport function getDeviceTagsParameters(device_id, tags_list, cb_success) {\r\n  const params = { id: device_id, tags: tags_list }\r\n  const endpoint = \"/device/tags/parameters/\"\r\n  backendApiRequest(GET, endpoint, null, params, cb_success )\r\n}\r\nexport function postDeviceTagsParameters(device_id, tags_parameters, cb_success, cb_error) {\r\n  const params = { id: device_id }\r\n  const body = tags_parameters\r\n  const endpoint = \"/device/tags/parameters/\"\r\n  backendApiRequest(POST, endpoint, body, params, cb_success, cb_error )\r\n}\r\nexport function deleteDeviceTags(device_id, tags_list, cb_success) {\r\n  const params = { id: device_id, tags: tags_list }\r\n  const endpoint = \"/device/tags/parameters/\"\r\n  backendApiRequest(DELETE, endpoint, null, params, cb_success )\r\n}\r\n\r\n\r\n// ---------------------------------------------------------------------------------\r\n// access to events parameters\r\nexport function getEventsConfig(device_id, events_list, cb_success) {\r\n  const params = { id: device_id, events_id: events_list }\r\n  const endpoint = \"/events/config/\"\r\n  backendApiRequest(GET, endpoint, null, params, cb_success )\r\n}\r\nexport function postEventsConfig(device_id, events_parameters, cb_success, cb_error) {\r\n  const params = { id: device_id }\r\n  const body = events_parameters\r\n  const endpoint = \"/events/config/\"\r\n  backendApiRequest(POST, endpoint, body, params, cb_success, cb_error )\r\n}\r\nexport function deleteEvents(device_id, events_list, cb_success) {\r\n  const params = { id: device_id, events_id: events_list }\r\n  const endpoint = \"/events/config/\"\r\n  backendApiRequest(DELETE, endpoint, null, params, cb_success )\r\n}\r\n\r\n\r\n\r\n\r\n\r\n// ---------------------------------------------------------------------------------\r\n// ---------------------------------------------------------------------------------\r\n// ---------------------------------------------------------------------------------\r\n// commot backend requests\r\nconst GET     = 'GET'\r\nconst POST    = 'POST'\r\nconst DELETE  = 'DELETE'\r\n\r\nasync function backendApiRequest(method, endpoint, body, params, cb_success, cb_error=null) {\r\n  let response = null\r\n  const BASE_URL = getBaseUrl()\r\n\r\n  switch (method) {\r\n    case GET:\r\n      response = await axiosInstance.get(BASE_URL + endpoint, { params: params } )\r\n      response && cb_success(response.data)\r\n      break;\r\n\r\n    case POST:\r\n      try { \r\n        response = await axiosInstance.post(BASE_URL + endpoint, body, { params: params } )\r\n        response && cb_success(response.data)\r\n      } catch (error) {\r\n        error.response && cb_error && cb_error(error.response.data)\r\n      }\r\n      break;\r\n\r\n    case DELETE:\r\n      response = await axiosInstance.delete(BASE_URL + endpoint, { params: params } )\r\n      response && cb_success(response.data)\r\n      break;\r\n\r\n    default:\r\n      throw `Api method ${method} not supported.`\r\n  }\r\n}","import React from 'react' \r\n\r\nexport function TextField(props){\r\n    // props.titel : str\r\n    // props.placeholder : str  \r\n    // props.id : str\r\n    // props.value : str\r\n    // props.comment : str or jsx\r\n    // props.onChange : function\r\n    return (\r\n      <React.Fragment>\r\n        <div className=\"form-group\">\r\n          <label htmlFor={props.id} className='text-secondary'>{props.titel}</label>\r\n          <input \r\n            type=\"text\" \r\n            className=\"form-control form-control-sm bg-secondary border-secondary text-light\" \r\n            placeholder={props.placeholder} \r\n            id={props.id} \r\n            defaultValue={props.value}\r\n            onChange={props.onChange}\r\n          ></input>\r\n          <ErrorMessage> {props.errors} </ErrorMessage>\r\n          <CommentMessage> {props.comment} </CommentMessage>\r\n        </div>\r\n      </React.Fragment>\r\n    ) \r\n  }\r\n  \r\nexport function NumberField(props){\r\n    // props.titel : str\r\n    // props.placeholder : str  => like \"12\"\r\n    // props.min : str  => like \"1\"\r\n    // props.max : str  => like \"5\"\r\n    // props.id : str\r\n    // props.value : int\r\n    // props.comment : str or jsx\r\n    // props.onChange : function\r\n    return (\r\n      <React.Fragment>\r\n        <div className=\"form-group\">\r\n          <label htmlFor={props.id} className='text-secondary'>{props.titel}</label>\r\n          <input \r\n            type=\"number\" \r\n            className=\"form-control form-control-sm bg-secondary border-secondary text-light\" \r\n            placeholder={props.placeholder} \r\n            id={props.id} \r\n            defaultValue={props.value}\r\n            min={props.min}\r\n            max={props.max}\r\n            onChange={props.onChange}            \r\n          ></input>\r\n          <ErrorMessage> {props.errors} </ErrorMessage>\r\n          <CommentMessage> {props.comment} </CommentMessage>\r\n        </div>\r\n      </React.Fragment>\r\n    ) \r\n  }\r\n  \r\nexport function SelectField(props){\r\n    // props.titel : str\r\n    // props.placeholder : str\r\n    // props.options : [{value, name}, {value, name}, ]\r\n    // props.id : str\r\n    // props.value : int\r\n    // props.comment : str or jsx\r\n    // props.onChange : function\r\n    return (\r\n      <React.Fragment>\r\n        <div className=\"form-group\">\r\n          <label htmlFor={props.id} className='text-secondary'>{props.titel}</label>\r\n          <select \r\n            className=\"form-control form-control-sm bg-secondary border-secondary text-light\" \r\n            id={props.id} \r\n            placeholder={props.placeholder} \r\n            value={ props.value ? props.value : '' }\r\n            onChange={props.onChange}            \r\n          >\r\n            <option value=\"\" disabled hidden>---</option>\r\n            {props.options && props.options.map((option, index)=>{\r\n              return <option key={index} value={option.value}>{option.name}</option>\r\n            })}\r\n          </select>\r\n          <ErrorMessage> {props.errors} </ErrorMessage>\r\n          <CommentMessage> {props.comment} </CommentMessage>\r\n        </div>\r\n      </React.Fragment>\r\n    ) \r\n  }\r\n  \r\nexport function MultipleSelectField(props){\r\n    // props.titel : str\r\n    // props.placeholder : str\r\n    // props.options : [{value, name}, {value, name}, ]\r\n    // props.id : str\r\n    // props.value : []\r\n    // props.comment : str or jsx\r\n    // props.onChange : function\r\n    return (\r\n      <React.Fragment>\r\n        <div className=\"form-group\">\r\n          <label htmlFor={props.id} className='text-secondary'>{props.titel}</label>\r\n          <select \r\n            multiple \r\n            className=\"form-control form-control-sm bg-secondary border-secondary text-light\" \r\n            id={props.id} \r\n            placeholder={props.placeholder}\r\n            value={ props.value ? props.value : [] } \r\n            onChange={props.onChange}            \r\n          >\r\n            {props.options && props.options.map((option, index)=>{\r\n              return <option key={index} value={option.value}>{option.name}</option>\r\n            })}\r\n          </select>\r\n          <ErrorMessage> {props.errors} </ErrorMessage>\r\n          <CommentMessage> {props.comment} </CommentMessage>\r\n        </div>\r\n      </React.Fragment>\r\n    ) \r\n  }\r\n  \r\nexport function CheckboxField(props){\r\n    // props.titel : str\r\n    // props.id : str\r\n    // props.checked : boolean\r\n    // props.comment : str or jsx\r\n    // props.onChange : function\r\n    return (\r\n      <React.Fragment>\r\n        <div className=\"form-check pb-3\">\r\n          <input \r\n            type=\"checkbox\" \r\n            className=\"form-check-input\" \r\n            id={props.id} \r\n            checked={props.checked}\r\n            onChange={props.onChange}\r\n        ></input>\r\n          <span>{props.titel}</span>\r\n          <ErrorMessage> {props.errors} </ErrorMessage>\r\n          <CommentMessage> {props.comment} </CommentMessage>\r\n        </div>\r\n      </React.Fragment>\r\n    ) \r\n  }\r\n  \r\nexport function InlineCheckboxField(props){\r\n  // props.titel : str\r\n  // props.id : str\r\n  // props.checked : boolean\r\n  // props.comment : str or jsx\r\n  // props.onChange : function\r\n  return (\r\n    <React.Fragment>\r\n      <div className=\"form-check-inline pb-3\">\r\n        <input \r\n          type=\"checkbox\" \r\n          className=\"form-check-input\" \r\n          id={props.id} \r\n          checked={props.checked}\r\n          onChange={props.onChange}\r\n        ></input>\r\n        <span>{props.titel}</span>\r\n        <ErrorMessage> {props.errors} </ErrorMessage>\r\n        <CommentMessage> {props.comment} </CommentMessage>\r\n      </div>\r\n    </React.Fragment>\r\n  ) \r\n}\r\n\r\n\r\n\r\nexport function ErrorMessage(props){\r\n  return <div className='text-small text-danger p-0 m-0'> {props.children} </div>  \r\n}\r\nexport function CommentMessage(props){\r\n  return <div className='text-small text-info p-0 m-0'> {props.children} </div> \r\n}\r\n\r\nexport function FormContainer(props) {\r\n  return <div className='container p-0' style={{maxWidth: '800px'}}> {props.children} </div> \r\n}\r\n\r\n  // ----------------------------------------------------------------------------------\r\n// utils\r\n\r\nexport function getSelectedOptions(e) {\r\n  var options = e.target.options;\r\n  var value = [];\r\n  for (var i = 0, l = options.length; i < l; i++) {\r\n    if (options[i].selected) {\r\n      value.push(options[i].value);\r\n    }\r\n  }  \r\n  return value\r\n}\r\n","import React, {useState, useEffect} from 'react' \r\nimport { useHistory, useParams } from \"react-router-dom\"\r\n\r\nimport Loader from '../../base/components/Loader'\r\nimport {\r\n  getDeviceTagsParameters,\r\n  postDeviceTagsParameters,\r\n  deleteDeviceTags,\r\n} from '../../backendAPI/backendAPI'\r\n\r\nimport {TextField, NumberField, SelectField, getSelectedOptions, ErrorMessage, FormContainer} from '../../base/forms/forms'\r\n\r\n\r\n\r\nexport default function TagDetailPage() {\r\n  const { tag_id, device_id } = useParams();\r\n  const [tagParameters, setTagParameters] = useState({})\r\n  const [formErrors, setFormErrors] = useState(null)\r\n  const [loading, setLoading] = React.useState(true)\r\n  const history = useHistory()\r\n\r\n  useEffect(()=>{\r\n    getDeviceTagsParameters(device_id, [tag_id], (data)=>{\r\n      setTagParameters(data[0])\r\n      setLoading(false)\r\n    })\r\n  }, [])\r\n  \r\n  const submitTagParameters = (tag_parameters) => {\r\n    postDeviceTagsParameters(device_id, [tag_parameters], \r\n      (responce_data)=>{ \r\n        setTagParameters(responce_data[0]); setFormErrors(null);  \r\n        history.push(`/device/${device_id}/admin/config/`);\r\n      },\r\n      (errors_data)=>{ setFormErrors(errors_data[0]) }\r\n    )\r\n  }\r\n\r\n  const cancelChanges = () => { \r\n    history.push(`/device/${device_id}/admin/config/`)\r\n  }\r\n\r\n  const deleteTag = () => { \r\n    deleteDeviceTags(device_id, [tag_id], ()=>{ history.push(`/device/${device_id}/admin/config/`) })\r\n  }\r\n  \r\n  return (\r\n    <React.Fragment>\r\n      { loading ? \r\n        <div className='d-flex justify-content-center'><Loader /></div> \r\n        :\r\n        <FormContainer> \r\n          <TagDetailForm tagParameters={tagParameters} formErrors={formErrors} \r\n            submitTagParameters={submitTagParameters} \r\n            cancelChanges={cancelChanges} \r\n            deleteTag={deleteTag} \r\n          />\r\n        </FormContainer> \r\n      }\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\n\r\n\r\nexport function TagCreatePage() {\r\n  const { device_id } = useParams();\r\n  const history = useHistory()\r\n  const defaultTagParameters = { \r\n    code: '', name: '', data_type: 'INT',\r\n    modbus_parameters: {data_type: 'INT', register_address: 0, read_function: '3', write_function: '6'}\r\n  }\r\n  const [formErrors, setFormErrors] = useState({})\r\n\r\n  const submitTagParameters = (tag_parameters) => {\r\n    postDeviceTagsParameters(device_id, [tag_parameters], \r\n      ()=>{ history.push(`/device/${device_id}/admin/config/`) },\r\n      (errors_data)=>{ setFormErrors(errors_data[0]) }\r\n    )\r\n  }\r\n\r\n  const cancelChanges = () => { \r\n    history.push(`/device/${device_id}/admin/config/`)\r\n  }\r\n  \r\n  return (\r\n    <FormContainer> \r\n      <TagDetailForm tagParameters={defaultTagParameters} formErrors={formErrors} \r\n        submitTagParameters={submitTagParameters} \r\n        cancelChanges={cancelChanges} \r\n      />\r\n    </FormContainer>\r\n  )\r\n}\r\n\r\n\r\n\r\n// ----------------------------------------------------------------------------------------------------------------------------\r\nfunction TagDetailForm (props) {\r\n  const [tag, setTag] = useState(props.tagParameters)\r\n  const onSubmit = props.submitTagParameters\r\n  const onCancel = props.cancelChanges\r\n  const onDelete = props.deleteTag\r\n  const buttonsStyle = {minWidth: '150px'}\r\n\r\n  const serverDataTypeOptions = [    \r\n    {value: 'INT',    name:'INT'}, \r\n    {value: 'FLOAT',  name:'FLOAT'}, \r\n    {value: 'STRING', name:'STRING'},\r\n    {value: 'BOOL',   name:'BOOL'}\r\n  ]\r\n  const modbusDataTypeOptions = [    \r\n    {value: 'WORD',   name:'WORD'}, \r\n    {value: 'INT',    name:'INT'}, \r\n    {value: 'UINT',   name:'UINT'}, \r\n    {value: 'FLOAT',  name:'FLOAT'}, \r\n    {value: 'STRING', name:'STRING'},\r\n    {value: 'BOOL',   name:'BOOL'}\r\n  ]\r\n  const modbusReadFunctionOptions = [    \r\n    {value: '1',  name:'1 - Read Coil'}, \r\n    {value: '2',  name:'2 - Read Discrete Input'}, \r\n    {value: '3',  name:'3 - Read Holding Registers'}, \r\n    {value: '4',  name:'4 - Read Input Registers'}\r\n  ]\r\n  const modbusWriteFunctionOptions = [    \r\n    {value: '5',   name:'5 - Write Single Coil'}, \r\n    {value: '6',   name:'6 - Write Single Holding Register'}, \r\n    {value: '15',  name:'15 - Write Multiple Coils'}, \r\n    {value: '16',  name:'16 - Write Multiple Holding Registers'}\r\n  ]\r\n\r\n  const handlCodeChange = (e) => { setTag({...tag, code: e.target.value}) }\r\n  const handlNameChange = (e) => { setTag({...tag, name: e.target.value}) }\r\n  const handlDataTypeChange = (e) => { setTag({...tag, data_type: getSelectedOptions(e)[0]}) }\r\n  const handlModbusDataTypeChange = (e) => { setTag({\r\n    ...tag, modbus_parameters: {...tag.modbus_parameters, data_type: getSelectedOptions(e)[0] } \r\n  })}\r\n  const handlModbusRegisterAddressChange = (e) => { setTag({\r\n    ...tag, modbus_parameters: {...tag.modbus_parameters, register_address: e.target.value } \r\n  })}\r\n  const handlModbusReadFunctionChange = (e) => { setTag({\r\n    ...tag, modbus_parameters: {...tag.modbus_parameters, read_function: getSelectedOptions(e)[0] } \r\n  })}\r\n  const handlModbusWriteFunctionChange = (e) => { setTag({\r\n    ...tag, \r\n    modbus_parameters: {...tag.modbus_parameters, write_function: getSelectedOptions(e)[0] } \r\n  })}\r\n\r\n  const handlSubmit = (e) => { \r\n    e.preventDefault();\r\n    onSubmit(tag);\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <form onSubmit={handlSubmit}> \r\n        <h5 className='text-info text-center'>Параметры тега</h5>     \r\n        <TextField titel={'Код'} id={'code'} value={tag.code} onChange={handlCodeChange} \r\n          errors={props.formErrors ? props.formErrors.code : null}\r\n        />  \r\n        <TextField titel={'Наименование'} id={'name'} value={tag.name} onChange={handlNameChange}\r\n          errors={props.formErrors ? props.formErrors.name : null}\r\n        />\r\n        <SelectField titel={'Тип данных на сервере'} id={'data_type'} value={tag.data_type} options={serverDataTypeOptions} onChange={handlDataTypeChange} \r\n          errors={props.formErrors ? props.formErrors.data_type : null}\r\n        />\r\n\r\n        <h5 className='text-info text-center'>Параметры Modbus</h5>\r\n        <SelectField titel={'Тип данных в устройстве'} id={'modbus_data_type'} value={tag.modbus_parameters ? tag.modbus_parameters.data_type : null} \r\n          options={modbusDataTypeOptions} onChange={handlModbusDataTypeChange} \r\n          errors={props.formErrors && props.formErrors.modbus_parameters ? props.formErrors.modbus_parameters.data_type : null}\r\n        />\r\n        <NumberField titel={'Адрес регистра'} id={'modbus_register_address'} value={tag.modbus_parameters ? tag.modbus_parameters.register_address : null } \r\n          onChange={handlModbusRegisterAddressChange}\r\n          errors={props.formErrors && props.formErrors.modbus_parameters ? props.formErrors.modbus_parameters.register_address : null}\r\n        />\r\n        <SelectField titel={'Функиця чтения'} id={'modbus_read_function'} value={tag.modbus_parameters ? tag.modbus_parameters.read_function : null} \r\n          options={modbusReadFunctionOptions} onChange={handlModbusReadFunctionChange} \r\n          errors={props.formErrors && props.formErrors.modbus_parameters ? props.formErrors.modbus_parameters.read_function : null}\r\n        />\r\n        <SelectField titel={'Функиця записи'} id={'modbus_write_function'} value={tag.modbus_parameters ? tag.modbus_parameters.write_function : null} \r\n          options={modbusWriteFunctionOptions} onChange={handlModbusWriteFunctionChange} \r\n          errors={props.formErrors && props.formErrors.modbus_parameters ? props.formErrors.modbus_parameters.write_function : null}  \r\n        />\r\n\r\n        <ErrorMessage>\r\n          {props.formErrors && props.formErrors.non_field_errors ? \r\n            <div className='card bg-danger text-dark my-3 p-2'> {props.formErrors.non_field_errors}</div>\r\n            : null\r\n          }\r\n        </ErrorMessage>\r\n\r\n\r\n        <div className='d-flex flex-wrap justify-content-center'>\r\n          <button type=\"submit\" className=\"btn btn-outline-primary m-2\" style={buttonsStyle}>Сохранить</button>\r\n          <button type=\"button\" className=\"btn btn-outline-secondary m-2\" style={buttonsStyle} onClick={onCancel}>Отмена</button>\r\n          { props.deleteTag && <button type=\"button\" className=\"btn btn-outline-danger m-2\" style={buttonsStyle} onClick={onDelete}>Удалить</button> }\r\n        </div>\r\n      </form>\r\n    </React.Fragment>\r\n  )\r\n}\r\n","import React, {useState, useEffect} from 'react' \r\nimport {useHistory, useParams} from \"react-router-dom\"\r\n\r\nimport Loader from '../../base/components/Loader'\r\n\r\nimport {\r\n  getDeviceParameters, \r\n  postDeviceParameters, \r\n  getDeviceModbusParameters, \r\n  postDeviceModbusParameters,\r\n  getDeviceTagsParameters\r\n} from '../../backendAPI/backendAPI'\r\n\r\nimport { TextField, NumberField, SelectField, \r\n  CheckboxField, getSelectedOptions, ErrorMessage\r\n} from '../../base/forms/forms'\r\n\r\n\r\nexport default function DeviceConfigPage() {\r\n  const { device_id } = useParams()\r\n  const [deviceParameters, setDeviceParameters] = useState({})\r\n  const [deviceParametersFormErrors, setDeviceParametersFormErrors] = useState(null)\r\n  const [deviceModbusParameters, setDeviceModbusParameters] = useState({})\r\n  const [deviceModbusParametersFormErrors, setDeviceModbusParametersFormErrors] = useState(null)\r\n  const [deviceTagsParameters, setDeviceTagsParameters] = useState([])\r\n  const [loading1, setLoading1] = React.useState(true)\r\n  const [loading2, setLoading2] = React.useState(true)\r\n  const [loading3, setLoading3] = React.useState(true)\r\n\r\n  useEffect(()=>{\r\n    getDeviceParameters(device_id, (data)=>{\r\n      setDeviceParameters(data)\r\n      setLoading1(false)\r\n    })\r\n    getDeviceModbusParameters(device_id, (data)=>{\r\n      setDeviceModbusParameters(data)\r\n      setLoading2(false)\r\n    })\r\n    getDeviceTagsParameters(device_id, [], (data)=>{\r\n      setDeviceTagsParameters(data)\r\n      setLoading3(false)\r\n    })\r\n  }, [])\r\n\r\n  const submitDeviceConfig = (device_parameters) => {\r\n    postDeviceParameters(device_id, device_parameters, \r\n      (responce_data)=>{ setDeviceParameters(responce_data); setDeviceParametersFormErrors(null); },\r\n      (errors_data)=>{ setDeviceParametersFormErrors(errors_data); },\r\n    )\r\n  }\r\n  const submitModbusParameters = (modbus_parameters) => {\r\n    postDeviceModbusParameters(device_id, modbus_parameters, \r\n      (responce_data)=>{ setDeviceModbusParameters(responce_data); setDeviceModbusParametersFormErrors(null); },\r\n      (errors_data)=>{ setDeviceModbusParametersFormErrors(errors_data); }\r\n    )\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      { loading1 || loading2 || loading3 ? \r\n        <div className='d-flex justify-content-center'><Loader /></div> \r\n        :\r\n        <div className='row'>\r\n          <div className='col-12 col-lg-5'>\r\n            <DeviceConfigsForm deviceParameters={deviceParameters} formErrors={deviceParametersFormErrors} submitDeviceConfig={submitDeviceConfig} />\r\n            <p className='my-3 border-top border-secondary'></p>\r\n            <DeviceModbusParametersForm deviceModbusParameters={deviceModbusParameters} formErrors={deviceModbusParametersFormErrors} submitModbusParameters={submitModbusParameters} />\r\n          </div>\r\n          <div className='col-12 col-lg-7 border-left border-secondary'>\r\n            <p className='my-3 d-lg-none border-top border-secondary'></p>\r\n            <TagsList deviceTagsParameters={deviceTagsParameters} device_id={device_id} />\r\n          </div>\r\n        </div>\r\n      }\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\n\r\n\r\n// ----------------------------------------------------------------------------------------------------------------------------\r\nfunction DeviceConfigsForm(props) {\r\n  const [parameters, setParameters] = useState(props.deviceParameters)\r\n  const onSubmit = props.submitDeviceConfig\r\n\r\n  const handlNameChange = (e) => { setParameters({...parameters, name: e.target.value}) }\r\n  const handlTimeoutChange = (e) => { setParameters({...parameters, timeout: e.target.value}) }\r\n  const handlPollingPeriodChange = (e) => { setParameters({...parameters, polling_period: e.target.value}) }\r\n\r\n  const handlSubmit = (e) => { \r\n    e.preventDefault();\r\n    onSubmit(parameters);\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <form onSubmit={handlSubmit}>\r\n        <h5 className='text-info'>Параметры прибора</h5>\r\n        <TextField titel={'Наименование прибора'} id={'name'} placeholder={'...'} value={parameters.name} onChange={handlNameChange}\r\n          errors={props.formErrors ? props.formErrors.name : null}\r\n        />\r\n        <NumberField titel={'Период опроса (сек)'} id={'polling_period'} placeholder={'...'} value={parameters.polling_period} min={1} \r\n          onChange={handlPollingPeriodChange}\r\n          errors={props.formErrors ? props.formErrors.polling_period : null}\r\n        />\r\n        <NumberField titel={'Таймаут соединения (сек)'} id={'timeout'} placeholder={'...'} value={parameters.timeout} \r\n          onChange={handlTimeoutChange}\r\n          errors={props.formErrors ? props.formErrors.timeout : null}\r\n        />\r\n\r\n        <ErrorMessage>\r\n          {props.formErrors && props.formErrors.non_field_errors ? <div className='card bg-danger text-dark my-3 p-2'> {props.formErrors.non_field_errors}</div> : null }\r\n        </ErrorMessage>\r\n\r\n        <div className='d-flex justify-content-center'>\r\n          <button type=\"submit\" className=\"btn btn-outline-primary\">Сохранить</button>\r\n        </div>\r\n      </form>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------------------------------------\r\nfunction DeviceModbusParametersForm(props) {\r\n  const [parameters, setParameters] = useState(props.deviceModbusParameters)\r\n  const onSubmit = props.submitModbusParameters\r\n\r\n  const protocolTypeOptions = [    \r\n    {value: 'RTU',    name:'Modbus-RTU'}, \r\n    {value: 'ASCII',  name:'Modbus-ASCII'}, \r\n    {value: 'TCP',     name:'Modbus-TCP'}\r\n  ]\r\n  const baudrateOptions = [    \r\n    {value: 300,    name:'300'}, \r\n    {value: 600,    name:'600'}, \r\n    {value: 1200,   name:'1200'},\r\n    {value: 2400,   name:'2400'},\r\n    {value: 4800,   name:'4800'},\r\n    {value: 9600,   name:'9600'},\r\n    {value: 14400,  name:'14400'},\r\n    {value: 19200,  name:'19200'},\r\n    {value: 28800,  name:'28800'},\r\n    {value: 38400,  name:'38400'},\r\n    {value: 57600,  name:'57600'},\r\n    {value: 115200, name:'115200'}\r\n  ]\r\n  const addressSizeOptions = [    \r\n    {value: '8', name:'8'}\r\n  ]\r\n  const parityOptions = [\r\n    {value: 'none', name: 'нет'},\r\n    {value: 'even', name: 'четность'},\r\n    {value: 'odd',  name: 'нечетность'}\r\n  ]\r\n  const stopBitOptions = [\r\n    {value: '1', name: '1'},\r\n    {value: '2',  name: '2'}\r\n  ]\r\n\r\n  const handlProtocolTypeChange = (e) => { setParameters({...parameters, protocol_type: getSelectedOptions(e)[0]}) }\r\n  const handlDeviceAddressChange = (e) => { setParameters({...parameters, device_address: e.target.value}) }\r\n  const handlBaudrateChange = (e) => { setParameters({...parameters, baudrate: getSelectedOptions(e)[0]}) }\r\n  const handlAddressSizeChange = (e) => { setParameters({...parameters, address_size: getSelectedOptions(e)[0]}) }\r\n  const handlParityChange = (e) => { setParameters({...parameters, parity: getSelectedOptions(e)[0]}) }\r\n  const handlStopbitChange = (e) => { setParameters({...parameters, stopbit: getSelectedOptions(e)[0]}) }\r\n  const handlPacketTimoutChange = (e) => { setParameters({...parameters, packet_timout: e.target.value}) }\r\n  const handlBitTimoutChange = (e) => { setParameters({...parameters, bit_timout: e.target.value}) }\r\n  const handlLowerByteForwardChange = (e) => { setParameters({...parameters, lower_byte_forward: e.target.checked}) }\r\n  const handlLowerRegisterForwardChange = (e) => { setParameters({...parameters, lower_register_forward: e.target.checked}) }\r\n  const handlAllowGroupReadingChange = (e) => { setParameters({...parameters, allow_group_reading: e.target.checked}) }\r\n\r\n  const handlSubmit = (e) => { \r\n    e.preventDefault();\r\n    onSubmit(parameters);\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <form onSubmit={handlSubmit}>\r\n        <h5 className='text-info'>Параметры протокола Modbus</h5>\r\n        <SelectField titel={'Протокол'} id={'protocol_type'} value={parameters.protocol_type} options={protocolTypeOptions} \r\n          onChange={handlProtocolTypeChange} \r\n          errors={props.formErrors ? props.formErrors.protocol_type : null}\r\n        />\r\n        <NumberField titel={'Адрес устройства'} id={'device_address'} value={parameters.device_address} min={1} max={247} \r\n          onChange={handlDeviceAddressChange}\r\n          errors={props.formErrors ? props.formErrors.device_address : null}\r\n        />\r\n        <SelectField titel={'Скорость передачи данных'} id={'baudrate'} value={parameters.baudrate} options={baudrateOptions} \r\n          onChange={handlBaudrateChange} \r\n          errors={props.formErrors ? props.formErrors.baudrate : null}\r\n        />\r\n        <SelectField titel={'Длинна адреса'} id={'address_size'} value={parameters.address_size} options={addressSizeOptions} \r\n          onChange={handlAddressSizeChange} \r\n          errors={props.formErrors ? props.formErrors.address_size : null}\r\n        />\r\n        <SelectField titel={'Контроль чётности'} id={'parity'} value={parameters.parity} options={parityOptions} \r\n          onChange={handlParityChange} \r\n          errors={props.formErrors ? props.formErrors.parity : null}\r\n        />\r\n        <SelectField titel={'Количество стоп-битов'} id={'stopbit'} value={parameters.stopbit} options={stopBitOptions} \r\n          onChange={handlStopbitChange} \r\n          errors={props.formErrors ? props.formErrors.stopbit : null}\r\n        />\r\n        <NumberField titel={'Таймаут запроса (мс)'} id={'packet_timout'} value={parameters.packet_timout} \r\n          onChange={handlPacketTimoutChange}\r\n          errors={props.formErrors ? props.formErrors.packet_timout : null}\r\n        />\r\n        <NumberField titel={'Таймаут бита (мс)'} id={'bit_timout'} value={parameters.bit_timout} \r\n          onChange={handlBitTimoutChange}\r\n          errors={props.formErrors ? props.formErrors.bit_timout : null}\r\n        />\r\n        <CheckboxField titel={'Младшим байтом вперед'} id={'lower_byte_forward'} checked={parameters.lower_byte_forward} \r\n          onChange={handlLowerByteForwardChange}\r\n          errors={props.formErrors ? props.formErrors.lower_byte_forward : null}\r\n        />  \r\n        <CheckboxField titel={'Младшим регистром вперед'} id={'lower_register_forward'} checked={parameters.lower_register_forward} \r\n          onChange={handlLowerRegisterForwardChange}\r\n          errors={props.formErrors ? props.formErrors.lower_register_forward : null}\r\n        />  \r\n        <CheckboxField titel={'Разрешить групповое чтение'} id={'allow_group_reading'} checked={parameters.allow_group_reading} \r\n          onChange={handlAllowGroupReadingChange}\r\n          errors={props.formErrors ? props.formErrors.allow_group_reading : null}\r\n        />  \r\n        \r\n        <ErrorMessage>\r\n          {props.formErrors && props.formErrors.non_field_errors ? <div className='card bg-danger text-dark my-3 p-2'> {props.formErrors.non_field_errors}</div> : null }\r\n        </ErrorMessage>\r\n\r\n        <div className='d-flex justify-content-center'>\r\n          <button type=\"submit\" className=\"btn btn-outline-primary\">Сохранить</button>\r\n        </div>\r\n      </form>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n// ----------------------------------------------------------------------------------------------------------------------------\r\nfunction TagsList (props) {\r\n  const tags = props.deviceTagsParameters\r\n  const history = useHistory()\r\n\r\n  const createNewTag = () => {\r\n    history.push(`/device/${props.device_id}/admin/config/tags/create/`)\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='d-flex'>\r\n        <h5 className='text-info'>Теги прибора</h5>\r\n        <button type=\"button\" className=\"btn btn-sm btn-outline-success ml-auto\" onClick={createNewTag}> \r\n          <i className='fas fa-plus px-1'></i> Добавить новый тег\r\n        </button>\r\n      </div>\r\n\r\n      { tags.length > 0 ?\r\n        <div className=\"table-responsive\">\r\n          <table className=\"table table-hover table-dark table-striped table-sm text-light w-100 mb-0\">\r\n            <thead> \r\n              <tr>\r\n                <th className='border-0 text-secondary font-weight-bold pl-2'>№</th>\r\n                <th className='border-0 text-secondary font-weight-bold'>Код параметра</th>\r\n                <th className='border-0 text-secondary font-weight-bold'>Тип данных</th>\r\n                <th className='border-0 text-secondary font-weight-bold'>Наименование</th>\r\n                <th className='border-0 text-secondary font-weight-bold'>Текущее значение</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {\r\n                tags.map((tag, index)=>{\r\n                  return ( <TagsListEntry key={index} tag={tag} index={index} device_id={props.device_id} /> )\r\n                })\r\n              }\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n        :\r\n        <i className='text-secondary ml-3'>Теги не заданы ... </i>\r\n      }\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\n\r\nfunction TagsListEntry (props) {\r\n  const tag = props.tag\r\n  const history = useHistory()\r\n\r\n  const goToTagDetail = (tag_id) => {\r\n    history.push(`/device/${props.device_id}/admin/config/tags/${tag_id}/detail/`)\r\n  }\r\n\r\n  return (\r\n    <tr className='table-row-like-link' onClick={()=> goToTagDetail(tag.id)}>\r\n      <td className='border-0 text-secondary pl-2'> {props.index + 1} </td> \r\n      <td className='border-0'> {tag.code} </td>\r\n      <td className='border-0'> {tag.data_type} </td>\r\n      <td className='border-0'> {tag.name} </td>\r\n      <td className='border-0'> {tag.value} </td>\r\n    </tr>\r\n  )\r\n}\r\n\r\n\r\n\r\n\r\n","import React from 'react' \r\n\r\n\r\nexport default function Page404() {\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='bg-color-dark-gray text-secondary content-height'>\r\n        <div className='container mt-5 text-center'>\r\n          <h1>Error 404</h1>\r\n          <h3>Страница не найдена</h3>\r\n        </div>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n ","import React, {useState, useEffect} from 'react' \r\n\r\nimport Loader from '../../base/components/Loader'\r\nimport {getDeviceParameters} from '../../backendAPI/backendAPI'\r\n\r\n\r\n\r\nexport default function DeviceStatusBar (props) {\r\n    const device_id = props.device_id;\r\n    const [deviceParameters, setDeviceParameters] = useState({})\r\n    const [loading, setLoading] = React.useState(true)\r\n  \r\n    useEffect(()=>{\r\n      getDeviceParameters(device_id, (data)=>{\r\n        setDeviceParameters(data)\r\n        setLoading(false)\r\n      })\r\n    }, [])\r\n  \r\n    return (\r\n      <React.Fragment>\r\n        { loading ? \r\n          <div className='d-flex justify-content-center'><Loader /></div> \r\n          :\r\n          <div className='d-flex border-bottom border-secondary mb-3 pb-2'>\r\n            <h5 className='pt-2 mt-1'>Прибор: <b>{deviceParameters.name}</b></h5>\r\n            <div className='ml-auto mx-3 px-3 border-x border-secondary'>\r\n              { deviceParameters.is_online ? \r\n                <div className='text-success'>\r\n                  <span>Онлайн</span> <br/>\r\n                  <i className='fas fa-check text-center w-100'></i>\r\n                </div>\r\n              : <div className='text-danger'>\r\n                  <span>Нет связи</span> <br/>\r\n                  <i className='fas fa-times text-center w-100'></i>\r\n                </div>\r\n              }\r\n            </div>\r\n            <div>\r\n              <p className='m-0 mr-1 text-right'>Последний сеанс связи: <br/> {deviceParameters.verbose_last_update}</p>\r\n            </div>\r\n          </div>\r\n        }\r\n      </React.Fragment>\r\n    )\r\n  }\r\n  \r\n  ","import React from 'react' \r\nimport {Switch, Route, useParams} from \"react-router-dom\"\r\n\r\nimport TagDetailPage, {TagCreatePage} from './tagDetail'\r\nimport DeviceConfigPage from './deviceDetail'\r\nimport Page404 from '../../base/pages/pageNotFound'\r\nimport DeviceStatusBar from '../components/AdminPageDeviceStatusBar'\r\n\r\n\r\n\r\n\r\nexport default function DeviceAdminPage() {\r\n  const { device_id } = useParams();\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <h3 className='mb-3'>Настройка параметров прибора</h3>\r\n      <div className='px-3 pb-3 pt-2 mx-1 my-0 bg-dark rounded text-light' style={{minHeight: 'calc(100vh - 135px)'}}>\r\n        <DeviceStatusBar device_id={device_id}/>\r\n        <Switch>\r\n          <Route exact path={'/device/:device_id/admin/config/'} component={()=><DeviceConfigPage/>} />\r\n          <Route exact path={`/device/:device_id/admin/config/tags/:tag_id/detail/`} component={()=><TagDetailPage/>} />\r\n          <Route exact path={`/device/:device_id/admin/config/tags/create/`} component={()=><TagCreatePage/>} />\r\n          <Route component={Page404} />\r\n        </Switch> \r\n      </div>\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\n\r\n\r\n","import React, {useEffect} from 'react' \r\nimport {useParams} from 'react-router-dom'\r\n\r\nimport {\r\n  TextField,\r\n  NumberField,\r\n  SelectField,\r\n  MultipleSelectField,\r\n  CheckboxField,\r\n  getSelectedOptions\r\n} from '../../base/forms/forms'\r\n\r\nimport sortWidgetsByOrder from '../utils/sortWidgetsByOrder'\r\n\r\nimport Loader from '../../base/components/Loader'\r\nimport axiosInstance from \"../../backendAPI/axiosApi\";\r\nimport getBaseUrl from '../../backendAPI/localSettings'\r\nconst BASE_URL = getBaseUrl()\r\n\r\nexport default function WidgetsAdminPage(props) {\r\n  const { device_id } = useParams();\r\n  const updateWidgetsTemplate = props.updateWidgetsTemplate\r\n  const [widgetsTemplate, setWidgetsTemplate] = React.useState( sortWidgetsByOrder(props.widgetsTemplate) )\r\n  const [selectedWidget, setSelectedWidget] = React.useState(0)\r\n  const [tags, setTags] = React.useState([])\r\n\r\n  // read tags list\r\n  const readDeviceTags = () => {\r\n    axiosInstance.get(BASE_URL + \"/device/tags/value/\", { params: { id: device_id }} )\r\n    .then((responce) => {\r\n      responce && setTags(responce.data)\r\n    })  \r\n  }\r\n  useEffect(() => {\r\n    readDeviceTags();\r\n  }, [])\r\n\r\n\r\n  // I use it for fix bug: witout this, when I change the same type forms, \r\n  // form fields data does not changing \r\n  // if i hide and show the form, fields data update correctly\r\n  const [displayWidget, setDisplayWidget] = React.useState(false) \r\n  const rerenderWidgetForm = () => {\r\n    setDisplayWidget(false)\r\n    setTimeout( () => { setDisplayWidget(true) }, 0);\r\n  }\r\n  useEffect(() => {\r\n    rerenderWidgetForm()\r\n  }, [selectedWidget, tags])  \r\n\r\n\r\n  // control buttons\r\n  const changeSelectedWidget = (widgetNumber) => {\r\n    setSelectedWidget(widgetNumber)\r\n  }\r\n\r\n  const saveWidgetsTemplate = () => {\r\n    updateWidgetsTemplate(widgetsTemplate)\r\n  }\r\n\r\n  const cancelTemplateChanges = () => {\r\n    setWidgetsTemplate( sortWidgetsByOrder(props.widgetsTemplate) )\r\n    setSelectedWidget(0)\r\n    rerenderWidgetForm()\r\n  }\r\n\r\n  const deleteWidget = (index) => {\r\n    const wt = widgetsTemplate.widgets.map((w)=>{return w})\r\n    wt.splice(index, 1)\r\n    setWidgetsTemplate({widgets: wt})\r\n    setSelectedWidget(0)\r\n  }\r\n\r\n  // update widget config\r\n  const updateWidget = (WidgetData) => {\r\n    const wt = widgetsTemplate.widgets.map((w, index)=>{\r\n      if (index === selectedWidget) {\r\n        return WidgetData\r\n      } else {\r\n        return w\r\n      }\r\n    })\r\n    setWidgetsTemplate({widgets: wt})\r\n  }\r\n\r\n  // const onChangeWidgetOrder = (w_index, new_order) => {\r\n  //   // TODO\r\n  //   ;\r\n  // }\r\n\r\n  // add new widget\r\n  const addWidgetToTemplate = (widget) => {\r\n    var a = widgetsTemplate.widgets.map((item)=>{return item})\r\n    a.push(widget)\r\n    setWidgetsTemplate({widgets: a})   \r\n  }\r\n\r\n  const addWidgetHendler = (type) => {\r\n    if (type === 'table') { addWidgetToTemplate(DefaultTable) } \r\n    else if (type === 'graph') { addWidgetToTemplate(DefaultGraph) }\r\n    else if (type === 'indicator') { addWidgetToTemplate(DefaultIndicator) }\r\n  }\r\n\r\n  if (!widgetsTemplate.widgets) {return <Loader />}\r\n\r\n  // render page\r\n  return (\r\n    <React.Fragment>\r\n      <h3 className='mb-3'>Настройка виджетов</h3>\r\n      <div className='row equal p-0 m-0'>\r\n        <div className='col-md-6 col-lg-7 col-xl-8 px-1' style={{minHeight: '80vh'}}>\r\n          <div className='p-0 m-0 bg-dark rounded h-100'>\r\n            <WidgetsGrid widgetsTemplate={widgetsTemplate} selectedWidget={selectedWidget} changeSelectedWidget={changeSelectedWidget}/>\r\n          </div>\r\n        </div>\r\n        <div className='col-md-6 col-lg-5 col-xl-4 px-1' style={{minHeight: '80vh'}}>\r\n          <div className='p-0 m-0 bg-dark rounded h-100'>\r\n            <WidgetsControlPanel addWidget={addWidgetHendler} saveWidgetsTemplate={saveWidgetsTemplate} cancelChanges={cancelTemplateChanges}/>\r\n            { displayWidget ? \r\n              <WidgetForm widget={widgetsTemplate.widgets[selectedWidget]} tags={tags} updateWidget={updateWidget} deleteWidget={()=>deleteWidget(selectedWidget)}/> \r\n              : null }\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n// -------------------------------------------------------------------------------------------------\r\nfunction WidgetsGrid(props){\r\n  const widgetsTemplate = props.widgetsTemplate\r\n  const selectedWidget = props.selectedWidget\r\n  const changeSelectedWidget = props.changeSelectedWidget\r\n\r\n  if (!widgetsTemplate.widgets) {return <Loader />}\r\n\r\n  const content = widgetsTemplate.widgets.map((widget, index)=>{\r\n    const btnAddClass= (index===selectedWidget) ?  'border-primary' : ''\r\n    return (\r\n      <div key={index} className={`col-${widget.width * 3} p-1 m-0`}> \r\n        <button className={'btn btn-dark w-100 h-100 text-left p-0 ' + btnAddClass} style={{overflow:'hidden', minHeight:'10vh', boxShadow: 'none'}} onClick={()=>{changeSelectedWidget(index)}}>\r\n          <div className='h-100 p-0 px-2'>\r\n            <span className='small text-nowrap'>{widget.title}</span>\r\n            <WidgetPreview widget={widget} />\r\n          </div>\r\n        </button>\r\n      </div>\r\n    )\r\n  })\r\n\r\n  return (\r\n    <div className='d-flex justify-content-center m-0 p-4' style={{}}>\r\n      <div className='row equal rounded m-0 p-3' style={{backgroundColor: '#1E1E1E', maxWidth:'800px'}}>\r\n        {content}\r\n      </div>\r\n    </div>\r\n  )\r\n} \r\n\r\n\r\nconst WidgetPreview = (props) => {\r\n  const widget = props.widget\r\n  const color = props.color ? props.color : 'secondary'\r\n\r\n  if (widget.type === 'table') {\r\n    return (\r\n      <div className='d-flex justify-content-center'>\r\n        <span className={`fas fa-table text-${color} m-2`} style={{fontSize:'4em'}}></span>\r\n      </div>\r\n    )\r\n  } else if (widget.type === 'graph') {\r\n    return (\r\n      <div className='d-flex justify-content-center'>\r\n        <span className={`fas fa-chart-area text-${color} m-2`} style={{fontSize:'4em'}}></span>\r\n      </div>\r\n      )\r\n  } else if (widget.type === 'indicator') {\r\n    return (\r\n      <div className='d-flex justify-content-center'>\r\n        <span className={`border rounded-sm text-${color} border-${color} text-nowrap m-2 px-2`} style={{fontSize:'1.5em'}}>{widget.addTextLeft} XX.X {widget.addTextRight}</span>\r\n      </div>\r\n      )\r\n  } else {\r\n    return null\r\n  }   \r\n}\r\n\r\n\r\n// -------------------------------------------------------------------------------------------------\r\nfunction WidgetsControlPanel(props){\r\n  const [show, setShow] = React.useState(false);\r\n  const handleClose = () => setShow(false);\r\n  const handleShow = () => setShow(true);\r\n\r\n  const handleAddWidget = (type) => {\r\n    props.addWidget(type);\r\n    handleClose();\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <div className='p-2'> \r\n        <div className='m-1 pt-2 pb-3 border-bottom border-secondary'>\r\n          <div className='d-flex justify-content-left'>\r\n            <button className='btn btn-outline-info btn-sm mr-3' type='button' onClick={handleShow}> Добавить виджет</button>\r\n            <button className='btn btn-outline-success btn-sm mr-3' type='button' onClick={props.saveWidgetsTemplate}>Сохранить</button>\r\n            <button className='btn btn-outline-danger btn-sm' type='button' onClick={props.cancelChanges}>Отмена</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <ModalSelectWidgetType show={show} handleClose={handleClose} handleAddWidget={handleAddWidget}/>\r\n    </>\r\n  )\r\n}\r\n\r\n\r\nfunction WidgetForm(props){\r\n  const widget = props.widget\r\n  const tags = props.tags\r\n  const updateWidget = props.updateWidget\r\n  const deleteWidget = props.deleteWidget\r\n  let w = {}\r\n\r\n  if (! widget) {return null}\r\n\r\n  if (widget.type === 'table') { w = <WTableForm widget={widget} tags={tags} updateWidget={updateWidget} deleteWidget={deleteWidget}/> }\r\n  if (widget.type === 'graph') { w = <WGraphForm widget={widget} tags={tags} updateWidget={updateWidget} deleteWidget={deleteWidget}/> }\r\n  if (widget.type === 'indicator') { w = <WIndicatorForm widget={widget} tags={tags} updateWidget={updateWidget} deleteWidget={deleteWidget}/> } \r\n  \r\n  return (\r\n    <div className='p-0 m-0 my-1'> \r\n      <FormContainer> {w} </FormContainer>\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\nfunction FormContainer(props){\r\n  return (\r\n    <div className='text-light p-2 m-0 mx-1 h-100'>\r\n      {props.children}\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\n// -------------------------------------------------------------------------------------------------\r\nfunction ModalSelectWidgetType(props){\r\n  const WidgetTypeButton = (props) => {\r\n    return (\r\n      <div className='col-4 p-1 w-100'>\r\n        <button type=\"button\" className=\"btn btn-primary w-100 h-100\" onClick={props.onClick}>\r\n          <div className='h-100 p-0 px-2'>\r\n            {props.children}\r\n          </div>\r\n        </button>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (props.show) {\r\n    return(\r\n      <div className=\"modal modal-bg d-block\">\r\n        <div className=\"modal-dialog\">\r\n          <div className=\"modal-content\">\r\n\r\n            <div className=\"modal-header\">\r\n              <h4 className=\"modal-title\">Добавить новый виджет</h4>\r\n              <button type=\"button\" className=\"close\" onClick={props.handleClose}>&times;</button>\r\n            </div>\r\n\r\n            <div className=\"modal-body\">\r\n              <div className='row equal px-1'>\r\n                <WidgetTypeButton onClick={()=> props.handleAddWidget('indicator')}>\r\n                  <span className='text-nowrap'>Индикатор</span>\r\n                  <div className='pt-2'></div>\r\n                  <WidgetPreview widget={{type:'indicator'}} color={'light'} />\r\n                </WidgetTypeButton>\r\n                <WidgetTypeButton onClick={()=> props.handleAddWidget('table')}>\r\n                  <span className='text-nowrap'>Таблица</span>\r\n                  <WidgetPreview widget={{type:'table'}} color={'light'} />\r\n                </WidgetTypeButton>\r\n                <WidgetTypeButton onClick={()=> props.handleAddWidget('graph')}>\r\n                  <span className='text-nowrap'>График</span>\r\n                  <WidgetPreview widget={{type:'graph'}} color={'light'} />\r\n                </WidgetTypeButton>  \r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"modal-footer\">\r\n              <button type=\"button\" className=\"btn btn-danger\" onClick={props.handleClose}>Отмена</button>\r\n            </div>\r\n\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n  } else {\r\n    return null\r\n  }\r\n}\r\n\r\n\r\n// -------------------------------------------------------------------------------------------------\r\nfunction WTableForm(props){\r\n  const widget = props.widget\r\n  const tags = props.tags\r\n  const updateWidget = props.updateWidget\r\n  const columnOptions = [\r\n    {value: '#No', name: '№'},\r\n    {value: 'code', name: 'Код тега'},\r\n    {value: 'name', name: 'Наименование тега'},\r\n    {value: 'value', name: 'Значение тега'}\r\n  ]\r\n  let tagsOptions = []\r\n\r\n  if (tags) {\r\n    tagsOptions = tags.map((tag)=>{\r\n      return {value: tag.code, name: (tag.code + ' - ' + tag.name) }\r\n    })\r\n  }\r\n\r\n  const handlTitleChange = (e) => { updateWidget({...widget, title: e.target.value}) }\r\n  const handlOrderChange = (e) => { updateWidget({...widget, order: e.target.value}) }\r\n  const handlWidthChange = (e) => { updateWidget({...widget, width: e.target.value}) }\r\n  const handlSelectedTagsChange = (e) => { updateWidget({...widget, tags: getSelectedOptions(e)}) }\r\n  const handlSelectedColumnsChange = (e) => { updateWidget({...widget, columns: getSelectedOptions(e)}) }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='d-flex'>\r\n        <h6>Таблица</h6>\r\n        <button type=\"button\" className=\"btn btn-sm btn-outline-danger ml-auto\" onClick={props.deleteWidget}>Удалить</button>\r\n      </div>\r\n      <form>\r\n        <TextField titel={'Название'} id={'title'} placeholder={'...'} value={widget.title} onChange={handlTitleChange}/>\r\n        <NumberField titel={'Порядок отображения'} id={'order'} placeholder={'...'} value={widget.order} onChange={handlOrderChange}/>\r\n        <NumberField titel={'Ширина'} id={'width'} placeholder={'...'} value={widget.width} min={1} max={4} onChange={handlWidthChange}/>\r\n        <MultipleSelectField \r\n          titel={'Теги'} \r\n          id={'tags'} \r\n          placeholder={'...'} \r\n          value={widget.tags} \r\n          options={tagsOptions} \r\n          comment={<span className='m-0 p-0 d-block mt-1'>Удерживайте <kbd className='text-info'>Ctrl</kbd> для выбора нескольких элементов</span>}\r\n          onChange={handlSelectedTagsChange}\r\n        />\r\n        <MultipleSelectField \r\n          titel={'Колонки'} \r\n          id={'columns'} \r\n          placeholder={'...'} \r\n          value={widget.columns} \r\n          options={columnOptions} \r\n          comment={<span className='m-0 p-0 d-block mt-1'>Удерживайте <kbd className='text-info'>Ctrl</kbd> для выбора нескольких элементов</span>}\r\n          onChange={handlSelectedColumnsChange}\r\n        />          \r\n      </form>\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\n// table config example\r\n// {\r\n//   type: 'table',\r\n//   width: 2,\r\n//   title: 'Таблица параметров 2',\r\n//   tags: ['TEMP1', 'TEMP2', 'TEMP3'],   \r\n//   columns: ['#No', 'code', 'name', 'value']              \r\n// }\r\n\r\n\r\n// ----------------------------------------------------------------------------------\r\nfunction WGraphForm(props){\r\n  const widget = props.widget\r\n  const tags = props.tags\r\n  const updateWidget = props.updateWidget\r\n  let tagsOptions = []\r\n\r\n  if (tags) {\r\n    tagsOptions = tags.map((tag)=>{\r\n      return  {value: tag.code, name: (tag.code + ' - ' + tag.name) }\r\n    })\r\n  }\r\n\r\n  const handlTitleChange = (e) => { updateWidget({...widget, title: e.target.value}) }\r\n  const handlOrderChange = (e) => { updateWidget({...widget, order: e.target.value}) }\r\n  const handlWidthChange = (e) => { updateWidget({...widget, width: e.target.value}) }\r\n  const handlSelectedTagsChange = (e) => { updateWidget({...widget, tags: getSelectedOptions(e)}) }\r\n  const handlLegendChange = (e) => { updateWidget({...widget, legend: e.target.checked}) }\r\n  const handlToolbarChange = (e) => { updateWidget({...widget, toolbar: e.target.checked}) }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='d-flex'>\r\n        <h6>График</h6>\r\n        <button type=\"button\" className=\"btn btn-sm btn-outline-danger ml-auto\" onClick={props.deleteWidget}>Удалить</button>\r\n      </div>\r\n      <form>\r\n        <TextField titel={'Название'} id={'title'} placeholder={'...'} value={widget.title} onChange={handlTitleChange}/>\r\n        <NumberField titel={'Порядок отображения'} id={'order'} placeholder={'...'} value={widget.order} onChange={handlOrderChange}/>\r\n        <NumberField titel={'Ширина'} id={'width'} placeholder={'...'} value={widget.width} min={1} max={4} onChange={handlWidthChange}/>\r\n        <MultipleSelectField \r\n          titel={'Теги'} \r\n          id={'tags'} \r\n          placeholder={'...'} \r\n          value={widget.tags} \r\n          options={tagsOptions} \r\n          comment={<span className='m-0 p-0 d-block mt-1'>Удерживайте <kbd className='text-info'>Ctrl</kbd> для выбора нескольких элементов</span>}\r\n          onChange={handlSelectedTagsChange}\r\n        />\r\n        <CheckboxField titel={'Легенда'} id={'legend'} checked={widget.legend} onChange={handlLegendChange}/>  \r\n        <CheckboxField titel={'Панель инструментов'} id={'toolbar'} checked={widget.toolbar} onChange={handlToolbarChange}/>  \r\n      </form>\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\n// graph config example\r\n// {\r\n//   type: 'graph',\r\n//   width: 2,\r\n//   title: 'Влажность',\r\n//   tags: ['RH1', 'RH2'],\r\n//   legend: true,\r\n//   toolbar: true,\r\n// }  \r\n\r\n\r\n// ----------------------------------------------------------------------------------\r\nfunction WIndicatorForm(props){\r\n  const widget = props.widget\r\n  const tags = props.tags\r\n  const updateWidget = props.updateWidget\r\n  let tagsOptions = []\r\n\r\n  if (tags) {\r\n    tagsOptions = tags.map((tag)=>{\r\n      return {value: tag.code, name: (tag.code + ' - ' + tag.name) }\r\n    })\r\n  }\r\n\r\n  const handlTitleChange = (e) => { updateWidget({...widget, title: e.target.value}) }\r\n  const handlOrderChange = (e) => { updateWidget({...widget, order: e.target.value}) }\r\n  const handlWidthChange = (e) => { updateWidget({...widget, width: e.target.value}) }\r\n  const handlSelectedTagsChange = (e) => { updateWidget({...widget, tags: getSelectedOptions(e)}) }  \r\n  const handlPrecisionChange = (e) => { updateWidget({...widget, precision: e.target.value}) }  \r\n  const handlTextLeftChange = (e) => { updateWidget({...widget, addTextLeft: e.target.value}) }\r\n  const handlTextRightChange = (e) => { updateWidget({...widget, addTextRight: e.target.value}) }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='d-flex'>\r\n        <h6>Индикатор</h6>\r\n        <button type=\"button\" className=\"btn btn-sm btn-outline-danger ml-auto\" onClick={props.deleteWidget}>Удалить</button>\r\n      </div>\r\n      <form>\r\n        <TextField titel={'Название'} id={'title'} placeholder={'...'} value={widget.title} onChange={handlTitleChange}/>\r\n        <NumberField titel={'Порядок отображения'} id={'order'} placeholder={'...'} value={widget.order} onChange={handlOrderChange}/>\r\n        <NumberField titel={'Ширина'} id={'width'} placeholder={'...'} value={widget.width} min={1} max={4} onChange={handlWidthChange}/>\r\n        <SelectField \r\n          titel={'Тег'} \r\n          id={'tags'} \r\n          placeholder={'...'} \r\n          value={widget.tags[0]} \r\n          options={tagsOptions} \r\n          onChange={handlSelectedTagsChange}          \r\n        />\r\n        <NumberField titel={'Количество знаков после запятой'} id={'precision'} placeholder={'...'} value={widget.precision} min={0} max={5} onChange={handlPrecisionChange}/>\r\n        <TextField titel={'Добавить текст слева'} id={'addTextLeft'} placeholder={'...'} value={widget.addTextLeft} onChange={handlTextLeftChange}/>\r\n        <TextField titel={'Добавить текст справа'} id={'addTextRight'} placeholder={'...'} value={widget.addTextRight} onChange={handlTextRightChange}/>\r\n      </form>        \r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\n// indicator config example\r\n// {\r\n//   type: 'indicator',\r\n//   width: 1,\r\n//   title: 'Температура зоны 1',\r\n//   addTextLeft: '',\r\n//   addTextRight: '°C',      \r\n//   tags: ['PT1'],                \r\n// }\r\n\r\n\r\n\r\n\r\n// ----------------------------------------------------------------------------------\r\n// utils\r\n\r\nconst DefaultTable = {\r\n  type: 'table',\r\n  width: 4,\r\n  title: 'Новая таблица',\r\n  tags: [],   \r\n  columns: ['#No', 'code', 'name', 'value']               \r\n}\r\n\r\nconst DefaultGraph = {\r\n  type: 'graph',\r\n  width: 4,\r\n  title: 'Новый график',\r\n  tags: [],\r\n  legend: false,\r\n  toolbar: true,              \r\n}\r\n\r\nconst DefaultIndicator = {\r\n  type: 'indicator',\r\n  width: 1,\r\n  title: 'Новый индикатор',\r\n  tags: [],          \r\n  precision: 1,     \r\n}","import React, {useState, useEffect} from 'react' \r\nimport {NavLink, useParams} from 'react-router-dom'\r\n\r\nimport Loader from '../../base/components/Loader'\r\n\r\nimport {\r\n  getEventsConfig,\r\n  postEventsConfig,\r\n  deleteEvents,\r\n  getDeviceParameters,\r\n} from '../../backendAPI/backendAPI'\r\n\r\n\r\n\r\nexport default function EventsAdminPage() {\r\n  const { device_id } = useParams();\r\n  const [events, setEvents] = useState([])\r\n  const [deviceData, setDeviceData] = React.useState({})\r\n  const [loading, setLoading] = React.useState(true)\r\n\r\n  function handlEventDelete(event_id) {\r\n    deleteEvents(device_id, [event_id], ()=>{\r\n      setEvents(\r\n        events.filter((event)=>{ return event_id === event.id ? false : true })\r\n      )\r\n    }) \r\n  }  \r\n\r\n  function toggleEventEnable(event) {\r\n    const events_parameters = [{...event, enable: !event.enable}]  \r\n    postEventsConfig(device_id, events_parameters, \r\n      (data)=>{\r\n        const ev = events.map((event)=>{ return data[0].id === event.id ? {...data[0]} : event })\r\n        setEvents(ev)\r\n      }, \r\n      (errors_data)=>{ console.log(errors_data); }\r\n    )\r\n  }\r\n\r\n  useEffect(() => {\r\n    getEventsConfig(device_id, [], (data)=>{\r\n      setEvents(data);\r\n      setLoading(false);\r\n    }) \r\n    getDeviceParameters(device_id, setDeviceData);\r\n  }, [])\r\n\r\n  return (\r\n    <React.Fragment>\r\n        <h3 className='mb-3'>Настройка событий устройства</h3>\r\n          <div className='p-3 mx-1 my-0 bg-dark rounded text-light' style={{minHeight: 'calc(100vh - 135px)'}}>\r\n            { loading ? \r\n              <div className='d-flex justify-content-center'><Loader /></div> : \r\n              <React.Fragment>\r\n                <div className='d-flex mb-3 border-bottom border-secondary pb-3'>\r\n                  <h4 className='pt-1 text-info'>Список событий устройства \"{deviceData.name}\"</h4>\r\n                  <NavLink  to={`/device/${device_id}/admin/events/create/`} \r\n                            className='btn btn-outline-info ml-auto'\r\n                            device_id={device_id}\r\n                  >\r\n                    Добавить новое событие <i className=''></i>\r\n                  </NavLink>\r\n                </div>\r\n\r\n                { events.length > 0 ?\r\n                  <EventsList events={events} device_id={device_id} handlEventDelete={handlEventDelete} toggleEventEnable={toggleEventEnable}/>\r\n                  :\r\n                  <NoEvents />\r\n                }\r\n              </React.Fragment>\r\n            }\r\n\r\n          </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n\r\n\r\n//---------------------------------------------------------------------------------------\r\nfunction EventsList(props) {\r\n  const events = props.events\r\n  const device_id = props.device_id\r\n  const handlEventDelete = props.handlEventDelete\r\n  const toggleEventEnable = props.toggleEventEnable\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <table className=\"table table-dark table-sm table-hover mb-0\">\r\n        <thead>\r\n          <tr className='text-secondary'>\r\n            <th className='border-0'>№</th>\r\n            <th className='border-0'>Событие</th>\r\n            <th className='border-0'>Контролируется</th>\r\n            <th className='border-0'>Сейчас активны</th>\r\n            <th className='border-0'>Удалить</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <EventsListEntry events={events} device_id={device_id} handlEventDelete={handlEventDelete} toggleEventEnable={toggleEventEnable}/>\r\n        </tbody>\r\n      </table>\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\n\r\n\r\nfunction EventsListEntry(props) {\r\n  const events = props.events\r\n  const device_id = props.device_id\r\n  const handlEventDelete = props.handlEventDelete\r\n  const toggleEventEnable = props.toggleEventEnable\r\n\r\n  return (\r\n    <React.Fragment>\r\n      { events.map((event, index)=>{\r\n        return ( \r\n          <React.Fragment key={index}> \r\n            <tr> \r\n              <td className='text-secondary py-2'>{index+1}</td>\r\n\r\n              <td className='py-0'>\r\n                  <NavLink to={`/device/${device_id}/admin/events/${event.id}/detail/`} className='btn btn-link w-100 text-left pl-0 py-2 text-light'>\r\n                    {event.raise_message ? event.raise_message : <i className='text-secondary'>Сообщение не задано ...</i>}\r\n                  </NavLink>\r\n              </td>\r\n\r\n              <td>{event.enable ? <button className='btn btn-outline-dark fas fa-check text-success' \r\n                                          onClick={() => toggleEventEnable(event)}\r\n                                  ></button> : \r\n                                  <button className='btn btn-outline-dark fas fa-times text-secondary' \r\n                                          style={{fontSize:'1.3rem'}} \r\n                                          onClick={() => toggleEventEnable(event)}\r\n                                  ></button>}\r\n              </td>\r\n\r\n              <td>{event.is_active ? <i className='fas fa-exclamation-triangle text-warning ml-3 py-2' style={{fontSize:'1.1rem'}}></i> : ''}</td>\r\n\r\n              <td>  <button className='btn btn-outline-dark fas fa-times text-danger' \r\n                            style={{fontSize:'1.2rem'}}\r\n                            onClick={() => handlEventDelete(event.id)}\r\n                    ></button> \r\n              </td>\r\n            </tr> \r\n          </React.Fragment>\r\n        )\r\n        })\r\n      }\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\n\r\n\r\nfunction NoEvents() {\r\n  return <i className='text-secondary '>События отсутствуют ...</i>\r\n}","import React, {useState, useEffect} from 'react' \r\nimport {useHistory, useParams} from 'react-router-dom'\r\n\r\nimport Loader from '../../base/components/Loader'\r\nimport {CheckboxField, SelectField, TextField, FormContainer, getSelectedOptions} from '../../base/forms/forms'\r\n\r\nimport {\r\n  getEventsConfig,\r\n  postEventsConfig,\r\n  deleteEvents,\r\n} from '../../backendAPI/backendAPI'\r\n\r\n\r\nexport default function EventDetailPage() {\r\n  const { event_id, device_id } = useParams();\r\n  const [event, setEvent] = useState({})\r\n  const [eventFormErrors, setEventFromErrors] = useState(null)\r\n  const [loading, setLoading] = React.useState(true)\r\n  const history = useHistory()\r\n\r\n  function submitEventParameters( event ) {\r\n    postEventsConfig(device_id, [event], \r\n      ()=>{ \r\n        setEventFromErrors(null);\r\n        history.push(`/device/${device_id}/admin/events/`); \r\n      },\r\n      (errors_data)=>{ setEventFromErrors(errors_data[0]); }\r\n    )\r\n  }\r\n\r\n  const cancelChanges = () => { \r\n    history.push(`/device/${device_id}/admin/events/`)\r\n  }\r\n\r\n  const deleteEvent = () => { \r\n    deleteEvents(device_id, [event_id], ()=>{\r\n      history.push(`/device/${device_id}/admin/events/`)\r\n    }) \r\n  }\r\n\r\n  useEffect(() => {\r\n    getEventsConfig(device_id, [event_id], (data)=>{\r\n      setEvent(data[0]);\r\n      setLoading(false);\r\n    }) \r\n  }, [])\r\n\r\n  return (\r\n    <React.Fragment>\r\n        <h3 className='mb-3'>Параметры события</h3>\r\n        <div className='p-3 mx-1 my-0 bg-dark rounded text-light' style={{minHeight: 'calc(100vh - 135px)'}}>\r\n        { loading ? \r\n          <div className='d-flex justify-content-center'><Loader /></div> :\r\n          <FormContainer> \r\n            <h5 className='text-info text-center mb-3'>Редактирование параметров события</h5>  \r\n            <EventForm event={event} formErrors={eventFormErrors} onSubmit={submitEventParameters} onCancel={cancelChanges} onDelete={deleteEvent}/>\r\n          </FormContainer>\r\n        }\r\n        </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n\r\n\r\nexport function EventCreatePage() {\r\n  const { device_id } = useParams();\r\n  const defaultEventSettings = { device: device_id, enable: false, category: 'Alarm' }\r\n  const [eventFormErrors, setEventFromErrors] = useState(null)\r\n  const history = useHistory()\r\n\r\n  function submitEventParameters( event ) {\r\n    postEventsConfig(device_id, [event], \r\n      ()=>{ \r\n        setEventFromErrors(null);\r\n        history.push(`/device/${device_id}/admin/events/`); \r\n      },\r\n      (errors_data)=>{ setEventFromErrors(errors_data[0]); }\r\n    )\r\n  }\r\n\r\n  const cancelChanges = () => { \r\n    history.push(`/device/${device_id}/admin/events/`)\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n        <h3 className='mb-3'>Параметры события</h3>\r\n        <div className='p-3 mx-1 my-0 bg-dark rounded text-light' style={{minHeight: 'calc(100vh - 135px)'}}>\r\n          <FormContainer>\r\n            <h5 className='text-info text-center mb-3'>Создание нового события</h5>  \r\n            <EventForm event={defaultEventSettings} formErrors={eventFormErrors} onSubmit={submitEventParameters} onCancel={cancelChanges}/>\r\n          </FormContainer>\r\n        </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n\r\n\r\n// -------------------------------------------------------------------------------------------------------------------\r\nfunction EventForm(props) {\r\n  const [event, setEvent] = useState(props.event)\r\n  const onSubmit = props.onSubmit\r\n  const onCancel = props.onCancel\r\n  const onDelete = props.onDelete\r\n  const buttonsStyle = {minWidth: '150px'}\r\n  let categoriesOptions = [\r\n    {value: 'Alarm',    name:'Аварйное'}, \r\n    {value: 'Warning',  name:'Предупреждение'}, \r\n    {value: 'Info',     name:'Информационное'}, \r\n    {value: 'Debug',    name:'Отладочное'}\r\n  ]\r\n\r\n  const handlSubmit = (e) => { \r\n    e.preventDefault();\r\n    onSubmit(event);\r\n  }\r\n  const handlEnableChange = (e) => { setEvent({...event, enable: e.target.checked}) }\r\n  const handlExpressionChange = (e) => { setEvent({...event, expression: e.target.value}) }\r\n  const handlRaiseMessageChange = (e) => { setEvent({...event, raise_message: e.target.value}) }\r\n  const handlFallMessageChange = (e) => { setEvent({...event, fall_message: e.target.value}) }\r\n  const handlСategoriesChange = (e) => { setEvent({...event, category: getSelectedOptions(e)[0]}) }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <form onSubmit={handlSubmit}>\r\n        <CheckboxField titel={'Активировать контроль события'} id={'enable'} checked={event.enable} onChange={handlEnableChange}\r\n          errors={props.formErrors ? props.formErrors.enable : null}\r\n        />\r\n\r\n        <TextField titel={'Формула'} id={'expression'} placeholder={'...'} value={event.expression} onChange={handlExpressionChange}\r\n          errors={props.formErrors ? props.formErrors.expression : null}\r\n          comment={\r\n            <div>\r\n            <button type='button' className='mt-3 btn btn-sm btn-outline-info' data-toggle=\"collapse\" data-target=\"#expressions_help\">\r\n              Справка <i className='far fa-question-circle'></i>\r\n            </button>\r\n            <p id=\"expressions_help\" className=\"collapse mt-3 border-top border-bottom border-info py-3\">\r\n            В формуле допустимо применение следующих конструкций: <br/>\r\n            - получить текущее значение тега <kbd className='ml-2'>{'{{tag_code}}'}</kbd>  <br/>\r\n            - операторы сравнения\r\n            <kbd className='ml-2' title=\"Равно\">{'=='}</kbd>\r\n            <kbd className='ml-2' title=\"Неравно\">{'!='}</kbd>\r\n            <kbd className='ml-2' title=\"Больше\">{'>'}</kbd>\r\n            <kbd className='ml-2' title=\"Меньше\">{'<'}</kbd>\r\n            <kbd className='ml-2' title=\"Больше или равно\">{'>='}</kbd>\r\n            <kbd className='ml-2' title=\"Меньше или равно\">{'<='}</kbd>\r\n            <br/>\r\n            - арифметические операторы\r\n            <kbd className='ml-2' title=\"Суммирование\">{'+'}</kbd>\r\n            <kbd className='ml-2' title=\"Вычитание\">{'-'}</kbd>\r\n            <kbd className='ml-2' title=\"Деление\">{'/'}</kbd>\r\n            <kbd className='ml-2' title=\"Деление без остатка\">{'//'}</kbd>\r\n            <kbd className='ml-2' title=\"Остаток от деления\">{'%'}</kbd>\r\n            <kbd className='ml-2' title=\"Умножение\">{'*'}</kbd>\r\n            <kbd className='ml-2' title=\"Возведение в степень\">{'**'}</kbd>\r\n            <br/>\r\n            - логические операторы\r\n            <kbd className='ml-2' title=\"Логическое И\">{'and'}</kbd>\r\n            <kbd className='ml-2' title=\"Логическое ИЛИ\">{'or'}</kbd>\r\n            <kbd className='ml-2' title=\"Логическая инверсия\">{'not'}</kbd>\r\n            <br/>\r\n            - битовые операторы\r\n            <kbd className='ml-2' title=\"Битовое И\">{'&'}</kbd>\r\n            <kbd className='ml-2' title=\"Битовое ИЛИ\">{'|'}</kbd>\r\n            <kbd className='ml-2' title=\"Битовое исключающее ИЛИ\">{'^'}</kbd>\r\n            <kbd className='ml-2' title=\"Побитовая инверсия\">{'~'}</kbd>\r\n            <kbd className='ml-2' title=\"Побитовый сдвиг в лево\">{'<<'}</kbd>\r\n            <kbd className='ml-2' title=\"Побитовый сдвиг в право\">{'>>'}</kbd>\r\n            <br/>\r\n            Примеры формул:  <br/>\r\n            - является ли значение тега tag1 больше или равно 12.5 <kbd className='ml-2'>{'{{tag2}} >= 12.5'}</kbd> <br/>\r\n            - получение значения бита №5 тега tag2 <kbd className='ml-2'>{'{{tag2}} >> 5 & 1'}</kbd>  <br/>\r\n            - значение бита №0 тега tag2 или значение бита №14 тега tag3 <kbd className='ml-2'>{'({{tag2}} & 1) or ({{tag3}} >> 14 & 1)'}</kbd> \r\n          </p>\r\n          </div>\r\n          }\r\n        />\r\n\r\n        <TextField titel={'Сообщение срабатывания'} id={'raise_message'} placeholder={'...'} value={event.raise_message} \r\n          onChange={handlRaiseMessageChange}\r\n          errors={props.formErrors ? props.formErrors.raise_message : null}\r\n        />\r\n        <TextField titel={'Сообщение отключения'} id={'fall_message'} placeholder={'...'} value={event.fall_message} \r\n          onChange={handlFallMessageChange}\r\n          errors={props.formErrors ? props.formErrors.fall_message : null}\r\n        />\r\n        <SelectField titel={'Категория'} id={'category'} placeholder={'...'} value={event.category} \r\n          options={categoriesOptions} \r\n          onChange={handlСategoriesChange}\r\n          errors={props.formErrors ? props.formErrors.category : null}\r\n        />\r\n\r\n        <p className='border-top border-secondary'></p>        \r\n        <div className='row'>\r\n          <p className='col-md-6'> Текущее состояние:  \r\n              {event.is_active ? <span className='text-warning'> АКТИВНО </span> : \r\n                                 <span className='text-light'> НЕ АКТИВНО </span>\r\n              } \r\n          </p>\r\n          <p className='col-md-6'> Время последнего срабтывания:  \r\n              {event.raise_time ? <span> {format_time(event.raise_time)} </span>: \r\n                                  <span className='text-secondary'> Никогда </span>\r\n              } \r\n          </p>\r\n        </div>\r\n\r\n        <p className='border-top border-secondary'></p>\r\n        <div className='d-flex flex-wrap justify-content-center'>\r\n          <button type=\"submit\" className=\"btn btn-outline-primary m-2\" style={buttonsStyle}>Сохранить</button>\r\n          <button type=\"button\" className=\"btn btn-outline-secondary m-2\" style={buttonsStyle} onClick={onCancel}>Отмена</button>\r\n          { props.onDelete && <button type=\"button\" className=\"btn btn-outline-danger m-2\" style={buttonsStyle} onClick={onDelete}>Удалить</button> }\r\n        </div>\r\n\r\n      </form>\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\n\r\n\r\nfunction format_time(time, date_style='long', time_style='medium') {\r\n  const s = new Date(time)\r\n  let formatter = new Intl.DateTimeFormat([] , {dateStyle: date_style, timeStyle: time_style});\r\n  return formatter.format(s)\r\n}\r\n\r\n\r\n","import React, {useEffect} from 'react' \r\nimport {Switch, Route, useParams} from 'react-router-dom'\r\n\r\nimport axiosInstance from \"../backendAPI/axiosApi\"\r\nimport getBaseUrl from '../backendAPI/localSettings'\r\nimport sortWidgetsByOrder from './utils/sortWidgetsByOrder'\r\n\r\nimport Sidebar from './components/DeviceSidebar'\r\nimport DeviceOverviewPage from './pages/overview'\r\nimport DeviceSettingsPage from './pages/settings'\r\nimport DeviceEventsLogPage from './pages/eventsLog'\r\nimport DeviceGraphsPage from './pages/graphs'\r\nimport DeviceAdminPage from './pages/deviceAdmin'\r\nimport WidgetsAdminPage from './pages/widgetsAdmin'\r\nimport EventsAdminPage from './pages/eventsAdmin'\r\nimport EventDetailPage, {EventCreatePage} from './pages/eventDetail'\r\nimport Page404 from '../base/pages/pageNotFound'\r\n\r\nconst BASE_URL = getBaseUrl()\r\n\r\n\r\n\r\nexport default function DeviceApp() { \r\n  let { id } = useParams();\r\n  const [widgetsTemplate, setWidgetsTemplate] = React.useState({})\r\n\r\n  useEffect(() => {\r\n    getWidgetsTemplate( id, (data)=> {\r\n      setWidgetsTemplate( sortWidgetsByOrder(data.template) );\r\n    });   \r\n  }, []) \r\n\r\n  function updateWidgetsTemplate(newTemplate){\r\n    setWidgetsTemplate(newTemplate)\r\n    postWidgetsTemplate(id, newTemplate)\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='bg-color-dark-gray text-secondary h-100'>\r\n      <div className=\"row m-0 p-0\">\r\n        <Sidebar deviceId={id}/>\r\n        <div className=\"col-10 m-0 p-0\">\r\n          <div className=\"content-height p-3\">\r\n            <Switch>\r\n              <Route exact path={`/device/:device_id/overview/`} component={()=><DeviceOverviewPage widgetsTemplate={widgetsTemplate}/>} />\r\n              <Route exact path={`/device/:device_id/settings/`} component={()=><DeviceSettingsPage />} />\r\n              <Route exact path={`/device/:device_id/events/`} component={()=><DeviceEventsLogPage />} />\r\n              <Route exact path={`/device/:device_id/graphs/`} component={()=><DeviceGraphsPage />} />\r\n              <Route path={`/device/:device_id/admin/config/`} component={()=><DeviceAdminPage />} />\r\n              <Route exact path={`/device/:device_id/admin/widgets/`} \r\n                component={()=><WidgetsAdminPage updateWidgetsTemplate={updateWidgetsTemplate} widgetsTemplate={widgetsTemplate}/>} \r\n              />\r\n              <Route exact path={`/device/:device_id/admin/events/`} component={()=><EventsAdminPage/>} />\r\n              <Route exact path={`/device/:device_id/admin/events/:event_id/detail/`} component={()=><EventDetailPage/>} />\r\n              <Route exact path={`/device/:device_id/admin/events/create/`} component={()=><EventCreatePage/>} />\r\n              <Route component={Page404} />\r\n            </Switch>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n\r\nasync function getWidgetsTemplate(device_id, cb) {\r\n  const request = await axiosInstance.get(BASE_URL + \"/widgets/template/\", { params: { id: device_id }})\r\n  cb({...request.data});\r\n}\r\n\r\nasync function postWidgetsTemplate(device_id, template_data, cb) {\r\n  const body = {'template': template_data}\r\n  const request = await axiosInstance.post(BASE_URL + \"/widgets/template/\", body, { params: { id: device_id }})\r\n  cb && cb({...request.data});\r\n}\r\n\r\n\r\n","import React from 'react'\r\nimport {NavLink} from 'react-router-dom'\r\n\r\nexport default function Sidebar() {\r\n    return (\r\n        <div className=\"col-2 m-0 p-0\">\r\n        <div className=\"bg-dark bg-color-gray p-2 h-100\">\r\n          <div className=\"p-1\">\r\n\r\n            <div className=\"nav flex-column nav-pills\" style={{overflow: 'hidden'}} id=\"v-pills-tab\" role=\"tablist\" aria-orientation=\"vertical\">\r\n                <NavLink className=\"nav-link text-light btn\" style={{outline: 'none', boxShadow: 'none'}} activeClassName=\"bg-dark\" to=\"/company/overview/\">\r\n                  <div className=\"d-inline-flex w-100 justify-content-center justify-content-lg-start\">\r\n                    <i className='fas fa-home' style={{fontSize:'1.3em'}}></i>\r\n                    <span className='pl-3 d-none d-lg-inline'>Обзор</span>\r\n                  </div>\r\n                </NavLink>\r\n                \r\n                <NavLink className=\"nav-link text-light btn\" style={{outline: 'none', boxShadow: 'none'}} activeClassName=\"bg-dark\" to=\"/company/map/\">\r\n                  <div className=\"d-inline-flex w-100 justify-content-center justify-content-lg-start\">\r\n                    <i className='fas fa-map-marked-alt' style={{fontSize:'1.3em'}}></i>\r\n                    <span className='pl-3 d-none d-lg-inline'>Карта</span>\r\n                  </div> \r\n                </NavLink>\r\n                \r\n                <NavLink className=\"nav-link text-light btn\" style={{outline: 'none', boxShadow: 'none'}} activeClassName=\"bg-dark\" to=\"/company/employers/\">\r\n                  <div className=\"d-inline-flex w-100 justify-content-center justify-content-lg-start\">\r\n                    <i className='fas fa-users' style={{fontSize:'1.3em'}}></i>\r\n                    <span className='pl-3 d-none d-lg-inline'>Сотрудники</span>\r\n                  </div>\r\n                </NavLink>\r\n\r\n                <NavLink className=\"nav-link text-light btn\" style={{outline: 'none', boxShadow: 'none'}} activeClassName=\"bg-dark\" to=\"/company/profile/\"> \r\n                  <div className=\"d-inline-flex w-100 justify-content-center justify-content-lg-start\">\r\n                    <i className='fas fa-chalkboard-teacher' style={{fontSize:'1.3em'}}></i>\r\n                    <span className='pl-3 d-none d-lg-inline'>Кабинет</span>\r\n                  </div>\r\n                </NavLink>\r\n            </div>\r\n            \r\n          </div>\r\n        </div>\r\n        </div>\r\n    )\r\n}","import React, { useEffect } from 'react' \r\nimport {Link} from 'react-router-dom'\r\n\r\nimport axiosInstance from \"../../backendAPI/axiosApi\";\r\nimport getBaseUrl from '../../backendAPI/localSettings'\r\nconst BASE_URL = getBaseUrl()\r\n\r\nfunction DeviceCard(props) {\r\n    const [deviceData, setDeviceData] = React.useState({})\r\n    const device = props.device   \r\n   \r\n    function readDeviceParameters() {\r\n      axiosInstance.get(BASE_URL + \"/device/parameters/\", { params: { id: device.id }} )\r\n        .then(responce => { \r\n            if (responce) {\r\n                const deviceParameters = responce.data\r\n                setDeviceData({...deviceParameters}) \r\n            }\r\n        }) \r\n    }\r\n    \r\n    useEffect(() => {\r\n      readDeviceParameters();\r\n      const deviceParametersUpdateInterval = setInterval(readDeviceParameters, 5000);\r\n      return () => {\r\n        clearInterval(deviceParametersUpdateInterval);\r\n      };\r\n    }, [])\r\n\r\n\r\n    return (\r\n        <React.Fragment>\r\n        <Link className=\"nav-link p-0 m-0\" to={`/device/${device.id}/overview/`}>\r\n            <div className='border border-secondary rounded p-2 h-100 bg-dark text-light card-hover' style={{overflow: 'hidden'}} >\r\n                <h6 className='text-nowrap'>{device.name}</h6>\r\n                <div className='p-0 m-0 small w-100'>\r\n                    <table className=\"table table-sm p-0 m-0 table-dark text-light w-100\">\r\n                        <tbody>\r\n                            <tr>\r\n                                <td> Связь: </td>   \r\n                                <td className='text-right'> {deviceData.is_online ? \r\n                                    <span className='text-light' >ОК</span> : \r\n                                    <span className='badge badge-pill badge-danger text-dark' style={{fontSize: '0.85em'}}>НЕТ</span> }\r\n                                </td>\r\n                            </tr> \r\n                            <tr>\r\n                                <td>  Обновлено: </td>   \r\n                                <td className='text-right'> {deviceData.last_update ? \r\n                                    format_time(deviceData.last_update, (deviceData.is_online ? null : 'text-warning')) :\r\n                                    <span className='text-secondary'>никогда</span> } \r\n                                </td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td>   Аварии: </td>   \r\n                                <td className='text-right'> Нет  </td>\r\n                            </tr>                                                         \r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n            </div>\r\n        </Link>    \r\n        </ React.Fragment> \r\n    )                   \r\n}\r\n\r\n\r\n\r\nfunction format_time (time, className='text-light') {\r\n    const s = new Date(time)\r\n    var yesterday = new Date()\r\n    yesterday = yesterday.setDate(yesterday.getDate() - 1);\r\n    if (s > yesterday) {\r\n        let formatter = new Intl.DateTimeFormat([] , {hour: '2-digit', minute: '2-digit'});\r\n        return <span className={className}>{formatter.format(s)}</span>\r\n    } else {\r\n        let formatter = new Intl.DateTimeFormat([] , {month: \"short\", day: \"numeric\" });\r\n        return <span className={className}>{formatter.format(s)}</span>           \r\n    }\r\n}\r\n\r\n\r\n\r\nexport default DeviceCard\r\n","import React from 'react';\r\n\r\nimport DeviceCard from './DeviceCard'\r\n\r\nfunction FacilityCard(props) {\r\n  const facilityInfo = props.facilityInfo   \r\n  const devices = facilityInfo.devices\r\n\r\n  const mapDeviceCards = (ds) => {\r\n    return ds.map((device, index) => {\r\n      return (\r\n        <div key={device.id} className='col-lg-4 col-md-6 col-sm-12 p-1 m-0 h-100'>\r\n          <DeviceCard device={device} index={index}/>\r\n        </div>\r\n      )\r\n    })\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n    <div className='card bg-dark text-light shadow-sm p-0 m-0'>\r\n      <h6 className='px-2 pt-2 pb-0 m-0'>{facilityInfo.name}</h6>\r\n      <div className='container-fluid h-100 p-1 m-0 row'>\r\n          {devices.length > 0 ? mapDeviceCards(devices) : <p className='text-secondary p-1'>Устройств нет ...</p> }       \r\n      </div>\r\n    </div>    \r\n    </ React.Fragment> \r\n  )                   \r\n}\r\n\r\nexport default FacilityCard","import React, { useEffect, useState } from 'react' \r\n\r\nimport Loader from '../../base/components/Loader'\r\nimport FacilityCard from '../components/FacilityCard'\r\nimport axiosInstance from \"../../backendAPI/axiosApi\";\r\nimport getBaseUrl from '../../backendAPI/localSettings'\r\nconst BASE_URL = getBaseUrl()\r\n\r\n\r\n\r\nexport default function CompanyOverviewPage() {\r\n  const [companyInfo, setCompanyInfo] = useState({})\r\n  const [loading, setLoading] = React.useState(true)\r\n\r\n  useEffect(() => {\r\n    readCompanyInfo( (inf)=> {\r\n      setCompanyInfo(inf);\r\n      setLoading(false);\r\n    });   \r\n  }, [])  \r\n\r\n  return (\r\n    <React.Fragment>\r\n      <h3 className='px-3 pt-3 pb-0'>Предприятие <b>{loading ? null : companyInfo.company.name}</b></h3>\r\n\r\n      <div className='container-fluid py-0 px-2 m-0 row'>\r\n        {loading ? <Loader /> : \r\n          <React.Fragment>\r\n            { companyInfo.facilities.map((facility, index) => {\r\n                return (\r\n                  <div key={facility.id} className='container-fluid px-2 py-0 mx-0 my-2 col-xl-6'>\r\n                    <FacilityCard facilityInfo={facility} index={index}/>\r\n                  </div>\r\n                )\r\n            }) }       \r\n          </React.Fragment>\r\n        }\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n\r\nasync function readCompanyInfo(cb) {\r\n  const request = await axiosInstance.get(BASE_URL + \"/company/info/\")\r\n  cb({...request.data});\r\n}\r\n ","import React from 'react' \r\n\r\n\r\nexport default function EmployersPage() {\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='p-3'>\r\n        <h3>Сотрудники компании</h3>\r\n        <p>Раздел находиться в разработке ... </p>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n","import React from 'react' \r\n\r\n\r\nexport default function FacilitiesOnMapPage() {\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='p-3'>   \r\n        <h3>Объекты компании на карте</h3>\r\n        <p>Раздел находиться в разработке ... </p>\r\n      </div> \r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n ","import React from 'react' \r\n\r\n\r\nexport default function CompanyProfilePage() {\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='p-3'> \r\n        <h3>Кабинет</h3>\r\n        <p>Раздел находиться в разработке ... </p>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n ","import React from 'react' \r\nimport {Switch, Route} from 'react-router-dom'\r\n\r\nimport Sidebar from './components/CompanySidebar'\r\nimport CompanyOverviewPage from './pages/overview'\r\nimport EmployersPage from './pages/employers'\r\nimport FacilitiesOnMapPage from './pages/facilitiesOnMap'\r\nimport CompanyProfilePage from './pages/profile'\r\nimport Page404 from '../base/pages/pageNotFound'\r\n\r\nexport default function CompanyApp() { \r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='bg-color-dark-gray text-secondary h-100'>\r\n      <div className=\"row m-0 p-0\">\r\n        <Sidebar />\r\n        <div className=\"col-10 m-0 p-0\">\r\n          <div className=\"content-height\">\r\n            <Switch>\r\n              <Route exact path='/company' component={CompanyOverviewPage} />\r\n              <Route exact path='/company/overview' component={CompanyOverviewPage} />\r\n              <Route exact path='/company/map' component={FacilitiesOnMapPage} />\r\n              <Route exact path='/company/employers' component={EmployersPage} />\r\n              <Route exact path='/company/profile' component={CompanyProfilePage} />\r\n              <Route component={Page404} />\r\n            </Switch>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n","import React, { Component } from \"react\";\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport auth from '../../backendAPI/auth' \r\n\r\n\r\nclass Login extends Component {\r\n  constructor(props) {\r\n      super(props);\r\n      this.state = {username: \"\", password: \"\"};\r\n\r\n      this.handleChange = this.handleChange.bind(this);\r\n      this.handleSubmit = this.handleSubmit.bind(this);\r\n  }\r\n\r\n  handleChange(event) {\r\n      this.setState({[event.target.name]: event.target.value});\r\n  }\r\n\r\n  handleSubmit(event) {\r\n    event.preventDefault();\r\n    const cb = ()=>{ this.props.history.push('/company/overview/') }\r\n    auth.login(this.state.username, this.state.password, cb );\r\n  }\r\n\r\n  render() {\r\n    return (\r\n    <div className='bg-color-dark-gray text-secondary content-height'>  \r\n      <div className='container card p-3 mt-5 bg-dark' style={{maxWidth: '500px'}}>\r\n        <h2>Вход</h2>\r\n        <form onSubmit={this.handleSubmit}>\r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"username\">Пользователь:</label>\r\n            <input name=\"username\" type=\"text\" className=\"form-control bg-secondary border-secondary text-light\" id=\"username\" value={this.state.username} onChange={this.handleChange}/>\r\n          </div> \r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"pwd\">Пароль:</label> \r\n            <input name=\"password\" type=\"password\" className=\"form-control bg-secondary border-secondary text-light\" id=\"pwd\" value={this.state.password} onChange={this.handleChange}/>\r\n          </div> \r\n          <button type=\"submit\" className=\"btn btn-outline-primary\">Войти</button>\r\n          <div className=\"pt-3\">\r\n            <span className=\"pr-2 text-secondary\">Еще не зарегестрированы?</span>\r\n            <Link className=\"\" to=\"/user/registration/\">Регистрация</Link>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n    )\r\n  }\r\n}\r\nexport default Login;","import React, { Component } from \"react\";\r\nimport {Link} from 'react-router-dom'\r\n\r\nimport axiosInstance from \"../../backendAPI/axiosApi\";\r\n\r\nclass Signup extends Component{\r\n    constructor(props){\r\n        super(props);\r\n        this.state = {\r\n            username: \"\",\r\n            password: \"\",\r\n            email:\"\",\r\n            errors:{username:null, email:null, password:null}\r\n        };\r\n\r\n        this.handleChange = this.handleChange.bind(this);\r\n        this.handleSubmit = this.handleSubmit.bind(this);\r\n    }\r\n\r\n    handleChange(event) {\r\n        this.setState({[event.target.name]: event.target.value});\r\n    }\r\n\r\n    async handleSubmit(event) {\r\n      event.preventDefault();\r\n      try {\r\n          const response = await axiosInstance.post('/user/create/', {\r\n              username: this.state.username,\r\n              email: this.state.email,\r\n              password: this.state.password\r\n          });\r\n          return response;\r\n      } catch (error) {\r\n          console.log(error.stack);\r\n          this.setState({\r\n            errors:error.response.data\r\n          });           \r\n      }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n          <div className='bg-color-dark-gray text-secondary content-height'>  \r\n            <div className='container card p-3 mt-5 bg-dark' style={{maxWidth: '500px'}}>\r\n                <h2>Регистрация</h2>              \r\n                <form onSubmit={this.handleSubmit}>\r\n                  <div className=\"form-group\">\r\n                    <label htmlFor=\"username\">Имя пользователя:</label>\r\n                    <input name=\"username\" type=\"text\" className=\"form-control bg-secondary border-secondary text-light\" id=\"username\" value={this.state.username} onChange={this.handleChange}/>\r\n                    { this.state.errors.username ? <span className='text-danger'>{this.state.errors.username}</span> : null}\r\n                  </div> \r\n                  <div className=\"form-group\">\r\n                    <label htmlFor=\"mail\">Электронная почта:</label>\r\n                    <input name=\"email\" type=\"email\" className=\"form-control bg-secondary border-secondary text-light\" id=\"mail\" value={this.state.email} onChange={this.handleChange}/>\r\n                    { this.state.errors.email ? <span className='text-danger'>{this.state.errors.email}</span> : null}\r\n                  </div> \r\n                  <div className=\"form-group\">\r\n                    <label htmlFor=\"pwd\">Пароль:</label> \r\n                    <input name=\"password\" type=\"password\" className=\"form-control bg-secondary border-secondary text-light\" id=\"pwd\" value={this.state.password} onChange={this.handleChange}/>\r\n                    { this.state.errors.password ? <span className='text-danger'>{this.state.errors.password}</span> : null}\r\n                  </div> \r\n                  <button type=\"submit\" className=\"btn btn-outline-primary\">Подтвердить</button>\r\n                  <div className=\"pt-3\">\r\n                    <span className=\"pr-2 text-secondary\">Уже зарегестрированы?</span>\r\n                    <Link className=\"\" to=\"/user/login/\">Вход</Link>\r\n                  </div>\r\n                </form>\r\n            </div>\r\n          </div>\r\n        )\r\n    }\r\n}\r\nexport default Signup;","import React from 'react' \r\n\r\n\r\nexport default function ProfilePage(props) {\r\n  return (\r\n    <React.Fragment>\r\n    <div className='bg-color-dark-gray text-secondary content-height'> \r\n      <div className='container card bg-dark shadow-sm my-4 pt-4'>\r\n        <h2>Профиль пользователя</h2>\r\n\r\n        <div className='row my-3'>\r\n          <div className='col-lg-6'>\r\n            <table className=\"table text-light tadle-dark \">\r\n              <tbody>\r\n                <tr>\r\n                  <td className='border-secondary'>Пользователь:</td> \r\n                  <td className='border-secondary'><b>{props.userInfo.username}</b></td>\r\n                </tr>\r\n                <tr>\r\n                  <td className='border-secondary'>Имя:</td> \r\n                  <td className='border-secondary'><b>{props.userInfo.first_name}</b></td>\r\n                </tr>\r\n                <tr>\r\n                  <td className='border-secondary'>Фамилия:</td> \r\n                  <td className='border-secondary'><b>{props.userInfo.last_name}</b></td>\r\n                </tr>\r\n                <tr>\r\n                  <td className='border-secondary'>Электронная почта:</td> \r\n                  <td className='border-secondary'><b>{props.userInfo.email}</b></td>\r\n                </tr>            \r\n              </tbody>\r\n            </table>\r\n          </div> \r\n        </div> \r\n      </div>  \r\n    </div>\r\n    </React.Fragment>\r\n);\r\n}\r\n","import React, { Component } from \"react\";\r\nimport {Link, withRouter} from 'react-router-dom'\r\n\r\nimport auth from '../../backendAPI/auth' \r\n\r\nclass LogoutBtn extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.handleLogout = this.handleLogout.bind(this);\r\n    }\r\n\r\n    handleLogout() {\r\n        auth.logout(()=>{\r\n            this.props.history.push('/')\r\n        });\r\n    };\r\n\r\n    render() {\r\n        return (\r\n            <li className=\"nav-item\" >\r\n                <Link className=\"nav-link\" to=\"\" onClick={this.handleLogout}>Выйти</Link>\r\n            </li>\r\n        )\r\n    };\r\n};         \r\n\r\nexport default withRouter(LogoutBtn)","import React from 'react'\r\nimport {Link} from 'react-router-dom'\r\n\r\nimport LogoutBtn from '../../users/components/LogoutBtn'\r\n\r\nexport default function Navbar(props) {\r\n    const authed = props.authed\r\n    const userInfo = props.userInfo\r\n    \r\n    return (\r\n        <nav className=\"navbar navbar-expand-sm bg-dark navbar-dark bg-color-indigo header-height p-0 m-0\">\r\n            <Link className=\"navbar-brand header-height py-2 pl-3 pr-0 m-0\" to=\"/\">WebArm</Link>\r\n\r\n            <button className=\"navbar-toggler header-height border-0 m-0\" style={{outline: 'none', boxShadow: 'none'}} type=\"button\" data-toggle=\"collapse\" data-target=\"#collapsibleNavbar\">\r\n                <span className=\"navbar-toggler-icon\"></span>\r\n            </button>\r\n\r\n            <div className=\"collapse navbar-collapse bg-color-indigo\" id=\"collapsibleNavbar\" style={{zIndex: '1'}}>\r\n                <div className='d-md-none border-top border-secondary'></div>\r\n                <ul className=\"navbar-nav px-3\">\r\n                    {authed ? (\r\n                        <React.Fragment>\r\n                            <li className=\"nav-item\">\r\n                                <Link className=\"nav-link\" to=\"/company/overview\">Предприятие</Link>\r\n                            </li>\r\n                            <li className=\"nav-item\">\r\n                                <Link className=\"nav-link\" to=\"/company/facilities\">Обьекты</Link>\r\n                            </li>\r\n                            <li className=\"nav-item\">\r\n                                <Link className=\"nav-link\" to=\"/company/profile\">Кабинет</Link>\r\n                            </li>\r\n                        </React.Fragment>\r\n                    ) : null }\r\n                </ul>  \r\n        \r\n                <ul className=\"navbar-nav ml-auto px-3\">\r\n                    {authed ? (\r\n                        <React.Fragment>\r\n                            { userInfo ?\r\n                                <React.Fragment> \r\n                                    <li className=\"nav-item\">\r\n                                        <Link className=\"nav-link\" to=\"/user/profile\">{userInfo.username}</Link>\r\n                                    </li>\r\n                                    <li className=\"nav-item border-right border-secondary my-1 d-none d-sm-inline\"> </li>\r\n                                </React.Fragment>                        \r\n                            : null }\r\n                            <LogoutBtn />\r\n                        </React.Fragment>\r\n                    ) : (\r\n                        <li className=\"nav-item\">\r\n                            <Link className=\"nav-link\" to=\"/user/login\">Войти</Link>\r\n                        </li>\r\n                    )}\r\n                </ul> \r\n            </div>\r\n        </nav>       \r\n    );\r\n}","import React from 'react' \r\nimport {Link} from 'react-router-dom'\r\n\r\nimport auth from '../../backendAPI/auth' \r\n\r\n\r\nfunction WelcomePage(props) {\r\n  // const backgroundStyle = {\r\n  //   backgroundImage: 'url(\"./img/grid.png\")',\r\n  //   backgroundRepeat: 'repeat-x',\r\n  //   backgroundAttachment: 'fixed'\r\n  // }\r\n\r\n\r\n  function loginDemoUser() {\r\n    const cb = ()=>{ props.history.push('/company/overview/') }\r\n    auth.login('admin', 'admin', cb );\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='bg-color-dark-gray text-light content-height'>\r\n        <div className='container card mt-5 p-3 w-100' style={{background:'rgba(0,0,0,0.8)'}}>\r\n            <div className='text-center pt-4'>\r\n                <h3>Добро пожаловать на <b>BFCloud</b></h3>\r\n            </div>\r\n            <br/>\r\n            <div className='text-center'>\r\n                <h5>Для начала работы\r\n                  <Link className='px-2' to=\"/user/login/\">Войдите</Link>\r\n                  или\r\n                  <Link className='px-2' to=\"/user/registration/\">Зарегистрируйтесь</Link>\r\n                </h5>\r\n            </div>\r\n\r\n            <div className=\"card-columns py-5\">\r\n              <div className=\"card border-secondary\" style={{background:'none'}}>\r\n                <div className=\"card-body text-center\">\r\n                  <h6>Удаленный мониторинга и управления промышленными и IoT устройствами</h6>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"card border-secondary\" style={{background:'none'}}>\r\n                <div className=\"card-body text-center\">\r\n                  <h6>Контроль аварийных событий и уведомление о событиях на объекте </h6>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"card border-secondary\" style={{background:'none'}}>\r\n                <div className=\"card-body text-center\">\r\n                  <h6>Простое подключение и настройка опроса устройств</h6>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"card border-secondary\" style={{background:'none'}}>\r\n                <div className=\"card-body text-center\">\r\n                  <h6>Открытый API для интеграции с сторонним ПО и \r\n                    IoT устройствами \r\n                  </h6>\r\n                </div>\r\n              </div>  \r\n\r\n              <div className=\"card border-secondary\" style={{background:'none'}}>\r\n                <div className=\"card-body text-center\">\r\n                  <h6>Единый интерфейс для Персональных компьютеров и Мобильных устройств </h6>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"card border-secondary\" style={{background:'none'}}>\r\n                <div className=\"card-body text-center\">\r\n                  <h6> Вы можете воспользоваться демо-версией сервиса \r\n                    <a className=\"px-2\" href='#' onClick={loginDemoUser}>Демо-версия: БУМП-14</a>\r\n                  </h6> \r\n                </div>\r\n              </div>\r\n            </div>            \r\n        </div>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\nexport default WelcomePage","import './App.css'\r\nimport '../node_modules/react-vis/dist/style.css'\r\n\r\nimport React, { useEffect, useState } from 'react' \r\nimport {\r\n  BrowserRouter as Router, \r\n  Switch, \r\n  Route,\r\n} from 'react-router-dom'\r\n\r\nimport {ProtectedRoute} from './utils/protectedRoute'\r\nimport { FullScreen, useFullScreenHandle } from \"react-full-screen\";\r\n\r\nimport DeviceApp from './device/deviceApp'\r\nimport CompanyApp from './company/companyApp'\r\nimport Login from './users/pages/login'\r\nimport Registration from './users/pages/registration'\r\nimport ProfilePage from './users/pages/profile'\r\nimport Navbar from './base/components/Navbar'\r\nimport WelcomePage from './base/pages/welcome'\r\nimport Page404 from './base/pages/pageNotFound'\r\n\r\nimport auth from './backendAPI/auth'\r\n\r\nexport default function App() {\r\n  const [loading, setLoading] = useState(true)\r\n  const [loading2, setLoading2] = useState(true)\r\n  const [authed, setAuthed] = useState(false)\r\n  const [userInfo, setUserInfo] = useState({})\r\n\r\n  const handle = useFullScreenHandle();\r\n\r\n  useEffect(() => {\r\n    auth.checkAuthentication(() => { setLoading(false) })\r\n    auth.onLogin = () => {setAuthed(true)}    \r\n    auth.onLogout = () => {setAuthed(false)}    \r\n    auth.onUserInfoReaded = (ui) => {\r\n      setUserInfo(ui); \r\n      setLoading2(false);\r\n    }   \r\n  }, [])\r\n\r\n  if (loading || loading2) { \r\n    return null \r\n  } else { \r\n    return (\r\n      <React.Fragment>\r\n        <button className='full-screen-button fas fa-expand ' onClick={handle.enter}></button>\r\n        <FullScreen handle={handle}>\r\n          <Router>        \r\n            <Route exact path='/' component={()=>{\r\n              return (\r\n              <video autoplay=\"autoplay\" muted loop=\"loop\" id=\"myVideo\">\r\n                <source src=\"Earth13426.mp4\" type=\"video/mp4\" />\r\n              </video>\r\n              )}\r\n            }/>\r\n\r\n            <Navbar authed={authed} userInfo = {userInfo} />\r\n            <Switch>\r\n              <Route exact path='/' component={WelcomePage} />\r\n              <Route exact path='/user/login' component={Login}  />\r\n              <Route exact path='/user/registration' component={Registration} />\r\n              <ProtectedRoute exact path='/user/profile' component={ ()=> <ProfilePage userInfo = {userInfo} /> } />\r\n              <ProtectedRoute path='/company' component={CompanyApp} />                   \r\n              <ProtectedRoute path='/device/:id' component={DeviceApp} />\r\n              <Route component={Page404} />\r\n            </Switch>\r\n          </Router>\r\n        </FullScreen>\r\n      </React.Fragment>\r\n    )\r\n  }\r\n}\r\n\r\n\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}