{"version":3,"sources":["utils/axiosApi.js","utils/localSettings.js","utils/auth.js","utils/protectedRoute.js","device/utils/sortWidgetsByOrder.js","device/components/DeviceSidebar.js","device/components/DeviceHeader.js","utils/useTargetClick.js","Widgets/components/TagsGraph/Graph.js","Widgets/components/TagsGraph/GraphWithCrosshair.js","Widgets/components/TagsGraph/Legend.js","Widgets/components/TagsGraph/Toolbar.js","base/components/Loader.js","Widgets/components/TagsGraph/TagsHistoricalGraph.js","Widgets/components/TagsGraph/GraphColors.js","Widgets/WidgetGraph.js","Widgets/components/TagsList/TagsCurrentValueRow.js","Widgets/components/TagsList/TagsCurrentValueList.js","Widgets/WidgetTable.js","Widgets/components/TagsIndicator/TagIndicator.js","Widgets/WidgetIndicator.js","Widgets/renderWidgets.js","device/pages/overview.js","device/pages/settings.js","device/pages/eventsLog.js","device/pages/graphs.js","device/pages/deviceAdmin.js","base/forms/forms.js","device/pages/widgetsAdmin.js","base/pages/pageNotFound.js","device/deviceApp.js","company/components/CompanySidebar.js","company/components/DeviceCard.js","company/components/FacilityCard.js","company/pages/overview.js","company/pages/employers.js","company/pages/facilities.js","company/pages/profile.js","company/companyApp.js","users/pages/login.js","users/pages/registration.js","users/pages/profile.js","users/components/LogoutBtn.js","base/components/Navbar.js","base/pages/welcome.js","App.js","reportWebVitals.js","index.js"],"names":["axiosInstance","axios","create","baseURL","timeout","headers","localStorage","getItem","interceptors","response","use","error","originalRequest","config","status","url","Promise","reject","data","code","statusText","refreshToken","tokenParts","JSON","parse","atob","split","now","Math","ceil","Date","console","log","exp","post","refresh","then","setItem","access","defaults","catch","err","this","authenticated","onLogin","onLogout","onUserInfoReaded","cb","get","_onLogin","_onLogout","username","password","removeItem","request","userInfo","readUserInfo","clearUserInfo","ProtectedRoute","Component","component","rest","render","props","auth","isAuthenticated","to","pathname","state","from","location","sortWidgetsByOrder","template","widgets","sort","a","b","KeyA","parseInt","order","KeyB","Sidebar","React","useState","displaySubMenu","setDisplaySubMenu","deviceId","styleBtnRemoveOutline","outline","boxShadow","className","style","overflow","id","role","aria-orientation","activeClassName","fontSize","onClick","Fragment","DeviceHeader","deviceData","setDeviceData","device_id","readDeviceParameters","BASE_URL","params","responce","useEffect","deviceParametersUpdateInterval","setInterval","clearInterval","name","is_online","verbose_last_update","useTargetClick","ref","callback","handleClick","e","current","contains","target","document","addEventListener","removeEventListener","Graph","displayedTags","tags","filter","tag","disabled","resetZoomButton","lastDrawLocation","setLastDrawLocation","replace","has_displayed_tags","map","values","length","margin","left","right","top","bottom","xType","animation","xDomain","yDomain","yPadding","stroke","line","tickTotal","color","curve_color","tag_id","onBrushEnd","area","onDrag","setState","dontCheckIfEmpty","x","y","crosshairValues","setCrosshairValues","crosshairData","value","title","tag_name","_onNearestX","index","d","onMouseLeave","onNearestX","point","size","backgroundColor","background","colSpan","time","s","Intl","DateTimeFormat","dateStyle","timeStyle","format","format_time","paddingTop","Legend","searchText","setSearchText","items","height","onSearchChange","searchPlaceholder","onItemClick","item","Toolbar","showRangeForm","setShowRangeForm","activeButton","setActiveButton","changeGraphInterval","toggleActiveButton","btn","getActiveCalss","type","RangeForm","Loader","TagsHistoricalGraph","setModal","crosshair","setCrosshair","graphCard","useRef","graphContainer","modalButton","crosshairButton","legendContainer","tagsHistory","GRAPH_HEIGH","toggleModal","cl","includes","legend","toggleCroshair","width","textDecoration","loading","GraphWithCrosshair","toggleCurveDisplay","toolbar","colors","getColor","clorsNumber","WidgetGraph","setLoading","interval","resolution","widget","graphInterval","setGraphInterval","setTagsHistory","readTagsHistory","prepared_tags","tag_code","add_date","prev","fltr","entry","updateTagsHistory","loadingTimeout","setTimeout","graphUpdateInterval","clearTimeout","n","TagsCurrentValueRow","TagsCurrentValueList","WidgetTable","setTags","readDeviceTags","tagsUpdateInterval","TagIndicator","addTextRight","addTextLeft","precision","toFixed","WidgetIndicator","RenderWidgets","widgetsTemplate","WidgetRender","min","DeviceOverviewPage","DeviceSettingsPage","DeviceEventsLogPage","WidgetsTemplate","DeviceAdminPage","TextField","htmlFor","titel","placeholder","defaultValue","onChange","comment","NumberField","max","SelectField","selected","hidden","options","option","MultipleSelectField","multiple","CheckboxField","checked","WidgetsAdminPage","updateWidgetsTemplate","setWidgetsTemplate","selectedWidget","setSelectedWidget","displayWidget","setDisplayWidget","rerenderWidgetForm","addWidgetToTemplate","push","minHeight","WidgetsGrid","changeSelectedWidget","widgetNumber","WidgetsControlPanel","addWidget","DefaultTable","DefaultGraph","DefaultIndicator","saveWidgetsTemplate","cancelChanges","WidgetForm","updateWidget","WidgetData","wt","w","deleteWidget","splice","content","btnAddClass","maxWidth","WidgetPreview","show","setShow","handleClose","ModalSelectWidgetType","handleAddWidget","WTableForm","WGraphForm","WIndicatorForm","FormContainer","children","WidgetTypeButton","tagsOptions","getSelectedOptions","fields","i","l","Page404","DeviceApp","useParams","newTemplate","postWidgetsTemplate","getWidgetsTemplate","exact","path","template_data","body","yesterday","setDate","getDate","formatter","hour","minute","month","day","DeviceCard","device","deviceParameters","last_update","FacilityCard","ds","facilityInfo","devices","CompanyOverviewPage","companyInfo","setCompanyInfo","readCompanyInfo","inf","company","facilities","facility","EmployersPage","FacilitiesPage","CompanyProfilePage","CompanyApp","Login","handleChange","bind","handleSubmit","event","preventDefault","login","history","onSubmit","Signup","email","errors","stack","ProfilePage","first_name","last_name","LogoutBtn","handleLogout","logout","withRouter","Navbar","authed","data-toggle","data-target","zIndex","WelcomePage","href","App","loading2","setLoading2","setAuthed","setUserInfo","handle","useFullScreenHandle","checkAuthentication","ui","enter","autoplay","muted","loop","src","Registration","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.967ebf14.chunk.js","sourcesContent":["import axios from 'axios'\r\n\r\nimport getBaseUrl from './localSettings'\r\nconst baseURL = getBaseUrl();\r\n\r\nconst axiosInstance = axios.create({\r\n    baseURL: baseURL,\r\n    timeout: 60000,\r\n    headers: {\r\n        'Authorization': \"JWT \" + localStorage.getItem('access_token'),\r\n        'Content-Type': 'application/json',\r\n        'accept': 'application/json'\r\n    }\r\n});\r\n\r\n\r\naxiosInstance.interceptors.response.use(\r\n    response => response,\r\n    error => {\r\n        const originalRequest = error.config;\r\n\r\n        // Prevent infinite loops\r\n        if (error.response.status === 401 && originalRequest.url === '/user/token/refresh/') {\r\n            // window.location.href = '/user/login/';                  \r\n            return Promise.reject(error);\r\n        }\r\n\r\n        if (error.response.data.code === \"token_not_valid\" &&\r\n            error.response.status === 401 && \r\n            error.response.statusText === \"Unauthorized\") \r\n            {\r\n                const refreshToken = localStorage.getItem('refresh_token');\r\n\r\n                if (refreshToken){\r\n                    const tokenParts = JSON.parse(atob(refreshToken.split('.')[1]));\r\n\r\n                    // exp date in token is expressed in seconds, while now() returns milliseconds:\r\n                    const now = Math.ceil(Date.now() / 1000);\r\n                    console.log(tokenParts.exp);\r\n\r\n                    if (tokenParts.exp > now) {\r\n                        return axiosInstance\r\n                        .post('/user/token/refresh/', {refresh: refreshToken})\r\n                        .then((response) => {\r\n            \r\n                            localStorage.setItem('access_token', response.data.access);\r\n                            localStorage.setItem('refresh_token', response.data.refresh);\r\n            \r\n                            axiosInstance.defaults.headers['Authorization'] = \"JWT \" + response.data.access;\r\n                            originalRequest.headers['Authorization'] = \"JWT \" + response.data.access;\r\n            \r\n                            return axiosInstance(originalRequest);\r\n                        })\r\n                        .catch(err => {\r\n                            console.log(err)\r\n                        });\r\n                    }else{\r\n                        console.log(\"Refresh token is expired\", tokenParts.exp, now);\r\n                        // window.location.href = 'user/login/';\r\n                    }\r\n                }else{\r\n                    console.log(\"Refresh token not available.\")\r\n                    // window.location.href = 'user/login/';\r\n                }\r\n        }\r\n      \r\n     \r\n      // specific error handling done elsewhere\r\n      return Promise.reject(error);\r\n  }\r\n);\r\n\r\n\r\nexport default axiosInstance","\r\n\r\nexport default function getBaseUrl(){\r\n    return \"http://bfcloud.space\"\r\n    // return \"http://localhost:8000\"\r\n}","import axiosInstance from \"./axiosApi\";\r\n\r\nclass Auth{\r\n    constructor() {\r\n        this.authenticated = false;\r\n        this.onLogin = ()=>{};\r\n        this.onLogout = ()=>{};\r\n        this.onUserInfoReaded = ()=>{};\r\n    }\r\n\r\n    async checkAuthentication (cb) {\r\n        try {\r\n            const response = await axiosInstance.get('/user/token/check/')\r\n            if (response) {\r\n                this._onLogin();\r\n            } else {\r\n                this._onLogout();\r\n            }\r\n        } catch (error) {\r\n            this._onLogout();\r\n        }    \r\n        cb();         \r\n    }\r\n\r\n    async login(username, password, cb) {\r\n        try {\r\n            const response = await axiosInstance.post('/user/token/obtain/', {\r\n              username: username,\r\n              password: password\r\n            });\r\n            axiosInstance.defaults.headers['Authorization'] = \"JWT \" + response.data.access;\r\n            localStorage.setItem('access_token', response.data.access);\r\n            localStorage.setItem('refresh_token', response.data.refresh);\r\n            this._onLogin();\r\n            cb();\r\n        } catch (error) {\r\n            throw error;\r\n        }\r\n    }\r\n\r\n    async logout(cb) {\r\n        try {\r\n            await axiosInstance.post('user/token/blacklist/', {\r\n                \"refresh_token\": localStorage.getItem(\"refresh_token\")\r\n            });\r\n            localStorage.removeItem('access_token');\r\n            localStorage.removeItem('refresh_token');\r\n            axiosInstance.defaults.headers['Authorization'] = null;\r\n        } catch (error) {\r\n            console.log(error);\r\n        }\r\n        this._onLogout();\r\n        cb();        \r\n    }\r\n\r\n    isAuthenticated() {\r\n        return this.authenticated;\r\n    }\r\n\r\n    async readUserInfo(){\r\n        const request = await axiosInstance.get('/user/info/')\r\n        this.onUserInfoReaded( { ...request.data } )\r\n    }\r\n\r\n    clearUserInfo(){\r\n        this.userInfo = {}\r\n        this.onUserInfoReaded( {} )\r\n    }\r\n\r\n    _onLogin () {\r\n        this.authenticated = true;\r\n        this.onLogin();\r\n        this.readUserInfo();\r\n    }\r\n    _onLogout () {\r\n        this.authenticated = false;\r\n        this.onLogout();\r\n        this.clearUserInfo();        \r\n    }\r\n}\r\n\r\nexport default new Auth()","import React from 'react' \r\nimport {Route, Redirect} from 'react-router-dom'\r\n\r\nimport auth from './auth' \r\n\r\n\r\n\r\nexport const ProtectedRoute = ({component: Component, ...rest}) => {\r\n  return (\r\n    <Route\r\n      {...rest}\r\n      render={(props) => {\r\n        if (auth.isAuthenticated()) {\r\n          return <Component {...props} />\r\n        } else {\r\n          return <Redirect to={{pathname: '/user/login', state: {from: props.location}}} />\r\n        }\r\n      }}\r\n    />\r\n  )\r\n}","\r\n\r\nexport default function sortWidgetsByOrder(template) {\r\n    var widgets = template.widgets\r\n    if (!widgets) {return {'widgets':[]}}\r\n\r\n\r\n    widgets.sort( (a, b) => {\r\n        var KeyA = parseInt(a.order)\r\n        var KeyB = parseInt(b.order)\r\n        if (KeyA < KeyB) return -1;\r\n        if (KeyA > KeyB) return 1;\r\n        return 0;\r\n      });\r\n\r\n\r\n    return {'widgets':widgets}\r\n}","import React from 'react'\r\nimport {NavLink} from 'react-router-dom'\r\n\r\nexport default function Sidebar(props) {\r\n  const [displaySubMenu, setDisplaySubMenu] = React.useState(false)\r\n  const {deviceId} = props\r\n\r\n  const styleBtnRemoveOutline = {outline: 'none', boxShadow: 'none'}\r\n\r\n  return (\r\n    <div className=\"col-2 m-0 p-0\">\r\n      <div className=\"bg-dark bg-color-gray p-2 h-100\">\r\n        <div className=\"p-1\">\r\n\r\n          <div className=\"nav flex-column nav-pills\" style={{overflow: 'hidden'}} id=\"v-pills-tab\" role=\"tablist\" aria-orientation=\"vertical\">\r\n              <NavLink className=\"nav-link text-light btn\" style={styleBtnRemoveOutline} activeClassName=\"bg-dark\" to={`/device/${deviceId}/overview/`}>\r\n                <div className=\"d-inline-flex w-100 justify-content-center justify-content-lg-start\">\r\n                  <i className='fas fa-home' style={{fontSize:'1.3em'}}></i>\r\n                  <span className='pl-3 d-none d-lg-inline text-left'>Обзор</span>\r\n                </div>\r\n              </NavLink>\r\n              <NavLink className=\"nav-link text-light btn\" style={styleBtnRemoveOutline} activeClassName=\"bg-dark\" to={`/device/${deviceId}/settings/`}>\r\n                <div className=\"d-inline-flex w-100 justify-content-center justify-content-lg-start \">\r\n                  <i className='far fa-edit' style={{fontSize:'1.3em'}}></i>\r\n                  <span className='pl-3 d-none d-lg-inline text-left'>Настройки</span>\r\n                </div> \r\n              </NavLink>\r\n              <NavLink className=\"nav-link text-light btn\" style={styleBtnRemoveOutline} activeClassName=\"bg-dark\" to={`/device/${deviceId}/graphs/`}>\r\n                <div className=\"d-inline-flex w-100 justify-content-center justify-content-lg-start\">\r\n                  <i className='far fa-chart-bar' style={{fontSize:'1.3em'}}></i>\r\n                  <span className='pl-3 d-none d-lg-inline text-left'>Графики</span>\r\n                </div>\r\n              </NavLink>\r\n              <NavLink className=\"nav-link text-light btn\" style={styleBtnRemoveOutline} activeClassName=\"bg-dark\" to={`/device/${deviceId}/events/`}> \r\n                <div className=\"d-inline-flex w-100 justify-content-center justify-content-lg-start\">\r\n                  <i className='far fa-bell' style={{fontSize:'1.3em'}}></i>\r\n                  <span className='pl-3 d-none d-lg-inline text-left'>Журнал</span>\r\n                </div>\r\n              </NavLink>\r\n            </div>\r\n\r\n\r\n            <div className=\"nav flex-column nav-pills\" style={{overflow: 'hidden'}} >              \r\n              <div className='border-top mt-3 pt-3 border-secondary'></div>\r\n              <button className=\"nav-link text-light btn\" style={styleBtnRemoveOutline} onClick={()=>{setDisplaySubMenu(!displaySubMenu)}}>\r\n                <div className=\"d-inline-flex w-100 justify-content-center justify-content-lg-start\">\r\n                  <i className='\tfas fa-list py-1' style={{fontSize:'1.3em'}}></i>\r\n                  <span className='pl-3 d-none d-lg-inline text-left'>Администрирование</span>\r\n                  <i className='fas fa-caret-down py-1 pl-1 ml-auto d-none d-lg-inline' ></i>\r\n                </div>\r\n              </button>\r\n\r\n              {displaySubMenu && <React.Fragment>\r\n                <NavLink className=\"nav-link text-light btn\" style={styleBtnRemoveOutline} activeClassName=\"bg-dark\" to={`/device/${deviceId}/admin/config/`}> \r\n                  <div className=\"d-inline-flex w-100 justify-content-center justify-content-lg-start\">\r\n                    <i className='fas fa-circle px-1 pt-2' style={{fontSize:'0.6em'}}></i>\r\n                    <span className='pl-3 d-none d-lg-inline text-left'>Прибор</span>\r\n                  </div>\r\n                </NavLink>\r\n\r\n                <NavLink className=\"nav-link text-light btn\" style={styleBtnRemoveOutline} activeClassName=\"bg-dark\" to={`/device/${deviceId}/admin/widgets/`}> \r\n                  <div className=\"d-inline-flex w-100 justify-content-center justify-content-lg-start\">\r\n                    <i className='fas fa-circle px-1 pt-2' style={{fontSize:'0.6em'}}></i>\r\n                    <span className='pl-3 d-none d-lg-inline text-left'>Виджеты</span>\r\n                  </div>\r\n                </NavLink>\r\n              </React.Fragment> }\r\n          </div>\r\n          \r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}","import React, { useEffect } from 'react' \r\n\r\nimport axiosInstance from \"../../utils/axiosApi\";\r\nimport getBaseUrl from '../../utils/localSettings'\r\nconst BASE_URL = getBaseUrl()\r\n\r\n\r\n\r\nexport default function DeviceHeader(props) {\r\n  const [deviceData, setDeviceData] = React.useState({})\r\n  const device_id = props.device_id;\r\n\r\n  function readDeviceParameters() {\r\n    axiosInstance.get(BASE_URL + \"/device/parameters/\", { params: { id: device_id }} )\r\n      .then(responce => { \r\n        responce && setDeviceData({...responce.data}) \r\n      }) \r\n  }\r\n  \r\n  useEffect(() => {\r\n    readDeviceParameters();\r\n    const deviceParametersUpdateInterval = setInterval(readDeviceParameters, 5000);\r\n    return () => {\r\n      clearInterval(deviceParametersUpdateInterval);\r\n    };\r\n  }, [])\r\n\r\n  \r\n  // render the page\r\n  return (\r\n    <React.Fragment>\r\n      <div className='d-flex border rounded border-dark px-3 mb-1 mx-1'>\r\n        <h3 className='pt-1'>Устройство: <b>{deviceData.name}</b></h3>\r\n        <div className='ml-auto mx-3 px-3 border-x border-dark'>\r\n          { deviceData.is_online ? \r\n            <div className='text-success'>\r\n              <span>Онлайн</span> <br/>\r\n              <i className='fas fa-check text-center w-100'></i>\r\n            </div>\r\n          : <div className='text-danger'>\r\n              <span>Нет связи</span> <br/>\r\n              <i className='fas fa-times text-center w-100'></i>\r\n            </div>\r\n          }\r\n        </div>\r\n        <div>\r\n          <p className='m-0 mr-1 text-right'>Данные обновлены: <br/> {deviceData.verbose_last_update}</p>\r\n        </div>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n","import { useEffect } from \"react\";\r\n\r\nconst useTargetClick = (ref, callback) => {\r\n  const handleClick = e => {\r\n    if (ref.current && ref.current.contains(e.target)) {\r\n      callback();\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    document.addEventListener(\"click\", handleClick);\r\n\r\n    return () => {\r\n      document.removeEventListener(\"click\", handleClick);\r\n    };\r\n  });\r\n};\r\n\r\nexport default useTargetClick;","import React, {useEffect} from 'react';\r\nimport PropTypes from 'prop-types'\r\nimport {\r\n    FlexibleXYPlot, \r\n    XAxis, \r\n    YAxis, \r\n    LineSeries,\r\n    // VerticalGridLines, \r\n    HorizontalGridLines, \r\n    Highlight} from 'react-vis';\r\n\r\nimport useTargetClick from '../../../utils/useTargetClick'\r\n\r\n\r\nfunction Graph(props) {\r\n  const tags = props.tags \r\n  const displayedTags = tags.filter( tag => tag.disabled === false )\r\n  const resetZoomButton = props.resetZoomButton\r\n  const [lastDrawLocation, setLastDrawLocation] = React.useState(null)\r\n\r\n  useTargetClick(resetZoomButton, ()=>{\r\n    console.log('seted onclick')\r\n    setLastDrawLocation(null)\r\n  })\r\n\r\n  useEffect(() => {\r\n    if (lastDrawLocation) {\r\n      resetZoomButton.current.className = resetZoomButton.current.className.replace('d-none', 'd-block')\r\n    } else {\r\n      resetZoomButton.current.className = resetZoomButton.current.className.replace('d-block', 'd-none')\r\n    }\r\n  }, [lastDrawLocation])\r\n\r\n  \r\n  let has_displayed_tags = false\r\n  displayedTags.map( (tag) => {\r\n    if (tag.values.length > 0) {has_displayed_tags = true}\r\n  })\r\n\r\n  if (has_displayed_tags) {\r\n    return (\r\n      <React.Fragment>\r\n        <div className='graph-container h-100' style={{overflow: 'hidden'}}>\r\n          <FlexibleXYPlot \r\n            margin={{left: 40, right: 0, top: 0, bottom: 30}} \r\n            xType=\"time\"\r\n            animation\r\n            xDomain={\r\n              lastDrawLocation && [\r\n                lastDrawLocation.left,\r\n                lastDrawLocation.right\r\n              ]\r\n            }\r\n            yDomain={\r\n              lastDrawLocation && [\r\n                lastDrawLocation.bottom,\r\n                lastDrawLocation.top\r\n              ]\r\n            }\r\n            yPadding={10} \r\n          >\r\n            <HorizontalGridLines style={{stroke: '#444A50'}} />\r\n            <XAxis style={{line:{stroke: '#6c757d'}}} tickTotal={15} />\r\n            <YAxis style={{line:{stroke: '#6c757d'}}} />\r\n            { displayedTags.map((tag)=>{ \r\n              return <LineSeries data={tag.values} color={tag.curve_color} key={tag.tag_id} />\r\n            }) }\r\n\r\n            <Highlight\r\n              onBrushEnd={area => setLastDrawLocation(area)}\r\n              onDrag={area => {\r\n                this.setState({\r\n                  lastDrawLocation: {\r\n                    bottom: lastDrawLocation.bottom + (area.top - area.bottom),\r\n                    left: lastDrawLocation.left - (area.right - area.left),\r\n                    right: lastDrawLocation.right - (area.right - area.left),\r\n                    top: lastDrawLocation.top + (area.top - area.bottom)\r\n                  }\r\n                });\r\n                }}\r\n              />\r\n          </FlexibleXYPlot>\r\n        </div>\r\n      </ React.Fragment>\r\n    );\r\n  } else {\r\n    return (\r\n      <React.Fragment>\r\n      <div className='graph-container h-100'>\r\n        <FlexibleXYPlot \r\n          dontCheckIfEmpty\r\n          margin={{left: 30, right: 0, top: 0, bottom: 30}}      \r\n        >\r\n          <HorizontalGridLines style={{stroke: '#444A50'}} />\r\n          <XAxis />\r\n          <YAxis />\r\n          <LineSeries data={[{x:0, y:0}]} /> \r\n        </FlexibleXYPlot>\r\n      </div>\r\n      </ React.Fragment> \r\n    )                   \r\n  }\r\n}\r\n\r\n\r\nGraph.propTypes = {\r\n    tags: PropTypes.arrayOf(PropTypes.object).isRequired\r\n}\r\n\r\nexport default Graph","import React, {useEffect} from 'react';\r\nimport PropTypes from 'prop-types'\r\nimport {\r\n    FlexibleXYPlot, \r\n    XAxis, \r\n    YAxis, \r\n    LineSeries,\r\n    MarkSeries,\r\n    Crosshair,\r\n    // VerticalGridLines, \r\n    HorizontalGridLines, \r\n    Highlight} from 'react-vis';\r\n\r\nimport useTargetClick from '../../../utils/useTargetClick'\r\n\r\n\r\n\r\nfunction Graph(props) {\r\n  const tags = props.tags   \r\n  const displayedTags = tags.filter( tag => tag.disabled === false )  \r\n  const resetZoomButton = props.resetZoomButton\r\n  const [lastDrawLocation, setLastDrawLocation] = React.useState(null)\r\n  const [crosshairValues, setCrosshairValues] = React.useState([])\r\n\r\n  useTargetClick(resetZoomButton, ()=>{\r\n    console.log('seted onclick')\r\n    setLastDrawLocation(null)\r\n  })\r\n\r\n  useEffect(() => {\r\n    if (lastDrawLocation) {\r\n      resetZoomButton.current.className = resetZoomButton.current.className.replace('d-none', 'd-block')\r\n    } else {\r\n      resetZoomButton.current.className = resetZoomButton.current.className.replace('d-block', 'd-none')\r\n    }\r\n  }, [lastDrawLocation])\r\n\r\n\r\n  const crosshairData = displayedTags.map( (tag) => {\r\n    return tag.values.map((value) => {\r\n      value.title = tag.tag_name\r\n      value.color = tag.curve_color\r\n      return value\r\n    })\r\n  });  \r\n\r\n  const _onMouseLeave = () => {\r\n    setCrosshairValues([]);\r\n  };\r\n\r\n  const _onNearestX = (value, {index}) => {\r\n    setCrosshairValues( crosshairData.map(d => d[index]) );\r\n  };\r\n\r\n  function format_time(time) {\r\n    const s = new Date(time)\r\n    let formatter = new Intl.DateTimeFormat([] , {dateStyle: 'long', timeStyle: 'medium'});\r\n    return formatter.format(s)\r\n  }\r\n\r\n  let has_displayed_tags = false\r\n  displayedTags.map( (tag) => {\r\n    if (tag.values.length > 0) {has_displayed_tags = true}\r\n  })\r\n\r\n  if (has_displayed_tags) {\r\n    return (\r\n      <React.Fragment>\r\n        <div className='graph-container  h-100' style={{overflow: 'hidden'}}>\r\n          <FlexibleXYPlot \r\n            margin={{left: 40, right: 0, top: 0, bottom: 30}} \r\n            xType=\"time\"\r\n            animation\r\n            xDomain={\r\n              lastDrawLocation && [\r\n                lastDrawLocation.left,\r\n                lastDrawLocation.right\r\n              ]\r\n            }\r\n            yDomain={\r\n              lastDrawLocation && [\r\n                lastDrawLocation.bottom,\r\n                lastDrawLocation.top\r\n              ]\r\n            } \r\n            yPadding={10}\r\n            onMouseLeave={_onMouseLeave}        \r\n          >\r\n            <HorizontalGridLines style={{stroke: '#444A50'}} />\r\n            <XAxis style={{line:{stroke: '#6c757d'}}} tickTotal={15} />\r\n            <YAxis style={{line:{stroke: '#6c757d'}}} />\r\n            { displayedTags.map((tag, index)=>{\r\n              if (index === 0) {\r\n                return <LineSeries onNearestX={_onNearestX} data={tag.values} color={tag.curve_color} key={tag.tag_id} />\r\n              }\r\n              else {\r\n                return <LineSeries data={tag.values} color={tag.curve_color} key={tag.tag_id} />\r\n              }\r\n            }) }\r\n\r\n            <Highlight\r\n              onBrushEnd={area => setLastDrawLocation(area)}\r\n              onDrag={area => {\r\n                setLastDrawLocation({\r\n                  lastDrawLocation: {\r\n                    bottom: lastDrawLocation.bottom + (area.top - area.bottom),\r\n                    left: lastDrawLocation.left - (area.right - area.left),\r\n                    right: lastDrawLocation.right - (area.right - area.left),\r\n                    top: lastDrawLocation.top + (area.top - area.bottom)\r\n                  }\r\n                });\r\n              }}\r\n            />\r\n\r\n            {crosshairValues[0] && \r\n              crosshairValues.map((point, index)=>{\r\n                return point ? (\r\n                          <MarkSeries\r\n                            key = {index}\r\n                            color = {point.color}\r\n                            size = '5'\r\n                            data={[point]}/>\r\n                        ) : null \r\n            })}\r\n\r\n            <Crosshair values={crosshairValues} style={{line:{backgroundColor:'red'}}}>  \r\n              {crosshairValues[0] && \r\n                <div className='rounded p-1 mx-2' style={{background: 'rgba(37, 37, 38, 1)'}}>\r\n                  <table className=\"table text-light p-0 m-0\">\r\n                    <thead> \r\n                    <tr>\r\n                        <td colSpan=\"3\" style={{fontSize: '1.2em', color: 'rgb(180, 180, 180)'}} \r\n                          className='border-0 font-weight-bold p-1 m-0 text-center text-nowrap'\r\n                        >\r\n                          {format_time(crosshairValues[0].x)}\r\n                        </td>\r\n                    </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                      { crosshairValues.map((point, index)=>{\r\n                        return point ? (\r\n                          <tr style={{fontSize: '1.1em', color: 'rgb(210, 210, 210)'}} key={index}>\r\n                            <td style={{color: point.color, paddingTop: '4px'}} className='text-nowrap border-0 px-1 pb-0 m-0\tfas fa-minus'></td>   \r\n                            <td className='text-nowrap border-0 pl-1 pr-2 py-0 m-0'> {point.title}: </td>   \r\n                            <td className='text-nowrap border-0 px-1 py-0 m-0 font-weight-bold  text-right'> {point.y} </td>\r\n                          </tr> \r\n                        ) : null\r\n                      })}\r\n                    </tbody>\r\n                  </table>\r\n                </div>\r\n              }\r\n            </Crosshair>\r\n          </FlexibleXYPlot>\r\n        </div>\r\n      </ React.Fragment>\r\n    );  \r\n  } else {\r\n    return (\r\n      <React.Fragment>\r\n      <div className='graph-container h-100'>\r\n        <FlexibleXYPlot \r\n          dontCheckIfEmpty\r\n          margin={{left: 30, right: 0, top: 0, bottom: 30}}      \r\n        >\r\n          <HorizontalGridLines style={{stroke: '#444A50'}} />\r\n          <XAxis />\r\n          <YAxis />\r\n          <LineSeries data={[{x:0, y:0}]} /> \r\n        </FlexibleXYPlot>\r\n      </div>\r\n      </ React.Fragment> \r\n    )                   \r\n  }\r\n}\r\n\r\n\r\nGraph.propTypes = {\r\n    tags: PropTypes.arrayOf(PropTypes.object).isRequired\r\n}\r\n\r\nexport default Graph","import React from 'react' \r\nimport SearchableDiscreteColorLegend from 'react-vis/dist/legends/searchable-discrete-color-legend';\r\n\r\n\r\n\r\n\r\nexport default function Legend(props) { \r\n  var [searchText, setSearchText] = React.useState('')\r\n\r\n  var state = {\r\n    onClick: props.onClick,\r\n    items: props.tags.map((tag) => {\r\n      return {title: tag.tag_name, color: tag.curve_color, tag_id:tag.tag_id, disabled:tag.disabled}\r\n    })\r\n  }\r\n\r\n  function _clickHandler (item) {\r\n    state.onClick(item.tag_id);    \r\n  };\r\n\r\n  function _searchChangeHandler (searchText) {\r\n    setSearchText(searchText)\r\n  };\r\n\r\n  return (\r\n    <div className='d-block text-dark pl-3'>\r\n      <SearchableDiscreteColorLegend\r\n        height={ parseInt(props.height.replace('px', '')) }\r\n        // width={300}\r\n        onSearchChange={_searchChangeHandler}\r\n        searchPlaceholder={'Поиск...'}\r\n        searchText={searchText}\r\n        onItemClick={_clickHandler}\r\n        items={state.items}\r\n      />\r\n    </div>\r\n  );\r\n}","import React, { useState } from 'react' \r\n\r\n\r\n\r\nexport default function Toolbar(props) { \r\n  const [showRangeForm, setShowRangeForm] = useState(false)\r\n  const [activeButton, setActiveButton] = useState([false, true, false, false, false, false, false, false])\r\n  const changeGraphInterval = props.changeGraphInterval\r\n\r\n  function toggleActiveButton(btn) {\r\n    // enable selected button and off all other\r\n    const b = activeButton.map( (item, index) => {\r\n      return (index === btn) ? true : false\r\n    })\r\n    setActiveButton(b)\r\n    // display form for range input \r\n    setShowRangeForm( (btn === 7) ? true : false ) \r\n  }\r\n\r\n  function getActiveCalss(btn) {\r\n    return activeButton[btn] ? ' active' : ''\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n    <div className='d-flex justify-content-left p-0 pt-2 m-0'>\r\n        <button type=\"button\" \r\n          className={'btn btn-sm btn-outline-secondary mx-1 ' + getActiveCalss(0)} \r\n          onClick={()=>{\r\n            toggleActiveButton(0)\r\n            changeGraphInterval('5m', 'all')\r\n          }}\r\n        >онлайн</button>\r\n\r\n        <button type=\"button\" \r\n          className={'btn btn-sm btn-outline-secondary mx-1 ' + getActiveCalss(1)} \r\n          onClick={()=>{\r\n            toggleActiveButton(1)\r\n            changeGraphInterval('1h', '1m')\r\n          }}\r\n        >1 час</button>\r\n\r\n        <button type=\"button\" \r\n          className={'btn btn-sm btn-outline-secondary mx-1 ' + getActiveCalss(2)} \r\n          onClick={()=>{\r\n            toggleActiveButton(2)\r\n            changeGraphInterval('6h', '5m')\r\n          }}\r\n        >6 часов</button>\r\n\r\n        <button type=\"button\" \r\n          className={'btn btn-sm btn-outline-secondary mx-1 ' + getActiveCalss(3)} \r\n          onClick={()=>{\r\n            toggleActiveButton(3)\r\n            changeGraphInterval('12h', '10m')\r\n          }}\r\n        >12 часов</button>\r\n\r\n        <button type=\"button\" \r\n          className={'btn btn-sm btn-outline-secondary mx-1 ' + getActiveCalss(4)} \r\n          onClick={()=>{\r\n            toggleActiveButton(4)\r\n            changeGraphInterval('1d', '30m')\r\n          }}\r\n        >сутки</button>\r\n\r\n        <button type=\"button\" \r\n          className={'btn btn-sm btn-outline-secondary mx-1 ' + getActiveCalss(5)} \r\n          onClick={()=>{\r\n            toggleActiveButton(5)\r\n            changeGraphInterval('7d', '2h')\r\n          }}\r\n        >неделя</button>\r\n\r\n        <button type=\"button\" \r\n          className={'btn btn-sm btn-outline-secondary mx-1 ' + getActiveCalss(6)} \r\n          onClick={()=>{\r\n            toggleActiveButton(6)\r\n            changeGraphInterval('30d', '12h')\r\n          }}\r\n        >месяц</button>\r\n\r\n        <button type=\"button\" \r\n          className={'btn btn-sm btn-outline-secondary mx-1 ' + getActiveCalss(7)} \r\n          onClick={()=>{\r\n            toggleActiveButton(7)\r\n            changeGraphInterval('30d', '12h') // todo\r\n          }}\r\n        >интервал</button> \r\n    </div>\r\n\r\n    {showRangeForm ? <RangeForm /> : null }\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n\r\nfunction RangeForm(props) {\r\n  return (\r\n    <React.Fragment>\r\n    <form className='pt-2'>\r\n      <div className=\"input-group input-group-sm \">\r\n        <div className=\"input-group-prepend \">\r\n          <span className=\"input-group-text bg-secondary text-light border-secondary ml-1\">C</span>\r\n        </div>\r\n        <input type=\"date\" className=\"form-control bg-dark text-light border-secondary\"></input>\r\n        <input type=\"time\" className=\"form-control bg-dark text-light border-secondary\"></input>\r\n\r\n        <div className=\"input-group-prepend \">\r\n          <span className=\"input-group-text bg-secondary text-light border-secondary ml-2\">По</span>\r\n        </div>\r\n        <input type=\"date\" className=\"form-control bg-dark text-light border-secondary\"></input>\r\n        <input type=\"time\" className=\"form-control bg-dark text-light border-secondary\"></input>\r\n\r\n        <button type=\"button\" className='btn btn-sm btn-secondary ml-2 mr-1'>показать</button> <br/>\r\n      </div>\r\n    </form>\r\n    </React.Fragment>\r\n  );\r\n}","import React from 'react'\r\nimport './Loader.css'\r\n\r\nexport default function Loader() {\r\n    return(\r\n        <div className=\"lds-ellipsis\"><div></div><div></div><div></div><div></div></div>\r\n    )\r\n}","import React from 'react';\r\nimport PropTypes from 'prop-types'\r\nimport Graph from './Graph'\r\nimport GraphWithCrosshair from './GraphWithCrosshair'\r\nimport Legend from './Legend'\r\nimport Toolbar from './Toolbar'\r\nimport Loader from '../../../base/components/Loader'\r\n\r\n\r\nfunction TagsHistoricalGraph(props) {\r\n  const [modal, setModal] = React.useState(false) // use it just for force update this component\r\n  const [crosshair, setCrosshair] = React.useState(false)\r\n  const graphCard = React.useRef(null)\r\n  const graphContainer = React.useRef(null)\r\n  const modalButton = React.useRef(null)\r\n  const crosshairButton = React.useRef(null)\r\n  const legendContainer = React.useRef(null)\r\n  const resetZoomButton = React.useRef(null)\r\n  const tags = props.tagsHistory  \r\n  const GRAPH_HEIGH = props.height ? props.height : '300px'\r\n\r\n  const toggleModal = () => {\r\n    const cl = ' full-screen-card'\r\n    if (graphCard.current.className.includes(cl)) {\r\n      graphCard.current.className = graphCard.current.className.replace(cl, '')\r\n      graphContainer.current.style.height = GRAPH_HEIGH\r\n      graphContainer.current.className = graphContainer.current.className.replace('col-10', 'col-8')\r\n      if (props.legend) {legendContainer.current.className = legendContainer.current.className.replace('col-2', 'col-4')}    \r\n      modalButton.current.className = modalButton.current.className.replace('fa-compress', 'fa-expand') \r\n      modalButton.current.className = modalButton.current.className.replace('text-primary', 'text-light')      \r\n      setModal(false)\r\n    } else {\r\n      graphCard.current.className += cl\r\n      graphContainer.current.style.height = 'calc(100vh - 150px)'\r\n      graphContainer.current.className = graphContainer.current.className.replace('col-8', 'col-10')\r\n      if (props.legend) {legendContainer.current.className = legendContainer.current.className.replace('col-4', 'col-2')}\r\n      modalButton.current.className = modalButton.current.className.replace('fa-expand', 'fa-compress') \r\n      modalButton.current.className = modalButton.current.className.replace('text-light', 'text-primary')       \r\n      setModal(true)\r\n    }\r\n  }\r\n\r\n  const toggleCroshair = () => {\r\n    if (crosshair) {\r\n      setCrosshair(!crosshair)\r\n      crosshairButton.current.className = crosshairButton.current.className.replace('text-primary', 'text-light')      \r\n    } else {\r\n      setCrosshair(!crosshair)\r\n      crosshairButton.current.className = crosshairButton.current.className.replace('text-light', 'text-primary') \r\n    }\r\n  }\r\n\r\n  return (   \r\n    <React.Fragment>\r\n    <div ref={graphCard} className='card shadow-sm py-2 bg-dark text-light h-100'>\r\n      <div className='d-flex mb-1'>\r\n        <h5 className=\"px-3 pt-1 pb-2 m-0\">{props.title}</h5>\r\n        <span className='ml-auto'></span>\r\n\r\n        <button type=\"button\" \r\n          ref={resetZoomButton} \r\n          className={'btn btn-link text-primary m-0 p-0 mt-1 mr-2 fas fa-search-minus d-none'} \r\n          style={{width: '28px', height: '28px', fontSize:'1em', textDecoration: 'none', outline: 'none', boxShadow: 'none'}} \r\n          onClick={null}\r\n        ></button>\r\n\r\n        <button type=\"button\"\r\n          ref={crosshairButton} \r\n          className={'btn btn-link text-light m-0 p-0 mt-1 mr-2 fas fa-ruler-vertical'} \r\n          style={{width: '28px', height: '28px', fontSize:'1em', textDecoration: 'none', outline: 'none', boxShadow: 'none'}}\r\n          onClick={toggleCroshair}\r\n        ></button> \r\n\r\n        <button type=\"button\" \r\n          ref={modalButton} \r\n          className={'btn btn-link text-light m-0 p-0 mt-1 mr-2 fas fa-expand'} \r\n          style={{width: '28px', height: '28px', fontSize:'1em', textDecoration: 'none', outline: 'none', boxShadow: 'none'}} \r\n          onClick={toggleModal}\r\n        ></button>  \r\n      </div>\r\n\r\n      { props.loading ? \r\n        <div className='d-flex justify-content-center'><Loader /></div> :\r\n          <div className=\"row m-0 px-3 py-0\">\r\n            <div ref={graphContainer} className={`${ props.legend ? 'col-8' : 'col-12'} m-0 p-0`} style={{height: GRAPH_HEIGH}}>\r\n              { crosshair ? \r\n                <GraphWithCrosshair tags={tags} resetZoomButton={resetZoomButton} /> : \r\n                <Graph tags={tags} resetZoomButton={resetZoomButton} /> \r\n              }\r\n            </div>\r\n\r\n            { props.legend && (\r\n              <div ref={legendContainer} className=\"col-4 m-0 p-0\">\r\n                <Legend tags={tags} onClick={props.toggleCurveDisplay} height={GRAPH_HEIGH}/>\r\n              </div>\r\n            )}\r\n\r\n            { props.toolbar && (\r\n              <div className=\"col-12 align-self-start m-0 p-0\">\r\n                <Toolbar toggleModal={toggleModal} toggleCroshair={toggleCroshair} changeGraphInterval={props.changeGraphInterval}/>\r\n              </div>\r\n            )}\r\n        </div>\r\n      }\r\n    </div>\r\n    </ React.Fragment>\r\n  );\r\n}\r\n\r\n\r\nTagsHistoricalGraph.propTypes = {\r\n    tagsHistory: PropTypes.arrayOf(PropTypes.object).isRequired\r\n}\r\n\r\nexport default TagsHistoricalGraph","// const colors = [\r\n//     '#19CDD7', '#DDB27C', '#88572C', \r\n//     '#FF991F', '#F15C17', '#223F9A', \r\n//     '#DA70BF', '#125C77', '#4DC19C', \r\n//     '#776E57', '#12939A', '#17B8BE', \r\n//     '#F6D18A', '#B7885E', '#FFCB99', \r\n//     '#F89570', '#829AE3', '#E79FD5', \r\n//     '#1E96BE', '#89DAC1', '#B3AD9E'\r\n// ]\r\n\r\nconst colors = [\r\n    '#f44336', '#00BCD4', '#FF9800', \r\n    '#E91E63', '#009688', '#FF5722', \r\n    '#9C27B0', '#4CAF50', '#795548', \r\n    '#673AB7', '#8BC34A', '#607D8B', \r\n    '#3F51B5', '#CDDC39', \r\n    '#2196F3', '#FFEB3B', \r\n    '#03A9F4', '#FFC107', \r\n]\r\n\r\n\r\nexport default function getColor(index) {\r\n    const clorsNumber = colors.length\r\n    var ind\r\n    if (index+1 > clorsNumber) {\r\n        ind = index % clorsNumber\r\n    }\r\n    else {\r\n        ind = index\r\n    }\r\n    return colors[ind]\r\n}","import React, { useEffect } from 'react' \r\n\r\nimport TagsHistoricalGraph from './components/TagsGraph/TagsHistoricalGraph'\r\nimport getColor from './components/TagsGraph/GraphColors'\r\nimport axiosInstance from \"../utils/axiosApi\";\r\nimport getBaseUrl from '../utils/localSettings'\r\nconst BASE_URL = getBaseUrl()\r\n\r\n\r\n\r\nexport default function WidgetGraph(props) {\r\n  const [loading, setLoading] = React.useState(true)\r\n  const [graphInterval, setGraphInterval] = React.useState({interval:'1h', resolution:'1m', tags: props.widget.tags})\r\n  const [tagsHistory, setTagsHistory] = React.useState([])\r\n  const device_id = props.device_id;\r\n\r\n  function updateTagsHistory(tags) {\r\n    const prepared_tags = tags.map( (tag, index) => {\r\n      return ({\r\n        tag_id: tag.tag_id,\r\n        tag_code: tag.tag_code,\r\n        tag_name: tag.tag_name,\r\n        disabled: false,\r\n        curve_color : getColor(index),\r\n        values: tag.values.map( (value) => {\r\n          return {x: new Date(value.add_date), y: value.value}\r\n        })\r\n      })\r\n    })  \r\n    setTagsHistory( (prev) => {\r\n      return prepared_tags.map( (tag)=> {\r\n        const fltr = prev.filter( entry=>entry.tag_id === tag.tag_id )\r\n        var disabled = (fltr.length > 0) ? fltr[0].disabled : tag.disabled\r\n        return {...tag, disabled: disabled}\r\n      })\r\n    }) \r\n  }\r\n\r\n  // read tags historical data\r\n  function readTagsHistory() {\r\n    axiosInstance.get(BASE_URL + \"/device/tags/history/\", { params: { id: device_id, ...graphInterval}} )\r\n    .then(responce => {\r\n      responce && updateTagsHistory(responce.data)\r\n    })  \r\n  }\r\n  \r\n  // read parameters\r\n  useEffect(() => {\r\n    readTagsHistory();\r\n    const loadingTimeout = setTimeout( () => { setLoading(false) }, 1000);\r\n    const graphUpdateInterval = setInterval( readTagsHistory, getGraphUpdateTimeout(graphInterval.interval))\r\n    return () => {\r\n      clearTimeout(loadingTimeout);\r\n      clearInterval(graphUpdateInterval);\r\n    };\r\n  }, [graphInterval])\r\n\r\n  \r\n  function changeGraphInterval(interval, resolution){\r\n    setGraphInterval( (prev) => {\r\n      return {...prev, interval: interval, resolution: resolution}\r\n    })\r\n  }\r\n\r\n  function getGraphUpdateTimeout(interval){\r\n    if (interval === '5m') {\r\n      return 2000                       // 2s\r\n    } else if (interval === '1h') {\r\n      return 30000                      // 30s\r\n    } else if (interval === '6h') {\r\n      return 60000 * 2                  // 2m\r\n    } else if (interval === '12h') {\r\n      return 60000 * 5                  // 5m\r\n    } else if (interval === '1d') {\r\n      return 60000 * 15                 // 15m\r\n    } else if (interval === '7d') {\r\n      return 60000 * 60                 // 1h\r\n    } else if (interval === '30d') {\r\n      return 60000 * 60 * 6             // 6h\r\n    } else {\r\n      return 60000 * 5                  // 5m\r\n    }\r\n  }\r\n\r\n  // toggle curve display\r\n  function toggleCurveDisplay(tag_id){\r\n    const n = tagsHistory.map( entry => { \r\n      if (entry.tag_id===tag_id) { entry.disabled = !entry.disabled } \r\n      return entry\r\n    })\r\n    setTagsHistory(n)\r\n  }\r\n\r\n  // render the widget\r\n  return (\r\n    <React.Fragment>\r\n        <TagsHistoricalGraph \r\n            tagsHistory={tagsHistory} \r\n            toggleCurveDisplay={toggleCurveDisplay}\r\n            title={props.widget.title}\r\n            legend={props.widget.legend}\r\n            loading={loading}\r\n            toolbar={props.widget.toolbar}\r\n            height={props.widget.height}\r\n            changeGraphInterval={changeGraphInterval}\r\n        /> \r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\n\r\nfunction TagsCurrentValueRow({tag, index}) {\r\n    return (\r\n        <tr>\r\n            <td className='border-secondary text-secondary pl-2'> {index + 1} </td>   \r\n            <td className='border-secondary'> {tag.code} </td>\r\n            <td className='border-secondary'> {tag.name} </td>\r\n            <td className='border-secondary'> {tag.value} </td>\r\n        </tr>\r\n    )\r\n}\r\n\r\n\r\n\r\nTagsCurrentValueRow.propTypes = {\r\n    tag: PropTypes.object.isRequired,\r\n    index: PropTypes.number.isRequired,\r\n}\r\n\r\nexport default TagsCurrentValueRow","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport TagsCurrentValueRow from './TagsCurrentValueRow'\r\nimport Loader from '../../../base/components/Loader'\r\n\r\n\r\nfunction TagsCurrentValueList(props) {\r\n  const [modal, setModal] = React.useState(false) // use it just for force update this component\r\n  const modalButton = React.useRef(null)\r\n  const graphCard = React.useRef(null)\r\n\r\n  const toggleModal = () => {\r\n    const cl = ' full-screen-card'\r\n    if (graphCard.current.className.includes(cl)) {\r\n      graphCard.current.className = graphCard.current.className.replace(cl, '')\r\n      modalButton.current.className = modalButton.current.className.replace('fa-compress', 'fa-expand') \r\n      modalButton.current.className = modalButton.current.className.replace('text-primary', 'text-light')      \r\n      setModal(false)\r\n    } else {\r\n      graphCard.current.className += cl\r\n      modalButton.current.className = modalButton.current.className.replace('fa-expand', 'fa-compress') \r\n      modalButton.current.className = modalButton.current.className.replace('text-light', 'text-primary')       \r\n      setModal(true)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div ref={graphCard} className='card shadow-sm py-2 bg-dark text-light h-100'>\r\n      <div className='d-flex mb-1'>\r\n        <h5 className=\"px-3 pt-1 pb-0 m-0\">{props.title}</h5>\r\n        <span className='ml-auto'></span>\r\n\r\n        <button type=\"button\" \r\n          ref={modalButton} \r\n          className={'btn btn-link text-light m-0 p-0 mt-1 mr-2 fas fa-expand'} \r\n          style={{width: '28px', height: '28px', fontSize:'1em', textDecoration: 'none', outline: 'none', boxShadow: 'none'}} \r\n          onClick={toggleModal}\r\n        ></button>  \r\n      </div>\r\n  \r\n      { props.loading ? \r\n        <div className='d-flex justify-content-center'><Loader /></div> :     \r\n        <div className=\"table-responsive px-3\">\r\n          <table className=\"table table-sm text-light tadle-dark w-100 mb-0\">\r\n            <thead> \r\n              <tr>\r\n                <td className='border-0 text-secondary font-weight-bold pl-2'>№</td>\r\n                <td className='border-0 text-secondary font-weight-bold'>Код параметра</td>\r\n                <td className='border-0 text-secondary font-weight-bold'>Наименование параметра</td>\r\n                <td className='border-0 text-secondary font-weight-bold'>Текущее значение</td>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n                { props.tags.map((tag, index) => {\r\n                  return (\r\n                    <TagsCurrentValueRow tag={tag} key={tag.code} index={index} />\r\n                  )\r\n                }) }\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      }\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\nTagsCurrentValueList.propTypes = {\r\n    tags: PropTypes.arrayOf(PropTypes.object).isRequired\r\n}\r\n\r\nexport default TagsCurrentValueList","import React, { useEffect } from 'react' \r\n\r\nimport TagsCurrentValueList from './components/TagsList/TagsCurrentValueList'\r\nimport axiosInstance from \"../utils/axiosApi\";\r\nimport getBaseUrl from '../utils/localSettings'\r\nconst BASE_URL = getBaseUrl()\r\n\r\n\r\n\r\nexport default function WidgetTable(props) {\r\n  const [tags, setTags] = React.useState([])\r\n  const [loading, setLoading] = React.useState(true)\r\n  const device_id = props.device_id;\r\n  const displayedTags =  props.widget.tags;\r\n\r\n  function readDeviceTags() {\r\n    axiosInstance.get(BASE_URL + \"/device/tags/value/\", { params: { id: device_id, tags: displayedTags }} )\r\n    .then((responce) => {\r\n      responce && setTags(responce.data)     \r\n    })  \r\n  }\r\n  \r\n  // read parameters\r\n  useEffect(() => {\r\n    readDeviceTags();\r\n    const loadingTimeout = setTimeout( () => { setLoading(false) }, 1000);\r\n    const tagsUpdateInterval = setInterval(readDeviceTags, 2000);\r\n    return () => {\r\n      clearTimeout(loadingTimeout);      \r\n      clearInterval(tagsUpdateInterval);\r\n    };\r\n  }, [])\r\n\r\n  // render the page\r\n  return (\r\n    <React.Fragment>\r\n        <TagsCurrentValueList\r\n          tags={tags} \r\n          title={props.widget.title} \r\n          loading={loading} \r\n        />\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n","import React from 'react'\r\nimport Loader from '../../../base/components/Loader'\r\n\r\n\r\nexport default function TagIndicator(props) {\r\n  const tag = props.tag\r\n  const addTextRight = props.addTextRight\r\n  const addTextLeft = props.addTextLeft\r\n\r\n  var value = 'none'\r\n  if (tag) {\r\n    value = props.precision ? tag.value.toFixed(props.precision) : tag.value\r\n  }\r\n\r\n  return (\r\n    <div className='card shadow-sm py-2 bg-dark text-light h-100'>\r\n      <div className='d-flex mb-1'>\r\n        <h5 className=\"px-3 pt-1 pb-0 m-0\">{props.title}</h5>\r\n        <span className='ml-auto'></span>  \r\n      </div>\r\n  \r\n      { props.loading ? \r\n        <div className='d-flex justify-content-center'><Loader /></div> :     \r\n        <div className=\"d-flex justify-content-center align-items-end h-100 px-3\">\r\n          {tag ? \r\n            <p className='display-4 m-0 p-0'>\r\n              <span>{addTextLeft} </span> \r\n              {value} \r\n              <span> {addTextRight}</span>\r\n            </p> :\r\n            <p className='display-4 text-secondary m-0 p-0'>Нет данных</p> \r\n          }\r\n        </div>\r\n      }\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\n\r\n","import React, { useEffect } from 'react' \r\n\r\nimport TagIndicator from './components/TagsIndicator/TagIndicator'\r\nimport axiosInstance from \"../utils/axiosApi\"\r\nimport getBaseUrl from '../utils/localSettings'\r\nconst BASE_URL = getBaseUrl()\r\n\r\n\r\n\r\nexport default function WidgetIndicator(props) {\r\n  const [tags, setTags] = React.useState([])\r\n  const [loading, setLoading] = React.useState(true)\r\n  const device_id = props.device_id\r\n  const displayedTags =  props.widget.tags  \r\n  const tag = tags[0] // TODO: widget display just 1 tag now\r\n\r\n  function readDeviceTags() {\r\n    axiosInstance.get(BASE_URL + \"/device/tags/value/\",  { params: { id: device_id, tags: displayedTags }} )\r\n    .then((responce) => {\r\n      responce && setTags(responce.data)\r\n    })  \r\n  }\r\n\r\n\r\n\r\n  useEffect(() => {\r\n    readDeviceTags();\r\n    const loadingTimeout = setTimeout( () => { setLoading(false) }, 1000);\r\n    const tagsUpdateInterval = setInterval(readDeviceTags, 2000);\r\n    return () => {\r\n      clearTimeout(loadingTimeout);      \r\n      clearInterval(tagsUpdateInterval);\r\n    };\r\n  }, [])\r\n\r\n\r\n  return (\r\n    <React.Fragment>\r\n        <TagIndicator\r\n          tag={tag} \r\n          title={props.widget.title}\r\n          precision={props.widget.precision}\r\n          addTextRight={props.widget.addTextRight}\r\n          addTextLeft={props.widget.addTextLeft}\r\n          loading={loading} \r\n        />\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n","import React from 'react' \r\n\r\nimport WidgetGraph from './WidgetGraph'\r\nimport WidgetTable from './WidgetTable'\r\nimport WidgetIndicator from './WidgetIndicator' \r\n\r\n\r\n\r\nexport default function RenderWidgets(props) {\r\n  const widgetsTemplate = props.widgetsTemplate\r\n  const device_id = props.device_id\r\n  if (!props.widgetsTemplate) {return null}\r\n  if (!props.widgetsTemplate.widgets) {return null}\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='container-fluid row equal p-0 m-0'>\r\n      {\r\n        widgetsTemplate.widgets.map((widget, index)=>{\r\n          return <WidgetRender widget={widget} device_id={device_id} key={index} />\r\n        })\r\n      }\r\n      </div>\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\n\r\nfunction WidgetRender(props) {\r\n  const widget = props.widget\r\n  const device_id = props.device_id\r\n\r\n  if (widget.type === 'table') {\r\n    return (\r\n      <div className={`col-xl-${widget.width * 3} col-lg-${Math.min(widget.width * 6, 12)} col-md-12 p-1 m-0`}>\r\n        <WidgetTable device_id={device_id} widget={widget}/>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (widget.type === 'graph') {\r\n    return (\r\n      <div className={`col-xl-${widget.width * 3} col-lg-${Math.min(widget.width * 6, 12)} col-md-12 p-1 m-0`}>\r\n        <WidgetGraph device_id={device_id} widget={widget}/>\r\n      </div>\r\n    )    \r\n  }   \r\n\r\n  if (widget.type === 'indicator') {\r\n    return (\r\n      <div className={`col-xl-${widget.width * 3} col-lg-${Math.min(widget.width * 6, 12)} col-md-12 p-1 m-0`}>\r\n        <WidgetIndicator device_id={device_id} widget={widget}/>\r\n      </div>\r\n    )    \r\n  }    \r\n}\r\n","import React from 'react' \r\n\r\nimport DeviceHeader from '../components/DeviceHeader'\r\nimport RenderWidgets from '../../Widgets/renderWidgets'\r\n\r\n\r\n\r\nexport default function DeviceOverviewPage(props) {\r\n  const device_id = props.device_id;\r\n  const widgetsTemplate = props.widgetsTemplate;\r\n  \r\n  // render the page\r\n  return (\r\n    <React.Fragment>\r\n      <DeviceHeader device_id={device_id}/>\r\n      <RenderWidgets widgetsTemplate={widgetsTemplate} device_id={device_id}/>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n","import React from 'react' \r\n\r\n\r\nexport default function DeviceSettingsPage() {\r\n\r\n  return (\r\n    <React.Fragment>\r\n        <h3>Настройки устройства</h3>\r\n        <p>Раздел находиться в разработке ... </p>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n ","import React from 'react' \r\n\r\n\r\nexport default function DeviceEventsLogPage() {\r\n\r\n  return (\r\n    <React.Fragment>\r\n        <h3>Журнал событий обьекта</h3>\r\n        <p>Раздел находиться в разработке ... </p>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n ","import React from 'react' \r\n\r\nimport DeviceHeader from '../components/DeviceHeader'\r\nimport RenderWidgets from '../../Widgets/renderWidgets'\r\n\r\n\r\n\r\nconst WidgetsTemplate = {\r\n  widgets:[   \r\n    {\r\n      type: 'graph',\r\n      width: 4,\r\n      height: 'calc(65vh)',\r\n      title: 'История',\r\n      tags: null,\r\n      legend: true,\r\n      toolbar: true,\r\n    }      \r\n  ]\r\n}\r\n\r\n\r\n\r\nexport default function DeviceOverviewPage(props) {\r\n  const device_id = props.device_id;\r\n  \r\n  // render the page\r\n  return (\r\n    <React.Fragment>\r\n      <DeviceHeader device_id={device_id}/>\r\n      <RenderWidgets widgetsTemplate={WidgetsTemplate} device_id={device_id}/>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n","import React from 'react' \r\n\r\n\r\nexport default function DeviceAdminPage() {\r\n\r\n  return (\r\n    <React.Fragment>\r\n        <h3>Настройка параметров прибора</h3>\r\n        <p>Раздел находиться в разработке ... </p>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n ","import React from 'react' \r\n\r\nexport function TextField(props){\r\n    // props.titel : str\r\n    // props.placeholder : str  \r\n    // props.id : str\r\n    // props.value : str\r\n    // props.comment : str or jsx\r\n    // props.onChange : function\r\n    return (\r\n      <React.Fragment>\r\n        <div className=\"form-group\">\r\n          <label htmlFor={props.id} className='text-secondary'>{props.titel}</label>\r\n          <input \r\n            type=\"text\" \r\n            className=\"form-control form-control-sm bg-secondary border-secondary text-light\" \r\n            placeholder={props.placeholder} \r\n            id={props.id} \r\n            defaultValue={props.value}\r\n            onChange={props.onChange}\r\n          ></input>\r\n          <p className='text-small text-info p-0 m-0'>{props.comment}</p>\r\n        </div>\r\n      </React.Fragment>\r\n    ) \r\n  }\r\n  \r\nexport function NumberField(props){\r\n    // props.titel : str\r\n    // props.placeholder : str  => like \"12\"\r\n    // props.min : str  => like \"1\"\r\n    // props.max : str  => like \"5\"\r\n    // props.id : str\r\n    // props.value : int\r\n    // props.comment : str or jsx\r\n    // props.onChange : function\r\n    return (\r\n      <React.Fragment>\r\n        <div className=\"form-group\">\r\n          <label htmlFor={props.id} className='text-secondary'>{props.titel}</label>\r\n          <input \r\n            type=\"number\" \r\n            className=\"form-control form-control-sm bg-secondary border-secondary text-light\" \r\n            placeholder={props.placeholder} \r\n            id={props.id} \r\n            defaultValue={props.value}\r\n            min={props.min}\r\n            max={props.max}\r\n            onChange={props.onChange}            \r\n          ></input>\r\n          <p className='text-small text-info p-0 pt-1 m-0'>{props.comment}</p>        \r\n        </div>\r\n      </React.Fragment>\r\n    ) \r\n  }\r\n  \r\nexport function SelectField(props){\r\n    // props.titel : str\r\n    // props.placeholder : str\r\n    // props.options : []\r\n    // props.id : str\r\n    // props.value : int\r\n    // props.comment : str or jsx\r\n    // props.onChange : function\r\n    return (\r\n      <React.Fragment>\r\n        <div className=\"form-group\">\r\n          <label htmlFor={props.id} className='text-secondary'>{props.titel}</label>\r\n          <select \r\n            className=\"form-control form-control-sm bg-secondary border-secondary text-light\" \r\n            id={props.id} \r\n            placeholder={props.placeholder} \r\n            defaultValue={props.value}\r\n            onChange={props.onChange}            \r\n          >\r\n            <option value=\"\" disabled selected hidden>---</option>\r\n            {props.options && props.options.map((option, index)=>{\r\n              return <option key={index}>{option}</option>\r\n            })}\r\n          </select>\r\n          <p className='text-small text-info p-0 m-0'>{props.comment}</p>\r\n        </div>\r\n      </React.Fragment>\r\n    ) \r\n  }\r\n  \r\nexport function MultipleSelectField(props){\r\n    // props.titel : str\r\n    // props.placeholder : str\r\n    // props.options : []\r\n    // props.id : str\r\n    // props.value : int\r\n    // props.comment : str or jsx\r\n    // props.onChange : function\r\n    return (\r\n      <React.Fragment>\r\n        <div className=\"form-group\">\r\n          <label htmlFor={props.id} className='text-secondary'>{props.titel}</label>\r\n          <select \r\n            multiple \r\n            className=\"form-control form-control-sm bg-secondary border-secondary text-light\" \r\n            id={props.id} \r\n            placeholder={props.placeholder} \r\n            defaultValue={props.value}\r\n            onChange={props.onChange}            \r\n          >\r\n            {props.options && props.options.map((option, index)=>{\r\n              return <option key={index}>{option}</option>\r\n            })}\r\n          </select>\r\n          <p className='text-small text-info p-0 m-0'>{props.comment}</p>\r\n        </div>\r\n      </React.Fragment>\r\n    ) \r\n  }\r\n  \r\nexport function CheckboxField(props){\r\n    // props.titel : str\r\n    // props.id : str\r\n    // props.checked : boolean\r\n    // props.comment : str or jsx\r\n    // props.onChange : function\r\n    return (\r\n      <React.Fragment>\r\n        <div className=\"form-check pb-3\">\r\n          <input \r\n            type=\"checkbox\" \r\n            className=\"form-check-input\" \r\n            id={props.id} \r\n            checked={props.checked}\r\n            onChange={props.onChange}\r\n        ></input>\r\n          <span>{props.titel}</span>\r\n          <p className='text-small text-info p-0 m-0'>{props.comment}</p>\r\n        </div>\r\n      </React.Fragment>\r\n    ) \r\n  }\r\n  \r\nexport function InlineCheckboxField(props){\r\n    // props.titel : str\r\n    // props.id : str\r\n    // props.checked : boolean\r\n    // props.comment : str or jsx\r\n    // props.onChange : function\r\n    return (\r\n      <React.Fragment>\r\n        <div className=\"form-check-inline pb-3\">\r\n          <input \r\n            type=\"checkbox\" \r\n            className=\"form-check-input\" \r\n            id={props.id} \r\n            checked={props.checked}\r\n            onChange={props.onChange}\r\n          ></input>\r\n          <span>{props.titel}</span>\r\n          <p className='text-small text-info p-0 m-0'>{props.comment}</p>\r\n        </div>\r\n      </React.Fragment>\r\n    ) \r\n  }","import React, {useEffect} from 'react' \r\n\r\nimport {\r\n  TextField,\r\n  NumberField,\r\n  SelectField,\r\n  MultipleSelectField,\r\n  CheckboxField,\r\n} from '../../base/forms/forms'\r\n\r\nimport sortWidgetsByOrder from '../utils/sortWidgetsByOrder'\r\n\r\nimport Loader from '../../base/components/Loader'\r\nimport axiosInstance from \"../../utils/axiosApi\";\r\nimport getBaseUrl from '../../utils/localSettings'\r\nconst BASE_URL = getBaseUrl()\r\n\r\nexport default function WidgetsAdminPage(props) {\r\n  const device_id = props.device_id;\r\n  const updateWidgetsTemplate = props.updateWidgetsTemplate\r\n  const [widgetsTemplate, setWidgetsTemplate] = React.useState( sortWidgetsByOrder(props.widgetsTemplate) )\r\n  const [selectedWidget, setSelectedWidget] = React.useState(0)\r\n  const [tags, setTags] = React.useState([])\r\n\r\n  // read tags list\r\n  const readDeviceTags = () => {\r\n    axiosInstance.get(BASE_URL + \"/device/tags/value/\", { params: { id: device_id }} )\r\n    .then((responce) => {\r\n      responce && setTags(responce.data)\r\n    })  \r\n  }\r\n  useEffect(() => {\r\n    readDeviceTags();\r\n  }, [])\r\n\r\n\r\n  // I use it for fix bug: witout this, when I change the same type forms, \r\n  // form fields data does not changing \r\n  // if i hide and show the form, fields data update correctly\r\n  const [displayWidget, setDisplayWidget] = React.useState(false) \r\n  const rerenderWidgetForm = () => {\r\n    setDisplayWidget(false)\r\n    setTimeout( () => { setDisplayWidget(true) }, 0);\r\n  }\r\n  useEffect(() => {\r\n    rerenderWidgetForm()\r\n  }, [selectedWidget, tags])  \r\n\r\n\r\n  // control buttons\r\n  const changeSelectedWidget = (widgetNumber) => {\r\n    setSelectedWidget(widgetNumber)\r\n  }\r\n\r\n  const saveWidgetsTemplate = () => {\r\n    updateWidgetsTemplate(widgetsTemplate)\r\n  }\r\n\r\n  const cancelTemplateChanges = () => {\r\n    setWidgetsTemplate( sortWidgetsByOrder(props.widgetsTemplate) )\r\n    setSelectedWidget(0)\r\n    rerenderWidgetForm()\r\n  }\r\n\r\n  const deleteWidget = (index) => {\r\n    const wt = widgetsTemplate.widgets.map((w)=>{return w})\r\n    wt.splice(index, 1)\r\n    setWidgetsTemplate({widgets: wt})\r\n    setSelectedWidget(0)\r\n  }\r\n\r\n  // update widget config\r\n  const updateWidget = (WidgetData) => {\r\n    const wt = widgetsTemplate.widgets.map((w, index)=>{\r\n      if (index === selectedWidget) {\r\n        return WidgetData\r\n      } else {\r\n        return w\r\n      }\r\n    })\r\n    setWidgetsTemplate({widgets: wt})\r\n  }\r\n\r\n  // const onChangeWidgetOrder = (w_index, new_order) => {\r\n  //   // TODO\r\n  //   ;\r\n  // }\r\n\r\n  // add new widget\r\n  const addWidgetToTemplate = (widget) => {\r\n    var a = widgetsTemplate.widgets.map((item)=>{return item})\r\n    a.push(widget)\r\n    setWidgetsTemplate({widgets: a})   \r\n  }\r\n\r\n  const addWidgetHendler = (type) => {\r\n    if (type === 'table') { addWidgetToTemplate(DefaultTable) } \r\n    else if (type === 'graph') { addWidgetToTemplate(DefaultGraph) }\r\n    else if (type === 'indicator') { addWidgetToTemplate(DefaultIndicator) }\r\n  }\r\n\r\n  if (!widgetsTemplate.widgets) {return <Loader />}\r\n\r\n  // render page\r\n  return (\r\n    <React.Fragment>\r\n      <h3 className='mb-3'>Настройка виджетов</h3>\r\n      <div className='row equal p-0 m-0'>\r\n        <div className='col-md-6 col-lg-7 col-xl-8 px-1' style={{minHeight: '80vh'}}>\r\n          <div className='p-0 m-0 bg-dark rounded h-100'>\r\n            <WidgetsGrid widgetsTemplate={widgetsTemplate} selectedWidget={selectedWidget} changeSelectedWidget={changeSelectedWidget}/>\r\n          </div>\r\n        </div>\r\n        <div className='col-md-6 col-lg-5 col-xl-4 px-1' style={{minHeight: '80vh'}}>\r\n          <div className='p-0 m-0 bg-dark rounded h-100'>\r\n            <WidgetsControlPanel addWidget={addWidgetHendler} saveWidgetsTemplate={saveWidgetsTemplate} cancelChanges={cancelTemplateChanges}/>\r\n            { displayWidget ? \r\n              <WidgetForm widget={widgetsTemplate.widgets[selectedWidget]} tags={tags} updateWidget={updateWidget} deleteWidget={()=>deleteWidget(selectedWidget)}/> \r\n              : null }\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n// -------------------------------------------------------------------------------------------------\r\nfunction WidgetsGrid(props){\r\n  const widgetsTemplate = props.widgetsTemplate\r\n  const selectedWidget = props.selectedWidget\r\n  const changeSelectedWidget = props.changeSelectedWidget\r\n\r\n  if (!widgetsTemplate.widgets) {return <Loader />}\r\n\r\n  const content = widgetsTemplate.widgets.map((widget, index)=>{\r\n    const btnAddClass= (index===selectedWidget) ?  'border-primary' : ''\r\n    return (\r\n      <div key={index} className={`col-${widget.width * 3} p-1 m-0`}> \r\n        <button className={'btn btn-dark w-100 h-100 text-left p-0 ' + btnAddClass} style={{overflow:'hidden', minHeight:'10vh', boxShadow: 'none'}} onClick={()=>{changeSelectedWidget(index)}}>\r\n          <div className='h-100 p-0 px-2'>\r\n            <span className='small text-nowrap'>{widget.title}</span>\r\n            <WidgetPreview widget={widget} />\r\n          </div>\r\n        </button>\r\n      </div>\r\n    )\r\n  })\r\n\r\n  return (\r\n    <div className='d-flex justify-content-center m-0 p-4' style={{}}>\r\n      <div className='row equal rounded m-0 p-3' style={{backgroundColor: '#1E1E1E', maxWidth:'800px'}}>\r\n        {content}\r\n      </div>\r\n    </div>\r\n  )\r\n} \r\n\r\n\r\nconst WidgetPreview = (props) => {\r\n  const widget = props.widget\r\n  const color = props.color ? props.color : 'secondary'\r\n\r\n  if (widget.type === 'table') {\r\n    return (\r\n      <div className='d-flex justify-content-center'>\r\n        <span className={`fas fa-table text-${color} m-2`} style={{fontSize:'4em'}}></span>\r\n      </div>\r\n    )\r\n  } else if (widget.type === 'graph') {\r\n    return (\r\n      <div className='d-flex justify-content-center'>\r\n        <span className={`fas fa-chart-area text-${color} m-2`} style={{fontSize:'4em'}}></span>\r\n      </div>\r\n      )\r\n  } else if (widget.type === 'indicator') {\r\n    return (\r\n      <div className='d-flex justify-content-center'>\r\n        <span className={`border rounded-sm text-${color} border-${color} text-nowrap m-2 px-2`} style={{fontSize:'1.5em'}}>{widget.addTextLeft} XX.X {widget.addTextRight}</span>\r\n      </div>\r\n      )\r\n  } else {\r\n    return null\r\n  }   \r\n}\r\n\r\n\r\n// -------------------------------------------------------------------------------------------------\r\nfunction WidgetsControlPanel(props){\r\n  const [show, setShow] = React.useState(false);\r\n  const handleClose = () => setShow(false);\r\n  const handleShow = () => setShow(true);\r\n\r\n  const handleAddWidget = (type) => {\r\n    props.addWidget(type);\r\n    handleClose();\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <div className='p-2'> \r\n        <div className='m-1 pt-2 pb-3 border-bottom border-secondary'>\r\n          <div className='d-flex justify-content-left'>\r\n            <button className='btn btn-outline-info btn-sm mr-3' type='button' onClick={handleShow}> Добавить виджет</button>\r\n            <button className='btn btn-outline-success btn-sm mr-3' type='button' onClick={props.saveWidgetsTemplate}>Сохранить</button>\r\n            <button className='btn btn-outline-danger btn-sm' type='button' onClick={props.cancelChanges}>Отмена</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <ModalSelectWidgetType show={show} handleClose={handleClose} handleAddWidget={handleAddWidget}/>\r\n    </>\r\n  )\r\n}\r\n\r\n\r\nfunction WidgetForm(props){\r\n  const widget = props.widget\r\n  const tags = props.tags\r\n  const updateWidget = props.updateWidget\r\n  const deleteWidget = props.deleteWidget\r\n  let w = {}\r\n\r\n  if (! widget) {return null}\r\n\r\n  if (widget.type === 'table') { w = <WTableForm widget={widget} tags={tags} updateWidget={updateWidget} deleteWidget={deleteWidget}/> }\r\n  if (widget.type === 'graph') { w = <WGraphForm widget={widget} tags={tags} updateWidget={updateWidget} deleteWidget={deleteWidget}/> }\r\n  if (widget.type === 'indicator') { w = <WIndicatorForm widget={widget} tags={tags} updateWidget={updateWidget} deleteWidget={deleteWidget}/> } \r\n  \r\n  return (\r\n    <div className='p-0 m-0 my-1'> \r\n      <FormContainer> {w} </FormContainer>\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\nfunction FormContainer(props){\r\n  return (\r\n    <div className='text-light p-2 m-0 mx-1 h-100'>\r\n      {props.children}\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\n// -------------------------------------------------------------------------------------------------\r\nfunction ModalSelectWidgetType(props){\r\n  const WidgetTypeButton = (props) => {\r\n    return (\r\n      <div className='col-4 p-1 w-100'>\r\n        <button type=\"button\" className=\"btn btn-primary w-100 h-100\" onClick={props.onClick}>\r\n          <div className='h-100 p-0 px-2'>\r\n            {props.children}\r\n          </div>\r\n        </button>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (props.show) {\r\n    return(\r\n      <div className=\"modal modal-bg d-block\">\r\n        <div className=\"modal-dialog\">\r\n          <div className=\"modal-content\">\r\n\r\n            <div className=\"modal-header\">\r\n              <h4 className=\"modal-title\">Добавить новый виджет</h4>\r\n              <button type=\"button\" className=\"close\" onClick={props.handleClose}>&times;</button>\r\n            </div>\r\n\r\n            <div className=\"modal-body\">\r\n              <div className='row equal px-1'>\r\n                <WidgetTypeButton onClick={()=> props.handleAddWidget('indicator')}>\r\n                  <span className='text-nowrap'>Индикатор</span>\r\n                  <div className='pt-2'></div>\r\n                  <WidgetPreview widget={{type:'indicator'}} color={'light'} />\r\n                </WidgetTypeButton>\r\n                <WidgetTypeButton onClick={()=> props.handleAddWidget('table')}>\r\n                  <span className='text-nowrap'>Таблица</span>\r\n                  <WidgetPreview widget={{type:'table'}} color={'light'} />\r\n                </WidgetTypeButton>\r\n                <WidgetTypeButton onClick={()=> props.handleAddWidget('graph')}>\r\n                  <span className='text-nowrap'>График</span>\r\n                  <WidgetPreview widget={{type:'graph'}} color={'light'} />\r\n                </WidgetTypeButton>  \r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"modal-footer\">\r\n              <button type=\"button\" className=\"btn btn-danger\" onClick={props.handleClose}>Отмена</button>\r\n            </div>\r\n\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n  } else {\r\n    return null\r\n  }\r\n}\r\n\r\n\r\n// -------------------------------------------------------------------------------------------------\r\nfunction WTableForm(props){\r\n  const widget = props.widget\r\n  const tags = props.tags\r\n  const updateWidget = props.updateWidget\r\n  const columnOptions = ['#No', 'code', 'name', 'value']\r\n  let tagsOptions = []\r\n\r\n  if (tags) {\r\n    tagsOptions = tags.map((tag)=>{\r\n      return tag.code\r\n    })\r\n  }\r\n\r\n  const handlTitleChange = (e) => { updateWidget({...widget, title: e.target.value}) }\r\n  const handlOrderChange = (e) => { updateWidget({...widget, order: e.target.value}) }\r\n  const handlWidthChange = (e) => { updateWidget({...widget, width: e.target.value}) }\r\n  const handlSelectedTagsChange = (e) => { updateWidget({...widget, tags: getSelectedOptions(e)}) }\r\n  const handlSelectedFieldsChange = (e) => { updateWidget({...widget, fields: getSelectedOptions(e)}) }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='d-flex'>\r\n        <h6>Таблица</h6>\r\n        <button type=\"button\" className=\"btn btn-sm btn-outline-danger ml-auto\" onClick={props.deleteWidget}>Удалить</button>\r\n      </div>\r\n      <form>\r\n        <TextField titel={'Название'} id={'title'} placeholder={'...'} value={widget.title} onChange={handlTitleChange}/>\r\n        <NumberField titel={'Порядок отображения'} id={'order'} placeholder={'...'} value={widget.order} onChange={handlOrderChange}/>\r\n        <NumberField titel={'Ширина'} id={'width'} placeholder={'...'} value={widget.width} min={1} max={4} onChange={handlWidthChange}/>\r\n        <MultipleSelectField \r\n          titel={'Теги'} \r\n          id={'tags'} \r\n          placeholder={'...'} \r\n          value={widget.tags} \r\n          options={tagsOptions} \r\n          comment={<span className='m-0 p-0 d-block mt-1'>Удерживайте <kbd className='text-info'>Ctrl</kbd> для выбора нескольких элементов</span>}\r\n          onChange={handlSelectedTagsChange}\r\n        />\r\n        <MultipleSelectField \r\n          titel={'Колонки'} \r\n          id={'fields'} \r\n          placeholder={'...'} \r\n          value={widget.fields} \r\n          options={columnOptions} \r\n          comment={<span className='m-0 p-0 d-block mt-1'>Удерживайте <kbd className='text-info'>Ctrl</kbd> для выбора нескольких элементов</span>}\r\n          onChange={handlSelectedFieldsChange}\r\n        />          \r\n      </form>\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\n// table config example\r\n// {\r\n//   type: 'table',\r\n//   width: 2,\r\n//   title: 'Таблица параметров 2',\r\n//   tags: ['TEMP1', 'TEMP2', 'TEMP3'],   \r\n//   fields: ['#No', 'code', 'name', 'value']              \r\n// }\r\n\r\n\r\n// ----------------------------------------------------------------------------------\r\nfunction WGraphForm(props){\r\n  const widget = props.widget\r\n  const tags = props.tags\r\n  const updateWidget = props.updateWidget\r\n  let tagsOptions = []\r\n\r\n  if (tags) {\r\n    tagsOptions = tags.map((tag)=>{\r\n      return tag.code\r\n    })\r\n  }\r\n\r\n  const handlTitleChange = (e) => { updateWidget({...widget, title: e.target.value}) }\r\n  const handlOrderChange = (e) => { updateWidget({...widget, order: e.target.value}) }\r\n  const handlWidthChange = (e) => { updateWidget({...widget, width: e.target.value}) }\r\n  const handlSelectedTagsChange = (e) => { updateWidget({...widget, tags: getSelectedOptions(e)}) }\r\n  const handlLegendChange = (e) => { updateWidget({...widget, legend: e.target.checked}) }\r\n  const handlToolbarChange = (e) => { updateWidget({...widget, toolbar: e.target.checked}) }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='d-flex'>\r\n        <h6>График</h6>\r\n        <button type=\"button\" className=\"btn btn-sm btn-outline-danger ml-auto\" onClick={props.deleteWidget}>Удалить</button>\r\n      </div>\r\n      <form>\r\n        <TextField titel={'Название'} id={'title'} placeholder={'...'} value={widget.title} onChange={handlTitleChange}/>\r\n        <NumberField titel={'Порядок отображения'} id={'order'} placeholder={'...'} value={widget.order} onChange={handlOrderChange}/>\r\n        <NumberField titel={'Ширина'} id={'width'} placeholder={'...'} value={widget.width} min={1} max={4} onChange={handlWidthChange}/>\r\n        <MultipleSelectField \r\n          titel={'Теги'} \r\n          id={'tags'} \r\n          placeholder={'...'} \r\n          value={widget.tags} \r\n          options={tagsOptions} \r\n          comment={<span className='m-0 p-0 d-block mt-1'>Удерживайте <kbd className='text-info'>Ctrl</kbd> для выбора нескольких элементов</span>}\r\n          onChange={handlSelectedTagsChange}\r\n        />\r\n        <CheckboxField titel={'Легенда'} id={'legend'} checked={widget.legend} onChange={handlLegendChange}/>  \r\n        <CheckboxField titel={'Панель инструментов'} id={'toolbar'} checked={widget.toolbar} onChange={handlToolbarChange}/>  \r\n      </form>\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\n// graph config example\r\n// {\r\n//   type: 'graph',\r\n//   width: 2,\r\n//   title: 'Влажность',\r\n//   tags: ['RH1', 'RH2'],\r\n//   legend: true,\r\n//   toolbar: true,\r\n// }  \r\n\r\n\r\n// ----------------------------------------------------------------------------------\r\nfunction WIndicatorForm(props){\r\n  const widget = props.widget\r\n  const tags = props.tags\r\n  const updateWidget = props.updateWidget\r\n  let tagsOptions = []\r\n\r\n  if (tags) {\r\n    tagsOptions = tags.map((tag)=>{\r\n      return tag.code\r\n    })\r\n  }\r\n\r\n  const handlTitleChange = (e) => { updateWidget({...widget, title: e.target.value}) }\r\n  const handlOrderChange = (e) => { updateWidget({...widget, order: e.target.value}) }\r\n  const handlWidthChange = (e) => { updateWidget({...widget, width: e.target.value}) }\r\n  const handlSelectedTagsChange = (e) => { updateWidget({...widget, tags: getSelectedOptions(e)}) }  \r\n  const handlPrecisionChange = (e) => { updateWidget({...widget, precision: e.target.value}) }  \r\n  const handlTextLeftChange = (e) => { updateWidget({...widget, addTextLeft: e.target.value}) }\r\n  const handlTextRightChange = (e) => { updateWidget({...widget, addTextRight: e.target.value}) }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='d-flex'>\r\n        <h6>Индикатор</h6>\r\n        <button type=\"button\" className=\"btn btn-sm btn-outline-danger ml-auto\" onClick={props.deleteWidget}>Удалить</button>\r\n      </div>\r\n      <form>\r\n        <TextField titel={'Название'} id={'title'} placeholder={'...'} value={widget.title} onChange={handlTitleChange}/>\r\n        <NumberField titel={'Порядок отображения'} id={'order'} placeholder={'...'} value={widget.order} onChange={handlOrderChange}/>\r\n        <NumberField titel={'Ширина'} id={'width'} placeholder={'...'} value={widget.width} min={1} max={4} onChange={handlWidthChange}/>\r\n        <SelectField \r\n          titel={'Тег'} \r\n          id={'tags'} \r\n          placeholder={'...'} \r\n          value={widget.tags[0]} \r\n          options={tagsOptions} \r\n          onChange={handlSelectedTagsChange}          \r\n        />\r\n        <NumberField titel={'Количество знаков после запятой'} id={'precision'} placeholder={'...'} value={widget.precision} min={0} max={5} onChange={handlPrecisionChange}/>\r\n        <TextField titel={'Добавить текст слева'} id={'addTextLeft'} placeholder={'...'} value={widget.addTextLeft} onChange={handlTextLeftChange}/>\r\n        <TextField titel={'Добавить текст справа'} id={'addTextRight'} placeholder={'...'} value={widget.addTextRight} onChange={handlTextRightChange}/>\r\n      </form>        \r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\n// indicator config example\r\n// {\r\n//   type: 'indicator',\r\n//   width: 1,\r\n//   title: 'Температура зоны 1',\r\n//   addTextLeft: '',\r\n//   addTextRight: '°C',      \r\n//   tags: ['PT1'],                \r\n// }\r\n\r\n\r\n\r\n\r\n// ----------------------------------------------------------------------------------\r\n// utils\r\n\r\nfunction getSelectedOptions(e) {\r\n  var options = e.target.options;\r\n  var value = [];\r\n  for (var i = 0, l = options.length; i < l; i++) {\r\n    if (options[i].selected) {\r\n      value.push(options[i].value);\r\n    }\r\n  }  \r\n  return value\r\n}\r\n\r\n\r\nconst DefaultTable = {\r\n  type: 'table',\r\n  width: 4,\r\n  title: 'Новая таблица',\r\n  tags: [],   \r\n  fields: []               \r\n}\r\n\r\nconst DefaultGraph = {\r\n  type: 'graph',\r\n  width: 4,\r\n  title: 'Новый график',\r\n  tags: [],\r\n  legend: false,\r\n  toolbar: true,              \r\n}\r\n\r\nconst DefaultIndicator = {\r\n  type: 'indicator',\r\n  width: 1,\r\n  title: 'Новый индикатор',\r\n  tags: [],               \r\n}","import React from 'react' \r\n\r\n\r\nexport default function Page404() {\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='bg-color-dark-gray text-secondary content-height'>\r\n        <div className='container mt-5 text-center'>\r\n          <h1>Error 404</h1>\r\n          <h3>Страница не найдена</h3>\r\n        </div>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n ","import React, {useEffect} from 'react' \r\nimport {Switch, Route, useParams} from 'react-router-dom'\r\n\r\nimport axiosInstance from \"../utils/axiosApi\"\r\nimport getBaseUrl from '../utils/localSettings'\r\nimport sortWidgetsByOrder from './utils/sortWidgetsByOrder'\r\n\r\nimport Sidebar from './components/DeviceSidebar'\r\nimport DeviceOverviewPage from './pages/overview'\r\nimport DeviceSettingsPage from './pages/settings'\r\nimport DeviceEventsLogPage from './pages/eventsLog'\r\nimport DeviceGraphsPage from './pages/graphs'\r\nimport DeviceAdminPage from './pages/deviceAdmin'\r\nimport WidgetsAdminPage from './pages/widgetsAdmin'\r\nimport Page404 from '../base/pages/pageNotFound'\r\n\r\nconst BASE_URL = getBaseUrl()\r\n\r\n\r\n\r\nexport default function DeviceApp() { \r\n  let { id } = useParams();\r\n  const [widgetsTemplate, setWidgetsTemplate] = React.useState({})\r\n\r\n  useEffect(() => {\r\n    getWidgetsTemplate( id, (data)=> {\r\n      setWidgetsTemplate( sortWidgetsByOrder(data.template) );\r\n    });   \r\n  }, []) \r\n\r\n  function updateWidgetsTemplate(newTemplate){\r\n    setWidgetsTemplate(newTemplate)\r\n    postWidgetsTemplate(id, newTemplate)\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='bg-color-dark-gray text-secondary h-100'>\r\n      <div className=\"row m-0 p-0\">\r\n        <Sidebar deviceId={id}/>\r\n        <div className=\"col-10 m-0 p-0\">\r\n          <div className=\"content-height p-3\">\r\n            <Switch>\r\n              <Route exact path={`/device/${id}/overview/`} \r\n                component={()=><DeviceOverviewPage device_id={id} widgetsTemplate={widgetsTemplate}/>} \r\n              />\r\n              <Route exact path={`/device/${id}/settings/`} component={()=><DeviceSettingsPage device_id={id}/>} />\r\n              <Route exact path={`/device/${id}/events/`} component={()=><DeviceEventsLogPage device_id={id}/>} />\r\n              <Route exact path={`/device/${id}/graphs/`} component={()=><DeviceGraphsPage device_id={id}/>} />\r\n              <Route exact path={`/device/${id}/admin/config/`} component={()=><DeviceAdminPage device_id={id}/>} />\r\n              <Route exact path={`/device/${id}/admin/widgets/`} \r\n                component={()=><WidgetsAdminPage device_id={id} updateWidgetsTemplate={updateWidgetsTemplate} widgetsTemplate={widgetsTemplate}/>} \r\n              />\r\n              <Route component={Page404} />\r\n            </Switch>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n\r\nasync function getWidgetsTemplate(device_id, cb) {\r\n  const request = await axiosInstance.get(BASE_URL + \"/widgets/template/\", { params: { id: device_id }})\r\n  cb({...request.data});\r\n}\r\n\r\nasync function postWidgetsTemplate(device_id, template_data, cb) {\r\n  const body = {'template': template_data}\r\n  const request = await axiosInstance.post(BASE_URL + \"/widgets/template/\", body, { params: { id: device_id }})\r\n  cb && cb({...request.data});\r\n}\r\n\r\n\r\n","import React from 'react'\r\nimport {NavLink} from 'react-router-dom'\r\n\r\nexport default function Sidebar() {\r\n    return (\r\n        <div className=\"col-2 m-0 p-0\">\r\n        <div className=\"bg-dark bg-color-gray p-2 h-100\">\r\n          <div className=\"p-1\">\r\n\r\n            <div className=\"nav flex-column nav-pills\" style={{overflow: 'hidden'}} id=\"v-pills-tab\" role=\"tablist\" aria-orientation=\"vertical\">\r\n                <NavLink className=\"nav-link text-light btn\" style={{outline: 'none', boxShadow: 'none'}} activeClassName=\"bg-dark\" to=\"/company/overview/\">\r\n                  <div className=\"d-inline-flex w-100 justify-content-center justify-content-lg-start\">\r\n                    <i className='fas fa-home' style={{fontSize:'1.3em'}}></i>\r\n                    <span className='pl-3 d-none d-lg-inline'>Обзор</span>\r\n                  </div>\r\n                </NavLink>\r\n                \r\n                <NavLink className=\"nav-link text-light btn\" style={{outline: 'none', boxShadow: 'none'}} activeClassName=\"bg-dark\" to=\"/company/facilities/\">\r\n                  <div className=\"d-inline-flex w-100 justify-content-center justify-content-lg-start\">\r\n                    <i className='fas fa-city' style={{fontSize:'1.3em'}}></i>\r\n                    <span className='pl-3 d-none d-lg-inline'>Объекты</span>\r\n                  </div> \r\n                </NavLink>\r\n                \r\n                <NavLink className=\"nav-link text-light btn\" style={{outline: 'none', boxShadow: 'none'}} activeClassName=\"bg-dark\" to=\"/company/employers/\">\r\n                  <div className=\"d-inline-flex w-100 justify-content-center justify-content-lg-start\">\r\n                    <i className='fas fa-users' style={{fontSize:'1.3em'}}></i>\r\n                    <span className='pl-3 d-none d-lg-inline'>Сотрудники</span>\r\n                  </div>\r\n                </NavLink>\r\n\r\n                <NavLink className=\"nav-link text-light btn\" style={{outline: 'none', boxShadow: 'none'}} activeClassName=\"bg-dark\" to=\"/company/profile/\"> \r\n                  <div className=\"d-inline-flex w-100 justify-content-center justify-content-lg-start\">\r\n                    <i className='fas fa-chalkboard-teacher' style={{fontSize:'1.3em'}}></i>\r\n                    <span className='pl-3 d-none d-lg-inline'>Кабинет</span>\r\n                  </div>\r\n                </NavLink>\r\n            </div>\r\n            \r\n          </div>\r\n        </div>\r\n        </div>\r\n    )\r\n}","import React, { useEffect } from 'react' \r\nimport {Link} from 'react-router-dom'\r\n\r\nimport axiosInstance from \"../../utils/axiosApi\";\r\nimport getBaseUrl from '../../utils/localSettings'\r\nconst BASE_URL = getBaseUrl()\r\n\r\nfunction DeviceCard(props) {\r\n    const [deviceData, setDeviceData] = React.useState({})\r\n    const device = props.device   \r\n   \r\n    function readDeviceParameters() {\r\n      axiosInstance.get(BASE_URL + \"/device/parameters/\", { params: { id: device.id }} )\r\n        .then(responce => { \r\n            if (responce) {\r\n                const deviceParameters = responce.data\r\n                setDeviceData({...deviceParameters}) \r\n            }\r\n        }) \r\n    }\r\n    \r\n    useEffect(() => {\r\n      readDeviceParameters();\r\n      const deviceParametersUpdateInterval = setInterval(readDeviceParameters, 5000);\r\n      return () => {\r\n        clearInterval(deviceParametersUpdateInterval);\r\n      };\r\n    }, [])\r\n\r\n\r\n    return (\r\n        <React.Fragment>\r\n        <Link className=\"nav-link p-0 m-0\" to={`/device/${device.id}/overview/`}>\r\n            <div className='border border-secondary rounded p-2 h-100 bg-dark text-light card-hover' style={{overflow: 'hidden'}} >\r\n                <h6 className='text-nowrap'>{device.name}</h6>\r\n                <div className='p-0 m-0 small w-100'>\r\n                    <table className=\"table table-sm p-0 m-0 table-dark text-light w-100\">\r\n                        <tbody>\r\n                            <tr>\r\n                                <td> Связь: </td>   \r\n                                <td className='text-right'> {deviceData.is_online ? \r\n                                    <span className='text-light' >ОК</span> : \r\n                                    <span className='badge badge-pill badge-danger text-dark' style={{fontSize: '0.85em'}}>НЕТ</span> }\r\n                                </td>\r\n                            </tr> \r\n                            <tr>\r\n                                <td>  Обновлено: </td>   \r\n                                <td className='text-right'> {deviceData.last_update ? \r\n                                    format_time(deviceData.last_update, (deviceData.is_online ? null : 'text-warning')) :\r\n                                    <span className='text-secondary'>никогда</span> } \r\n                                </td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td>   Аварии: </td>   \r\n                                <td className='text-right'> Нет  </td>\r\n                            </tr>                                                         \r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n            </div>\r\n        </Link>    \r\n        </ React.Fragment> \r\n    )                   \r\n}\r\n\r\n\r\n\r\nfunction format_time (time, className='text-light') {\r\n    const s = new Date(time)\r\n    var yesterday = new Date()\r\n    yesterday = yesterday.setDate(yesterday.getDate() - 1);\r\n    if (s > yesterday) {\r\n        let formatter = new Intl.DateTimeFormat([] , {hour: '2-digit', minute: '2-digit'});\r\n        return <span className={className}>{formatter.format(s)}</span>\r\n    } else {\r\n        let formatter = new Intl.DateTimeFormat([] , {month: \"short\", day: \"numeric\" });\r\n        return <span className={className}>{formatter.format(s)}</span>           \r\n    }\r\n}\r\n\r\n\r\n\r\nexport default DeviceCard\r\n","import React from 'react';\r\n\r\nimport DeviceCard from './DeviceCard'\r\n\r\nfunction FacilityCard(props) {\r\n  const facilityInfo = props.facilityInfo   \r\n  const devices = facilityInfo.devices\r\n\r\n  const mapDeviceCards = (ds) => {\r\n    return ds.map((device, index) => {\r\n      return (\r\n        <div key={device.id} className='col-lg-4 col-md-6 col-sm-12 p-1 m-0 h-100'>\r\n          <DeviceCard device={device} index={index}/>\r\n        </div>\r\n      )\r\n    })\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n    <div className='card bg-dark text-light shadow-sm p-0 m-0'>\r\n      <h6 className='px-2 pt-2 pb-0 m-0'>{facilityInfo.name}</h6>\r\n      <div className='container-fluid h-100 p-1 m-0 row'>\r\n          {devices.length > 0 ? mapDeviceCards(devices) : <p className='text-secondary p-1'>Устройств нет ...</p> }       \r\n      </div>\r\n    </div>    \r\n    </ React.Fragment> \r\n  )                   \r\n}\r\n\r\nexport default FacilityCard","import React, { useEffect, useState } from 'react' \r\n\r\nimport Loader from '../../base/components/Loader'\r\nimport FacilityCard from '../components/FacilityCard'\r\nimport axiosInstance from \"../../utils/axiosApi\";\r\nimport getBaseUrl from '../../utils/localSettings'\r\nconst BASE_URL = getBaseUrl()\r\n\r\n\r\n\r\nexport default function CompanyOverviewPage() {\r\n  const [companyInfo, setCompanyInfo] = useState({})\r\n  const [loading, setLoading] = React.useState(true)\r\n\r\n  useEffect(() => {\r\n    readCompanyInfo( (inf)=> {\r\n      setCompanyInfo(inf);\r\n      setLoading(false);\r\n    });   \r\n  }, [])  \r\n\r\n  return (\r\n    <React.Fragment>\r\n      <h3 className='px-3 pt-3 pb-0'>Предприятие <b>{loading ? null : companyInfo.company.name}</b></h3>\r\n\r\n      <div className='container-fluid py-0 px-2 m-0 row'>\r\n        {loading ? <Loader /> : \r\n          <React.Fragment>\r\n            { companyInfo.facilities.map((facility, index) => {\r\n                return (\r\n                  <div key={facility.id} className='container-fluid px-2 py-0 mx-0 my-2 col-xl-6'>\r\n                    <FacilityCard facilityInfo={facility} index={index}/>\r\n                  </div>\r\n                )\r\n            }) }       \r\n          </React.Fragment>\r\n        }\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n\r\nasync function readCompanyInfo(cb) {\r\n  const request = await axiosInstance.get(BASE_URL + \"/company/info/\")\r\n  cb({...request.data});\r\n}\r\n ","import React from 'react' \r\n\r\n\r\nexport default function EmployersPage() {\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='p-3'>\r\n        <h3>Сотрудники компании</h3>\r\n        <p>Раздел находиться в разработке ... </p>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n","import React from 'react' \r\n\r\n\r\nexport default function FacilitiesPage() {\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='p-3'>   \r\n        <h3>Обзор объектов компании</h3>\r\n        <p>Раздел находиться в разработке ... </p>\r\n      </div> \r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n ","import React from 'react' \r\n\r\n\r\nexport default function CompanyProfilePage() {\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='p-3'> \r\n        <h3>Кабинет</h3>\r\n        <p>Раздел находиться в разработке ... </p>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n ","import React from 'react' \r\nimport {Switch, Route} from 'react-router-dom'\r\n\r\nimport Sidebar from './components/CompanySidebar'\r\nimport CompanyOverviewPage from './pages/overview'\r\nimport EmployersPage from './pages/employers'\r\nimport FacilitiesPage from './pages/facilities'\r\nimport CompanyProfilePage from './pages/profile'\r\nimport Page404 from '../base/pages/pageNotFound'\r\n\r\nexport default function CompanyApp() { \r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='bg-color-dark-gray text-secondary h-100'>\r\n      <div className=\"row m-0 p-0\">\r\n        <Sidebar />\r\n        <div className=\"col-10 m-0 p-0\">\r\n          <div className=\"content-height\">\r\n            <Switch>\r\n              <Route exact path='/company' component={CompanyOverviewPage} />\r\n              <Route exact path='/company/overview' component={CompanyOverviewPage} />\r\n              <Route exact path='/company/facilities' component={FacilitiesPage} />\r\n              <Route exact path='/company/employers' component={EmployersPage} />\r\n              <Route exact path='/company/profile' component={CompanyProfilePage} />\r\n              <Route component={Page404} />\r\n            </Switch>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\n","import React, { Component } from \"react\";\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport auth from '../../utils/auth' \r\n\r\n\r\nclass Login extends Component {\r\n  constructor(props) {\r\n      super(props);\r\n      this.state = {username: \"\", password: \"\"};\r\n\r\n      this.handleChange = this.handleChange.bind(this);\r\n      this.handleSubmit = this.handleSubmit.bind(this);\r\n  }\r\n\r\n  handleChange(event) {\r\n      this.setState({[event.target.name]: event.target.value});\r\n  }\r\n\r\n  handleSubmit(event) {\r\n    event.preventDefault();\r\n    const cb = ()=>{ this.props.history.push('/company/overview/') }\r\n    auth.login(this.state.username, this.state.password, cb );\r\n  }\r\n\r\n  render() {\r\n    return (\r\n    <div className='bg-color-dark-gray text-secondary content-height'>  \r\n      <div className='container card p-3 mt-5 bg-dark' style={{maxWidth: '500px'}}>\r\n        <h2>Вход</h2>\r\n        <form onSubmit={this.handleSubmit}>\r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"username\">Пользователь:</label>\r\n            <input name=\"username\" type=\"text\" className=\"form-control bg-secondary border-secondary text-light\" id=\"username\" value={this.state.username} onChange={this.handleChange}/>\r\n          </div> \r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"pwd\">Пароль:</label> \r\n            <input name=\"password\" type=\"password\" className=\"form-control bg-secondary border-secondary text-light\" id=\"pwd\" value={this.state.password} onChange={this.handleChange}/>\r\n          </div> \r\n          <button type=\"submit\" className=\"btn btn-outline-primary\">Войти</button>\r\n          <div className=\"pt-3\">\r\n            <span className=\"pr-2 text-secondary\">Еще не зарегестрированы?</span>\r\n            <Link className=\"\" to=\"/user/registration/\">Регистрация</Link>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n    )\r\n  }\r\n}\r\nexport default Login;","import React, { Component } from \"react\";\r\nimport {Link} from 'react-router-dom'\r\n\r\nimport axiosInstance from \"../../utils/axiosApi\";\r\n\r\nclass Signup extends Component{\r\n    constructor(props){\r\n        super(props);\r\n        this.state = {\r\n            username: \"\",\r\n            password: \"\",\r\n            email:\"\",\r\n            errors:{username:null, email:null, password:null}\r\n        };\r\n\r\n        this.handleChange = this.handleChange.bind(this);\r\n        this.handleSubmit = this.handleSubmit.bind(this);\r\n    }\r\n\r\n    handleChange(event) {\r\n        this.setState({[event.target.name]: event.target.value});\r\n    }\r\n\r\n    async handleSubmit(event) {\r\n      event.preventDefault();\r\n      try {\r\n          const response = await axiosInstance.post('/user/create/', {\r\n              username: this.state.username,\r\n              email: this.state.email,\r\n              password: this.state.password\r\n          });\r\n          return response;\r\n      } catch (error) {\r\n          console.log(error.stack);\r\n          this.setState({\r\n            errors:error.response.data\r\n          });           \r\n      }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n          <div className='bg-color-dark-gray text-secondary content-height'>  \r\n            <div className='container card p-3 mt-5 bg-dark' style={{maxWidth: '500px'}}>\r\n                <h2>Регистрация</h2>              \r\n                <form onSubmit={this.handleSubmit}>\r\n                  <div className=\"form-group\">\r\n                    <label htmlFor=\"username\">Имя пользователя:</label>\r\n                    <input name=\"username\" type=\"text\" className=\"form-control bg-secondary border-secondary text-light\" id=\"username\" value={this.state.username} onChange={this.handleChange}/>\r\n                    { this.state.errors.username ? <span className='text-danger'>{this.state.errors.username}</span> : null}\r\n                  </div> \r\n                  <div className=\"form-group\">\r\n                    <label htmlFor=\"mail\">Электронная почта:</label>\r\n                    <input name=\"email\" type=\"email\" className=\"form-control bg-secondary border-secondary text-light\" id=\"mail\" value={this.state.email} onChange={this.handleChange}/>\r\n                    { this.state.errors.email ? <span className='text-danger'>{this.state.errors.email}</span> : null}\r\n                  </div> \r\n                  <div className=\"form-group\">\r\n                    <label htmlFor=\"pwd\">Пароль:</label> \r\n                    <input name=\"password\" type=\"password\" className=\"form-control bg-secondary border-secondary text-light\" id=\"pwd\" value={this.state.password} onChange={this.handleChange}/>\r\n                    { this.state.errors.password ? <span className='text-danger'>{this.state.errors.password}</span> : null}\r\n                  </div> \r\n                  <button type=\"submit\" className=\"btn btn-outline-primary\">Подтвердить</button>\r\n                  <div className=\"pt-3\">\r\n                    <span className=\"pr-2 text-secondary\">Уже зарегестрированы?</span>\r\n                    <Link className=\"\" to=\"/user/login/\">Вход</Link>\r\n                  </div>\r\n                </form>\r\n            </div>\r\n          </div>\r\n        )\r\n    }\r\n}\r\nexport default Signup;","import React from 'react' \r\n\r\n\r\nexport default function ProfilePage(props) {\r\n  return (\r\n    <React.Fragment>\r\n    <div className='bg-color-dark-gray text-secondary content-height'> \r\n      <div className='container card bg-dark shadow-sm my-4 pt-4'>\r\n        <h2>Профиль пользователя</h2>\r\n\r\n        <div className='row my-3'>\r\n          <div className='col-lg-6'>\r\n            <table className=\"table text-light tadle-dark \">\r\n              <tbody>\r\n                <tr>\r\n                  <td className='border-secondary'>Пользователь:</td> \r\n                  <td className='border-secondary'><b>{props.userInfo.username}</b></td>\r\n                </tr>\r\n                <tr>\r\n                  <td className='border-secondary'>Имя:</td> \r\n                  <td className='border-secondary'><b>{props.userInfo.first_name}</b></td>\r\n                </tr>\r\n                <tr>\r\n                  <td className='border-secondary'>Фамилия:</td> \r\n                  <td className='border-secondary'><b>{props.userInfo.last_name}</b></td>\r\n                </tr>\r\n                <tr>\r\n                  <td className='border-secondary'>Электронная почта:</td> \r\n                  <td className='border-secondary'><b>{props.userInfo.email}</b></td>\r\n                </tr>            \r\n              </tbody>\r\n            </table>\r\n          </div> \r\n        </div> \r\n      </div>  \r\n    </div>\r\n    </React.Fragment>\r\n);\r\n}\r\n","import React, { Component } from \"react\";\r\nimport {Link, withRouter} from 'react-router-dom'\r\n\r\nimport auth from '../../utils/auth' \r\n\r\nclass LogoutBtn extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.handleLogout = this.handleLogout.bind(this);\r\n    }\r\n\r\n    handleLogout() {\r\n        auth.logout(()=>{\r\n            this.props.history.push('/')\r\n        });\r\n    };\r\n\r\n    render() {\r\n        return (\r\n            <li className=\"nav-item\" >\r\n                <Link className=\"nav-link\" to=\"\" onClick={this.handleLogout}>Выйти</Link>\r\n            </li>\r\n        )\r\n    };\r\n};         \r\n\r\nexport default withRouter(LogoutBtn)","import React from 'react'\r\nimport {Link} from 'react-router-dom'\r\n\r\nimport LogoutBtn from '../../users/components/LogoutBtn'\r\n\r\nexport default function Navbar(props) {\r\n    const authed = props.authed\r\n    const userInfo = props.userInfo\r\n    return (\r\n        <nav className=\"navbar navbar-expand-sm bg-dark navbar-dark bg-color-indigo header-height p-0 m-0\">\r\n            <Link className=\"navbar-brand header-height py-2 pl-3 pr-0 m-0\" to=\"/\">WebArm</Link>\r\n\r\n            <button className=\"navbar-toggler header-height border-0 m-0\" style={{outline: 'none', boxShadow: 'none'}} type=\"button\" data-toggle=\"collapse\" data-target=\"#collapsibleNavbar\">\r\n                <span className=\"navbar-toggler-icon\"></span>\r\n            </button>\r\n\r\n            <div className=\"collapse navbar-collapse bg-color-indigo\" id=\"collapsibleNavbar\" style={{zIndex: '1'}}>\r\n                <div className='d-md-none border-top border-secondary'></div>\r\n                <ul className=\"navbar-nav px-3\">\r\n                    {authed ? (\r\n                        <React.Fragment>\r\n                            <li className=\"nav-item\">\r\n                                <Link className=\"nav-link\" to=\"/company/overview\">Предприятие</Link>\r\n                            </li>\r\n                            <li className=\"nav-item\">\r\n                                <Link className=\"nav-link\" to=\"/company/facilities\">Обьекты</Link>\r\n                            </li>\r\n                            <li className=\"nav-item\">\r\n                                <Link className=\"nav-link\" to=\"/company/profile\">Кабинет</Link>\r\n                            </li>\r\n                        </React.Fragment>\r\n                    ) : null }\r\n                </ul>  \r\n        \r\n                <ul className=\"navbar-nav ml-auto px-3\">\r\n                    {authed ? (\r\n                        <React.Fragment>\r\n                            { userInfo ?\r\n                                <React.Fragment> \r\n                                    <li className=\"nav-item\">\r\n                                        <Link className=\"nav-link\" to=\"/user/profile\">{userInfo.username}</Link>\r\n                                    </li>\r\n                                    <li className=\"nav-item border-right border-secondary my-1 d-none d-sm-inline\"> </li>\r\n                                </React.Fragment>                        \r\n                            : null }\r\n                            <LogoutBtn />\r\n                        </React.Fragment>\r\n                    ) : (\r\n                        <li className=\"nav-item\">\r\n                            <Link className=\"nav-link\" to=\"/user/login\">Войти</Link>\r\n                        </li>\r\n                    )}\r\n                </ul> \r\n            </div>\r\n        </nav>       \r\n    );\r\n}","import React from 'react' \r\nimport {Link} from 'react-router-dom'\r\n\r\nimport auth from '../../utils/auth' \r\n\r\n\r\nfunction WelcomePage(props) {\r\n  // const backgroundStyle = {\r\n  //   backgroundImage: 'url(\"./img/grid.png\")',\r\n  //   backgroundRepeat: 'repeat-x',\r\n  //   backgroundAttachment: 'fixed'\r\n  // }\r\n\r\n\r\n  function loginDemoUser() {\r\n    const cb = ()=>{ props.history.push('/company/overview/') }\r\n    auth.login('admin', 'admin', cb );\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className='bg-color-dark-gray text-light content-height'>\r\n        <div className='container card mt-5 p-3 w-100' style={{background:'rgba(0,0,0,0.8)'}}>\r\n            <div className='text-center pt-4'>\r\n                <h3>Добро пожаловать на <b>BFCloud</b></h3>\r\n            </div>\r\n            <br/>\r\n            <div className='text-center'>\r\n                <h5>Для начала работы\r\n                  <Link className='px-2' to=\"/user/login/\">Войдите</Link>\r\n                  или\r\n                  <Link className='px-2' to=\"/user/registration/\">Зарегистрируйтесь</Link>\r\n                </h5>\r\n            </div>\r\n\r\n            <div className=\"card-columns py-5\">\r\n              <div className=\"card border-secondary\" style={{background:'none'}}>\r\n                <div className=\"card-body text-center\">\r\n                  <h6>Удаленный мониторинга и управления промышленными и IoT устройствами</h6>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"card border-secondary\" style={{background:'none'}}>\r\n                <div className=\"card-body text-center\">\r\n                  <h6>Контроль аварийных событий и уведомление о событиях на объекте </h6>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"card border-secondary\" style={{background:'none'}}>\r\n                <div className=\"card-body text-center\">\r\n                  <h6>Простое подключение и настройка опроса устройств</h6>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"card border-secondary\" style={{background:'none'}}>\r\n                <div className=\"card-body text-center\">\r\n                  <h6>Открытый API для интеграции с сторонним ПО и \r\n                    IoT устройствами \r\n                  </h6>\r\n                </div>\r\n              </div>  \r\n\r\n              <div className=\"card border-secondary\" style={{background:'none'}}>\r\n                <div className=\"card-body text-center\">\r\n                  <h6>Единый интерфейс для Персональных компьютеров и Мобильных устройств </h6>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"card border-secondary\" style={{background:'none'}}>\r\n                <div className=\"card-body text-center\">\r\n                  <h6> Вы можете воспользоваться демо-версией сервиса \r\n                    <a className=\"px-2\" href='#' onClick={loginDemoUser}>Демо-версия: БУМП-14</a>\r\n                  </h6> \r\n                </div>\r\n              </div>\r\n            </div>            \r\n        </div>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\nexport default WelcomePage","import './App.css'\r\nimport '../node_modules/react-vis/dist/style.css'\r\n\r\nimport React, { useEffect, useState } from 'react' \r\nimport {\r\n  BrowserRouter as Router, \r\n  Switch, \r\n  Route,\r\n} from 'react-router-dom'\r\n\r\nimport {ProtectedRoute} from './utils/protectedRoute'\r\nimport { FullScreen, useFullScreenHandle } from \"react-full-screen\";\r\n\r\nimport DeviceApp from './device/deviceApp'\r\nimport CompanyApp from './company/companyApp'\r\nimport Login from './users/pages/login'\r\nimport Registration from './users/pages/registration'\r\nimport ProfilePage from './users/pages/profile'\r\nimport Navbar from './base/components/Navbar'\r\nimport WelcomePage from './base/pages/welcome'\r\nimport Page404 from './base/pages/pageNotFound'\r\n\r\nimport auth from './utils/auth'\r\n\r\nexport default function App() {\r\n  const [loading, setLoading] = useState(true)\r\n  const [loading2, setLoading2] = useState(true)\r\n  const [authed, setAuthed] = useState(false)\r\n  const [userInfo, setUserInfo] = useState({})\r\n\r\n  const handle = useFullScreenHandle();\r\n\r\n  useEffect(() => {\r\n    auth.checkAuthentication(() => { setLoading(false) })\r\n    auth.onLogin = () => {setAuthed(true)}    \r\n    auth.onLogout = () => {setAuthed(false)}    \r\n    auth.onUserInfoReaded = (ui) => {\r\n      setUserInfo(ui); \r\n      setLoading2(false);\r\n    }   \r\n  }, [])\r\n\r\n  if (loading || loading2) { \r\n    return null \r\n  } else { \r\n    return (\r\n      <React.Fragment>\r\n        <button className='full-screen-button fas fa-expand ' onClick={handle.enter}></button>\r\n        <FullScreen handle={handle}>\r\n          <Router>        \r\n            <Route exact path='/' component={()=>{\r\n              return (\r\n              <video autoplay=\"autoplay\" muted loop=\"loop\" id=\"myVideo\">\r\n                <source src=\"Earth13426.mp4\" type=\"video/mp4\" />\r\n              </video>\r\n              )}\r\n            }/>\r\n\r\n            <Navbar authed={authed} userInfo = {userInfo} />\r\n            <Switch>\r\n              <Route exact path='/' component={WelcomePage} />\r\n              <Route exact path='/user/login' component={Login}  />\r\n              <Route exact path='/user/registration' component={Registration} />\r\n              <ProtectedRoute exact path='/user/profile' component={ ()=> <ProfilePage userInfo = {userInfo} /> } />\r\n              <ProtectedRoute path='/company' component={CompanyApp} />                   \r\n              <ProtectedRoute path='/device/:id' component={DeviceApp} />\r\n              <Route component={Page404} />\r\n            </Switch>\r\n          </Router>\r\n        </FullScreen>\r\n      </React.Fragment>\r\n    )\r\n  }\r\n}\r\n\r\n\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}